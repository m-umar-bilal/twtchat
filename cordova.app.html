<!DOCTYPE html>
<!--
    Licensed to the Apache Software Foundation (ASF) under one
    or more contributor license agreements.  See the NOTICE file
    distributed with this work for additional information
    regarding copyright ownership.  The ASF licenses this file
    to you under the Apache License, Version 2.0 (the
    "License"); you may not use this file except in compliance
    with the License.  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing,
    software distributed under the License is distributed on an
    "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
     KIND, either express or implied.  See the License for the
    specific language governing permissions and limitations
    under the License.
-->
<html lang="en" xml:lang="en">
    <head>
        <!--
        Customize this policy to fit your own app's needs. For more guidance, see:
            https://github.com/apache/cordova-plugin-whitelist/blob/master/README.md#content-security-policy
        Some notes:
            * gap: is required only on iOS (when using UIWebView) and is needed for JS->native communication
            * https://ssl.gstatic.com is required only on Android and is needed for TalkBack to function properly
            * Disables use of inline scripts in order to mitigate risk of XSS vulnerabilities. To change this:
                * Enable inline JS: add 'unsafe-inline' to default-src
        -->
        <!--meta http-equiv="Content-Security-Policy" content="default-src 'self' data: gap: https://ssl.gstatic.com 'unsafe-eval'; style-src 'self' 'unsafe-inline'; media-src *"-->
        <!--meta http-equiv="Content-Security-Policy" content="default-src * data: ; style-src 'self' http://* 'unsafe-inline'; script-src 'self' http://* 'unsafe-inline' 'unsafe-eval'; media-src *" />
        <meta http-equiv="Content-Security-Policy" content="default-src * data: ; style-src 'self' http://* 'unsafe-inline'; script-src 'self' http://* https://*  'unsafe-inline' 'unsafe-eval'" /-->
        <meta http-equiv="Content-Security-Policy" content="default-src ms-appdata: data: http: https: gap: file: *; style-src 'self' 'unsafe-inline'; img-src data: *; script-src * 'unsafe-inline' 'unsafe-eval'; media-src *">
        <meta charset="utf-8">
        <meta name="format-detection" content="telephone=no">
        <meta name="msapplication-tap-highlight" content="no">
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, viewport-fit=cover, target-densityDpi=device-dpi">
        
        <!--meta name="viewport" content="user-scalable=yes, initial-scale=1, maximum-scale=2, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" /-->
        
        <link rel="stylesheet" type="text/css" href="css/jquery.mobile-1.4.5.min.css">
        
        <link rel="stylesheet" href="css/jquery.mobile.iscrollview.css"/>
    	 <link rel="stylesheet" href="css/jquery.mobile.iscrollview-pull.css"/>
        
        <link rel="stylesheet" type="text/css" href="css/index.css">
        
        <link rel="stylesheet" type="text/css" href="css/imageviewer.css">
        
        <title>TwtChat</title>
        
        <script type="text/javascript" src="js/jquery.js"></script>
        
        <script type="text/javascript" src="js/html2canvas.js"></script>
        
        <script type="text/javascript" src="js/filterous.js"></script>
        
        <script type="text/javascript" src="js/filterousEffects.js"></script>
        
        <script type="text/javascript" src="js/jquery.mobile-1.4.5.min.js"></script>
        
        <script type="text/javascript" src="js/jquery.mobile.iscrollview.js"></script>
        
        <script type="text/javascript" src="js/pretty.js"></script>
        
        <script type="text/javascript" src="cordova.js"></script>
        
        <script type="text/javascript" src="js/md5.js"></script>
        
        <script type="text/javascript" src="js/moment.js"></script>
        
        <script type="text/javascript" src="js/parameters.js"></script>
        
        <script type="text/javascript" src="js/index.js"></script>
        
        <!-- Global site tag (gtag.js) - Google Analytics -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-124218687-1"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
        
          gtag('config', 'UA-124218687-1');
        </script>
        
        <script type="text/javascript">
			
			var timerTwtchat 	= null;
			var timerRecord	= null;
			var start			= true;
			var scrollEnd 		= true;
			var my_media 		= null;
			var mediaTimer		= null;
			
			var indexAds 		= 0;
			
			var indexStatus	= 0;
			
			var soundFile;
			var soundFilePath;
			
			// options used with transcodeVideo function
			// VideoEditorOptions is global, no need to declare it
			var VideoEditorOptions = {
				OptimizeForNetworkUse: {
					NO: 0,
					YES: 1
				},
				OutputFileType: {
					M4V: 0,
					MPEG4: 1,
					M4A: 2,
					QUICK_TIME: 3
				}
			};
			
			//
			//
			function getTwtChat() {
				
				var pageId			= $.mobile.activePage.attr('id');
				
				var arrayMessages	= window.localStorage.getArray("MESSAGES");
				
				if( arrayMessages == undefined ){
					
					arrayMessages = new Array();
					
				}
				
				var postData		= "email="+encodeURIComponent(email_app)+"&password="+encodeURIComponent(password_app)+"&array_messages="+encodeURIComponent(JSON.stringify(arrayMessages));
				 
				//alert( postData );
				 
				$.ajax({
						type: "POST",
						url: url_serv+'twtchat.php',
						data: postData,
						async: true,
						success: function(data){
							
							//
							
							start = true;
							
							var type 				= $('#type_conversation').val();
							var conversation_id	= $('#conversation_id').val();
							
							//alert( type+" "+conversation_id );
							//alert( pageId );
							//alert( JSON.stringify(data) );
							
							if( data['error_message'] == "" ){
								
								//alert(data['insert_message']);
								
								//Insert Message in database
								if( data['insert_message'] ){
									
									if( pageId == "pageChat" ){
														
										for(var i=0; i < arrayMessages.length; i++){
															
											$('#li-'+arrayMessages[i]['unique_code']).find('.img_clock').hide();
											$('#li-'+arrayMessages[i]['unique_code']).find('.img_check').show();
															
										}
														
									}
									
									window.localStorage.removeItem("MESSAGES");
									
								}
								
								//Friends
								
								if( data['users'] != null ){
									
									var users = window.localStorage.getArray("USERS");
									
									//update list storage
									window.localStorage.setArray("USERS", data['users']);
									
									if( ! arraysEqual(users, data['users']) ){
									
										var nbr = data['users'].length - users.length;
										
										//alert(data['users'].length +"-"+ users.length);
										
										if( nbr > 0 ){
											
											$('.notify-friend').text(nbr);
											$('.notify-friend').show(100);
											
										}
										
										if( pageId == "pageFriends" ){
											
											updateListFriends(true);
											
										}
									
									}
									
								}else {
									
									window.localStorage.removeItem("USERS");
									
								}
								
								// Pending friends
								
								if( data['users_pending'] != null ){
									
									var pending = window.localStorage.getArray("PENDING_USERS");
									
									//update list storage
									window.localStorage.setArray("PENDING_USERS", data['users_pending']);
									
									if( data['users_pending'].length > 0 ){
										
										$('.notify-pendingFriend').show(100);
											
									}
									
									if( ! arraysEqual(pending, data['users_pending']) ){
									
										var nbr = data['users_pending'].length - pending.length;
										
										//alert(data['users'].length +"-"+ users.length);
										
										if( pageId == "pagePendingFriends" ){
											
											updatePendingListFriends(true);
											
										}
									
									}
									
								}else {
									
									window.localStorage.removeItem("PENDING_USERS");
									
									$('.notify-pendingFriend').text("");
									$('.notify-pendingFriend').hide();
									
								}
								
								// Groups
								
								if( data['groups'] != null ){
									
									var groups = window.localStorage.getArray("GROUPS");
									
									//update list storage
									window.localStorage.setArray("GROUPS", data['groups']);
									
									if( ! arraysEqual(groups, data['groups']) ){
									
										/*var nbr = data['groups'].length - groups.length;
										
										//alert( JSON.stringify(data['groups']) );
										
										if( nbr > 0 ){
											
											$('.notify-groups').text(nbr);
											$('.notify-groups').show(100);
											
										}*/
										
										updateListGroups( pageId == "pageGroups" );
										
										/*if( pageId == "pageGroups" ){
											
											updateListGroups(true);
											
										}else {
											
											updateListGroups(false);
											
										}*/
										
										if ( pageId == "pageChat" && type == "1"){
											
											//alert(JSON.stringify(data['groups']));
											
											var index 		= indexOfJSON(data['groups'], 'id', conversation_id);
											
											if( index !== -1 ){
												
												var servConv	= data['groups'][index]['id'];
												
												if( servConv == conversation_id ){
													
													var new_groups = data['groups'][index];
													
													if( ! arraysEqual( groups[index], new_groups ) ){
														
														//alert("Changed");
														
														updateMessageChat( new_groups['messages'], new_groups['messages'].length - groups[index]['messages'].length );
												
														updateUnreadGroup(servConv);		
														
													}
												
												}
												
											}
											
										}
										
									}
										
								}else {
									
									window.localStorage.removeItem("GROUPS");
									
								}
								
								//Pending groups
								
								if( data['groups_pending'] != null ){
									
									var pending = window.localStorage.getArray("PENDING_GROUPS");
									
									//update list storage
									window.localStorage.setArray("PENDING_GROUPS", data['groups_pending']);
									
									if( data['groups_pending'].length > 0 ){
											
										$('.notify-pendingGroup').show();
											
									}
									
									if( ! arraysEqual(pending, data['groups_pending']) ){
									
										/*var nbr = data['groups_pending'].length - pending.length;
										
										//alert(data['users'].length +"-"+ users.length);
										
										if( nbr > 0 ){
											
											$('.notify-groups').text(nbr);
											$('.notify-groups').show(100);
											
											$('.notify-pendingGroup').show(100);
											
										}*/
										
										if( pageId == "pagePendingGroups" ){
											
											updatePendingListGroups(true);
											
										}
									
									}
									
								}else {
									
									window.localStorage.removeItem("PENDING_GROUPS");
									
									$('.notify-pendingGroup').hide();
									
								}
								
								//Pending user groups
								
								if( data['myGroups_pending'] != null ){
									
									var pending = window.localStorage.getArray("PENDING_MYGROUPS");
									
									//update list storage
									window.localStorage.setArray("PENDING_MYGROUPS", data['myGroups_pending']);
									
									if( data['myGroups_pending'].length > 0 ){
											
										$('.notify-pendingGroup').show();
											
									}
									
									if( ! arraysEqual(pending, data['myGroups_pending']) ){
										
										if( pageId == "pagePendingGroups" ){
											
											updatePendingListGroups(true);
											
										}
									
									}
									
								}else {
									
									window.localStorage.removeItem("PENDING_MYGROUPS");
									
									$('.notify-pendingGroup').hide();
									
								}
								
								// Privates messages
								
								//alert( JSON.stringify(data['privates']) );
								
								if( data['privates'] != null ){
									
									var privates = window.localStorage.getArray("PRIVATES");
									
									//update list storage
									window.localStorage.setArray("PRIVATES", data['privates']);
									
									if( ! arraysEqual(privates, data['privates']) ){
									
										/*var nbr = data['privates'].length - privates.length;
										
										if( nbr > 0 ){
											
											$('.notify-chats').text(nbr);
											$('.notify-chats').show(100);
											
										}*/
										
										updateListPrivates( pageId == "pageHome" );
										
										/*if( pageId == "pageHome" ){
											
											updateListPrivates(true);
											
										}*/
										
										if ( pageId == "pageChat" && type == "0"){
											
											var index 		= indexOfJSON(data['privates'], 'id', conversation_id);
											
											if( index !== -1 ){
												
												var servConv	= data['privates'][index]['id'];
												
												if( servConv == conversation_id ){
													
													//alert("My conver");
													
													var new_privates = data['privates'][index];
													
													if( ! arraysEqual( privates[index], new_privates ) ){
														
														//alert("Changed");
														
														updateMessageChat( new_privates['messages'], new_privates['messages'].length - privates[index]['messages'].length );
														
														updateUnreadMessage(servConv);
														
														
													}
												
												}
												
											}
											
										}
										
									}
										
								}else {
									
									window.localStorage.removeItem("PRIVATES");
									
								}
								
								//Ads
								
								if( data['ads'] != null ){
									
									//update list storage
									window.localStorage.setArray("ADS", data['ads']);
									
									//alert(JSON.stringify(data['ads']));
									
								}else {
									
									window.localStorage.removeItem("ADS");
									
								}
								
								// My status
								
								if( data['myStatus'] != null ){
									
									//alert( JSON.stringify(data['myStatus']) );
									
									var status = window.localStorage.getArray("MYSTATUS");
									
									window.localStorage.setArray("MYSTATUS", data['myStatus']);
									
									if( ! arraysEqual(status, data['myStatus']) ){
									
										if( pageId == "pageMyStatus" ){
										
											listMyStatus(true);
										
										}
										
									}
									
								}else {
									
									window.localStorage.removeItem("MYSTATUS");
									
									if( pageId == "pageMyStatus" ){
									
										listMyStatus(true);
									
									}
									
								}
								
								// status other friends
								
								if( data['status'] != null ){
									
									var status = window.localStorage.getArray("STATUS");
									
									window.localStorage.setArray("STATUS", data['status']);
									
									if( ! arraysEqual(status, data['status']) ){
									
										if( pageId == "pageStatus" ){
										
											listStatus(true);
										
										}
										
									}
									
								}else {
									
									window.localStorage.removeItem("STATUS");
									
									if( pageId == "pageStatus" ){
									
										listStatus(true);
									
									}
									
								}
								
							}
							
						},
						error: function(xhr, status, error) {
									
							start = true;
									
						},
						dataType: 'json'
							
				});
				
			}
			
			//
			function signupGooglePlus() {
				
				window.plugins.googleplus.login(
					{
					  'scopes': '', // optional, space-separated list of scopes, If not included or empty, defaults to `profile` and `email`.
					  'webClientId': '356910154614-396a4dip7phfl3ienaon2t0i7eogf66e.apps.googleusercontent.com', // optional clientId of your Web application from Credentials settings of your project - On Android, this MUST be included to get an idToken. On iOS, it is not required.
					  'offline': true, // optional, but requires the webClientId - if set to true the plugin will also return a serverAuthCode, which can be used to grant offline access to a non-Google server
					},
					function (obj) {
						
						//alert(JSON.stringify(obj)); // do something useful instead of alerting
						$('#name_signup').val(obj.displayName);
							
						$('#email_signup').val(obj.email);
							
						$.mobile.changePage( "#pageSignUp", { transition: "fade", changeHash: true });
					},
					function (msg) {
						
					 	toastMessage("Failed: " + msg, color_error);
						
					}
				);
				
			}
			
			//
			function signupFacebook(){
				
				var fbLoginSuccess = function (userData) {
					
					//console.log("UserInfo: ", JSON.stringify(userData) );
					
					//alert(userData['authResponse']['userID']);
					
					facebookConnectPlugin.api(userData['authResponse']['userID']+"/?fields=name,email", ["public_profile","email"],
						function (result) {
							
							//alert("Result: " + JSON.stringify(result));
							
							$('#name_signup').val(result.name);
							
							$('#email_signup').val(result.email);
							
							$.mobile.changePage( "#pageSignUp", { transition: "fade", changeHash: true });
							
							
						},
						function (error) {
							
							toastMessage("Failed: " + error, color_error);
							
						}
					);
					
				};
				
				facebookConnectPlugin.login(["public_profile","email"], fbLoginSuccess,
					function loginError (error) {
						toastMessage( "Failed: " + JSON.stringify(error), color_error );
	  				}
				);
				
			}
			
			// status show
			//
			function listStatus(updateList) {
				
				$('#list-status').empty();
				
				$('#list-status').append('<li class="title-text">SNAPS FRIENDS</li>').trigger('create');
				
				var data = window.localStorage.getArray("STATUS");
				
				if( data != undefined ) {
				
					for(var i=0; i < data.length; i++){
						
						var date_status	= moment(data[i]['create_date']).fromNow();
						
						var url_status		= url_serv + data[i]['directory'] + data[i]['status_url'];
						
						var image_status	= "";
						
						if( data[i]['status_type'] == 'video' ){
							
							image_status = '<div class="video-mask">'+
												'<video webkit-playsinline playsinline class="roundedVideo">'+
													'<source src="'+url_status+'#t=0.1" type="video/mp4">'+
												'</video>'+
											'</div>';
							
						}else {
							
							image_status = '<img src="'+url_status+'" class="roundedStatus">';
							
						}
						
						$('#list-status').append('<li id="li-status'+data[i]['id']+'">'+
														
														'<div class="ui-grid-a">'+
													   		'<div class="ui-block-a block-rounded"onClick="showStory(\'STATUS\', \''+i+'\', \''+data[i]['name']+'\');">'+image_status+'</div>'+
													   		'<div class="ui-block-b block-text">'+
																'<p class="title-story">'+data[i]['name']+'</p>'+
																'<p class="time-story">'+date_status+'</p>'+
													   		'</div>'+
														'</div>'+
														
													 '</li>').trigger('create');
						
					}
				
				}else {
					
					$('#list-status').append('<li>No snaps available</li>').trigger('create');
					
				}
				
				if( updateList ) {
					
					$('#list-status').listview("refresh");
					
				}
				
			}
			
			// my status show
			//
			function listMyStatus(updateList) {
				
				$('#list-myStatus').empty();
				
				var data = window.localStorage.getArray("MYSTATUS");
				
				if( data != undefined ) {
				
					for(var i=0; i < data.length; i++){
						
						var date_status	= moment(data[i]['create_date']).fromNow();
						
						var url_status		= url_serv + data[i]['directory'] + data[i]['status_url'];
						
						var image_status	= "";
						
						if( data[i]['status_type'] == 'video' ){
							
							image_status = '<div class="video-mask">'+
												'<video webkit-playsinline playsinline class="roundedVideo">'+
													'<source src="'+url_status+'#t=0.1" type="video/mp4">'+
												'</video>'+
											'</div>';
							
						}else {
							
							image_status = '<img src="'+url_status+'" class="roundedStatus">';
							
						}
						
						$('#list-myStatus').append('<li id="li-status'+data[i]['id']+'">'+
						
														'<div class="ui-grid-b">'+
														   '<div class="ui-block-a block-roundedStatus" onClick="showStory(\'MYSTATUS\', \''+i+'\', \'My status\');">'+image_status+'</div>'+
														   '<div class="ui-block-b block-textStatus" align="center">'+
															  '<div align="left" style="display: inline-block; margin-top:22px">'+date_status+'</div>'+
														   '</div>'+
														   '<div class="ui-block-c block-btnStatus" align="right">'+
															'<a href="#" data-role="button" data-icon="minus" data-iconpos="notext" class="ui-nodisc-icon btn-red" onClick="deleteStatusConfirm(\''+data[i]['id']+'\');"></a>'+
														   '</div>'+
														'</div>'+
														
													 '</li>').trigger('create');
						
					}
				
				}else {
					
					$('#list-myStatus').append('<li>No snaps available</li>').trigger('create');
					
				}
				
				if( updateList ) {
					
					$('#list-myStatus').listview("refresh");
					
				}
				
			}
			
			// Show status
			//
			function showStory(keyItem, index, title){
				
				window.localStorage.setItem("KEY_STATUS", keyItem);
				
				indexStatus = index;
				
				var data = window.localStorage.getArray(keyItem);
				
				$('.subheader').html("");
				
				$('#content-status').html('');
				
				if( data != undefined ){
					
					var url_status		= url_serv + data[index]['directory'] + data[index]['status_url'];
					
					var date_status	= moment(data[index]['create_date']).fromNow();
					
					$('#title-story').html(data[index]['name']);
					
					$('.subheader').html(date_status);
					
					if( data[index]['status_type'] == 'video' ){
						
						$('#content-status').html('<video webkit-playsinline playsinline id="video-status">'+
														'<source src="'+url_status+'#t=0.1" type="video/mp4">'+
													'</video>').trigger('create');
						
						document.getElementById('video-status').load();
						document.getElementById('video-status').play();
						
					}else {
						
						$('#content-status').html('<img src="'+url_status+'" class="imageStatus">');
						
					}
					
					$.mobile.changePage( "#pageShowStatus", { transition: "fade", changeHash: true });
					
				}
				
			}
			
			// to receive new Message
			//
			function updateMessageChat(messages, nbr_message){
				
				//alert(nbr_message);
				
				var parent_date = "";
					
				for(var i=0; i < nbr_message; i++){
					
					//alert(messages[i]['message']);
					
					if( messages[i]['user_id'] != user_id_app ) {
					
						parent_date = moment(messages[i]['create_date']).calendar(null, {
																										sameDay: '[Today]',
																										nextDay: '[Tomorrow]',
																										nextWeek: 'dddd',
																										lastDay: '[Yesterday]',
																										lastWeek: 'dddd',
																										sameElse: 'DD/MM/YYYY'
																									});
							
						
						//Parent date
							
						if( (i+1) < messages.length ){
								
							var next_date = moment(messages[i+1]['create_date']).calendar(null, {
																										sameDay: '[Today]',
																										nextDay: '[Tomorrow]',
																										nextWeek: 'dddd',
																										lastDay: '[Yesterday]',
																										lastWeek: 'dddd',
																										sameElse: 'DD/MM/YYYY'
																									});
								
							//alert(next_date +"##"+parent_date);
								
							if( next_date != parent_date ){
									
								$('#list-messages').append('<li class="li-date"><center><div class="date-back">'+parent_date+'</div></center></li>').trigger('create');
								
							}
								
						}else {
								
							$('#list-messages').append('<li class="li-date"><center><div class="date-back">'+parent_date+'</div></center></li>').trigger('create');
								
						}
						
						var date_message		= moment(messages[i]['create_date']).format('LT');
							
						var myClass			= "";
						var classWhite			= "date-grey";
						var name_user			= messages[i]['name'];
						var img_status			= "";
						
						var img_profil			= "images/profil.png";
							
						if( messages[i]['photo_profil'] != null ){
								
							img_profil = url_serv + messages[i]['directory'] + messages[i]['photo_profil'];
								
						}
							
						var profil_info 		= '<div class="profil-chat" onClick="openProfilId(\''+messages[i]['user_id']+'\');">'+
								'<img src="'+img_profil+'" class="image-chat"/><span class="name-chat">&nbsp;<span class="name-chat">'+name_user+'</span>'+
								'</div>';
							
						/*if( messages[i]['user_id'] == user_id_app ){
								
							myClass	 	= "bull-right";
							classWhite	= "date-white";
							name_user	= "";
							img_status	= '<img src="images/clock-white.png" class="image-status"/>';
								
						}*/
						
						if( messages[i]['type_message'] == 'text' ){
								
							content_message = '<li class="li-chat" id="unique-'+i+'">'+
														'<div class="chat-bull div-chat '+myClass+'">'+
														
																profil_info+
																	
																'<div class="message-chat">'+urlify(messages[i]['message'].replace(/\n/g, '<br>'))+'</div>'+
																'<div class="center-chat date-bull">'+
																	'<span class="date-conversation '+classWhite+'">&nbsp;'+date_message+'</span>'+img_status+
																'</div>'+
														'</div>'+
														'<div class="ui-hidden-accessible date-hidden">'+parent_date+'</div>'+
														
												'</li>';
															 
							$('#list-messages').append(content_message).trigger("create");
								
						}else if( messages[i]['type_message'] == 'photo' ){
								
							classWhite	= "date-white";
								
							var url_image	= url_serv+messages[i]['directory']+messages[i]['message'];
								
							content_message = '<li class="li-chat" id="unique-'+i+'">'+
														
														'<div class="chat-bull '+myClass+'">'+
																  
															profil_info+
																	
															'<div class="divChat-image" onClick="openOnePhoto(\''+url_image+'\');"></div>'+
															'<div class="center-chat date-bull">'+
																	'<span class="date-conversation '+classWhite+'">&nbsp;'+date_message+'</span>'+img_status+
															'</div>'+
														'</div>'+
														'<div class="ui-hidden-accessible date-hidden">'+parent_date+'</div>'+
														
												'</li>';
															 
								
							$('#list-messages').append(content_message).trigger("create");
								
							//alert(url_serv+messages[i]['directory']+messages[i]['message']);
								
							$('#unique-'+i+' .divChat-image').css('background', 'url("'+url_image+'")').trigger('create');
								
						}else if( messages[i]['type_message'] == 'audio' ){
								
							var url_audio	= url_serv + messages[i]['directory'] + messages[i]['message'];
								
							content_message = '<li class="li-chat" id="unique-'+messages[i]['unique_code']+'">'+
														
													'<div class="chat-audio '+myClass+'">'+
																	
														'<div class="ui-grid-b grid-audio">'+
																'<div class="ui-block-a block-image">'+
																	'<img src="'+img_profil+'" class="image-audio"/>'+
																'</div>'+
                         										'<div class="ui-block-b block-play"><a href="#" data-iconpos="notext" data-role="button" class="ui-nodisc-icon btn-transparent btn-play" data-icon="play" onClick="playingAudio(\''+url_audio+'\',\'unique-'+messages[i]['unique_code']+'\');">Play</a><a href="#" data-iconpos="notext" data-role="button" class="ui-nodisc-icon btn-transparent btn-pause" data-icon="pause" style="display:none;" onClick="pauseAudio(\'unique-'+messages[i]['unique_code']+'\');">Pause</a></div>'+
																		 '<div class="ui-block-c block-slide">'+
																			'<input type="range" name="audio_position" class="audio_position" value="0" min="0" max="100" data-highlight="true" onChange="updatePosition(\'unique-'+messages[i]['unique_code']+'\');" data-mini="true" /><span class="time-audio">00:00</span>'+
																'</div>'+
														'</div>'+
																	
														'<div class="center-chat date-bull">'+
																'<span class="date-conversation '+classWhite+'">&nbsp;'+date_message+'</span>'+img_status+
														'</div>'+
													'</div>'+
													'<div class="ui-hidden-accessible date-hidden">'+parent_date+'</div>'+	
												'</li>';
															 
								
							$('#list-messages').append(content_message).trigger("create");
								
						}else if( messages[i]['type_message'] == 'video' ){
								
							var url_video	= url_serv + messages[i]['directory'] + messages[i]['message'];
								
							content_message = '<li class="li-chat" id="unique-'+messages[i]['unique_code']+'">'+
														
													'<div class="chat-video '+myClass+'">'+
																	
														'<video controls="controls" preload="metadata">'+
															'<source src="'+url_video+'#t=0.5" type="video/mp4">'+
														'</video>'+
																	
														'<div class="center-chat date-bull">'+
																'<span class="date-conversation '+classWhite+'">&nbsp;'+date_message+'</span>'+img_status+
														'</div>'+
													'</div>'+
													'<div class="ui-hidden-accessible date-hidden">'+parent_date+'</div>'+	
												'</li>';
															 
								
							$('#list-messages').append(content_message).trigger("create");
							
						}
							
						/*$('#list-messages').append('<li class="li-chat">'+
																  '<div class="chat-bull '+myClass+'">'+
																	'<div class="name-chat" onClick="openProfilId(\''+messages[i]['user_id']+'\');">'+
																		name_user+
																	'</div>'+
																	'<div class="message-chat">'+messages[i]['message'].replace(/\n/g, '<br>')+'</div>'+
																	'<div class="center-chat date-bull">'+
																		'<span class="date-conversation '+classWhite+'">&nbsp;'+date_message+'</span>'+
																		img_status+
																	'</div>'+
																'</div>'+
																'<div class="ui-hidden-accessible date-hidden">'+parent_date+'</div>'+
															 '</li>').trigger('create');*/
							
						if( scrollEnd ){
							
							var last_li	= $("#list-messages li:last-child").offset().top;
							$.mobile.silentScroll(last_li+90);
							
						}
						
					}
					
				}
				
				$('#list-messages').listview("refresh");
				
			}
			
			//
			function startTwtChat() {
				
				if( timerTwtchat == null ){
					
					getTwtChat();
					
					timerTwtchat = setInterval(function(){
						
						if(start){
						
							getTwtChat();
							
							start = false;
							
						}
						
					}, 5000);
					
				}
				
			}
			
			function stopTwtChat() {
				
				if( timerTwtchat != null ){
					
					clearInterval(timerTwtchat);
					
					timerTwtchat = null;
					
				}
				
			}
			
			//
			function toastMessage(message, color){
				
				window.plugins.toast.showWithOptions({
															message: message,
															duration: 4000, // 2000 ms
															position: "bottom",
															styling: {
															  opacity: 0.75, // 0.0 (transparent) to 1.0 (opaque). Default 0.8
															  backgroundColor: color, // make sure you use #RRGGBB. Default #333333
															  textColor: '#FFFFFF', // Ditto. Default #FFFFFF
															  textSize: 20.5, // Default is approx. 13.
															  cornerRadius: 16, // minimum is 0 (square). iOS default 20, Android default 100
															  horizontalPadding: 20, // iOS default 16, Android default 50
															  verticalPadding: 16 // iOS default 12, Android default 30
															}
				});
				
			}
			
			//
			function signup() {
				
				$.mobile.loading("show",{
						text: "Download",
						textVisible: false,
						theme: 'q',
						html: ''
				});
				
				var name		= $('#name_signup').val();
				var email		= $('#email_signup').val();
				var phone		= $('#phone_signup').val();
				var password	= $('#password_signup').val();
				var Repassword	= $('#Vpassword_signup').val();
				
				if( !name || !email || !password || !phone ) {

					toastMessage("Empty parameters", color_error);
					
					$.mobile.loading("hide");
					
				}else{
					
					var signup = true;
					
					if( password.length < 6 ){
						
						toastMessage("Use 6 characters or more for your password", color_error);
						
						signup = false;
						
						$.mobile.loading("hide");
						
					}else if( password != Repassword ){
						
						toastMessage("Those passwords didn't match. Try again.", color_error);
						
						signup = false;
						
						$.mobile.loading("hide");
						
					}
					
					if( ! (phone).match(/^(?:(?:\(?(?:00|\+)([1-4]\d\d|[1-9]\d?)\)?)?[\-\.\ \\\/]?)?((?:\(?\d{1,}\)?[\-\.\ \\\/]?){0,})(?:[\-\.\ \\\/]?(?:#|ext\.?|extension|x)[\-\.\ \\\/]?(\d+))?$/i) ){
						
						toastMessage("This phone number format is not recognized. Please confirm the number.", color_error);
						
						signup = false;
						
						$.mobile.loading("hide");
						
					}
					
					if( signup ){
						
						$('#btn_signup').addClass('ui-disabled');
						
						var deviceType			= window.localStorage.getItem('deviceType');
						var registrationId		= window.localStorage.getItem('registrationId');
						
						var postData = "name="+encodeURIComponent(name)+"&email="+encodeURIComponent(email)+"&password="+encodeURIComponent(CryptoJS.MD5(password))+"&phone="+encodeURIComponent(phone)+"&deviceType="+encodeURIComponent(deviceType)+"&registrationId="+encodeURIComponent(registrationId);
				 
						$.ajax({
							type: "POST",
							url: url_serv+'signup.php',
							data: postData,
							async: true,
							success: function(data){
									
									if(data['success']){
										
										toastMessage( data['valide_message'], color_app );
										
										window.localStorage.setItem("user_id", data['user_id'] );
										window.localStorage.setItem("name", name );
										window.localStorage.setItem("email", email );
										window.localStorage.setItem("phone", phone );
										window.localStorage.setItem("status_text", data['status_text'] );
										window.localStorage.setItem("password", CryptoJS.MD5(password) );
										window.localStorage.setItem("photoProfil", data['photoProfil'] );
										
										$('.title-name').text(name);
										$('#name_text').val(name);
										$('.title-status').text(data['status_text']);
										$('#status_text').val(data['status_text']);
										
										$('.title-email').text(email);
										$('.title-phone').text(phone);
										
										email_app		= email;
										password_app	= window.localStorage.getItem("password");
										name_app		= name;
										user_id_app	= data['user_id'];
										phone_app		= phone;
										
										var elems = document.getElementsByClassName('photo_profil');
											
										if( data['photoProfil'] != null ){
												
											for (var i = 0; i < elems.length; i++) {
													
												elems[i].src = url_serv + data['photoProfil'];
													
											}
												
										}else{
											
											for (var i = 0; i < elems.length; i++) {
													
												elems[i].src = 'images/profil.png';
													
											}
											
										}
										
										startTwtChat();
										
										$.mobile.changePage( "#pageHome", { transition: "fade", changeHash: true });
										
									}else{
										
										toastMessage( data['error_message'], color_error);
										
									}
									
									$('#btn_signup').removeClass('ui-disabled');
									
									$.mobile.loading("hide");
									
							},
							error: function(xhr, status, error) {
										
									$.mobile.loading("hide");
									
									toastMessage( "No Connection" , color_error );
										
									$('#btn_signup').removeClass('ui-disabled');
										
							},
							dataType: 'json'});
							
					}
					
				}
				
			}
			
			//Signin
			function signin(){
				
				$.mobile.loading("show",{
						text: "Login ...",
						textVisible: false,
						theme: 'q',
						html: ''
				});
				
				var email		= $('#email_signin').val();
				var password	= $('#password_signin').val();
				
				if( !password || !email ) {
					
					toastMessage( "Empty parameters", color_error);
					
					$.mobile.loading("hide");
					
				}else{
					
					$('#btn_signin').addClass('ui-disabled');
					
					var deviceType			= window.localStorage.getItem('deviceType');
					var registrationId		= window.localStorage.getItem('registrationId');
					
					var postData = "email="+encodeURIComponent( email )+"&password="+encodeURIComponent( CryptoJS.MD5(password) )+"&deviceType="+encodeURIComponent(deviceType)+"&registrationId="+encodeURIComponent(registrationId);
					
					$.ajax({
							type: "POST",
							url: url_serv+'signin.php',
							data: postData,
							async: true,
							success: function(data){
									
									if(data['success']){
										
										window.localStorage.setItem("user_id", data['user_id'] );
										window.localStorage.setItem("name", data['name'] );
										window.localStorage.setItem("email", data['email'] );
										window.localStorage.setItem("phone", data['phone'] );
										window.localStorage.setItem("status_text", data['status_text'] );
										window.localStorage.setItem("password", CryptoJS.MD5(password) );
										window.localStorage.setItem("photoProfil", data['photoProfil'] );
										window.localStorage.setItem("notify", data['notify'] );
										
										$('.title-name').text(data['name']);
										$('#name_text').val(data['name']);
										$('.title-status').text(data['status_text']);
										$('#status_text').val(data['status_text']);
										
										$('.title-email').text(data['email']);
										$('.title-phone').text(data['phone']);
										
										$('#email_signin').val('');
										$('#password_signin').val('');
										
										email_app		= data['email'];
										password_app	= window.localStorage.getItem("password");
										name_app		= data['name'];
										user_id_app	= data['user_id'];
										phone_app		= data['phone'];
										
										var elems = document.getElementsByClassName('photo_profil');
											
										if( data['photoProfil'] != null ){
												
											for (var i = 0; i < elems.length; i++) {
													
												elems[i].src = url_serv + data['photoProfil'];
													
											}
												
										}else{
											
											for (var i = 0; i < elems.length; i++) {
													
												elems[i].src = 'images/profil.png';
													
											}
											
										}
										
										startTwtChat();
										
										$.mobile.changePage( "#pageHome", { transition: "fade", changeHash: true });
										
										
									}else{
										
										$('#password_signin').val('');
										
										toastMessage( data['error_message'], color_error );
										
									}
									
									$('#btn_signin').removeClass('ui-disabled');
									
									$.mobile.loading("hide");
									
							},
							error: function(xhr, status, error) {
								
									$.mobile.loading("hide");
									
									$('#btn_signin').removeClass('ui-disabled');
									
									toastMessage( "No Connection" , color_error );
									
							},
							dataType: 'json'
					});
				
				}
					
			}
			
			//
			function cancelInfo() {
				
				var name	= window.localStorage.getItem("name");
				var status	= window.localStorage.getItem("status_text");
				
				$('#name_text').val(name);
				$('#status_text').val(status);
				
				$('#cancel-info').hide();
				$('#done-info').hide();
				
				$('#back-info').show();
				
			}
			
			//
			function updateInfo() {
				
				$.mobile.loading("show",{
						text: "Loading ...",
						textVisible: false
				});
				 
				var name 	= $('#name_text').val();
				var status	= $('#status_text').val();
				
				if( !name || !status ) {
					
					toastMessage( "Enter a name or status" , color_error );
					
					$.mobile.loading("hide");
					
				}else{
						
					var postData = "email="+encodeURIComponent(email_app)+"&password="+encodeURIComponent(password_app)+"&name="+encodeURIComponent(name)+"&status="+encodeURIComponent(status);
				 
					$.ajax({
							type: "POST",
							url: url_serv+'changeInfo.php',
							data: postData,
							async: true,
							success: function(data){
									
									if(data['success']){
										
										toastMessage( "Updated" , color_app );
										
										$('.title-name').text(name);
										$('.title-status').text(status);
										
										window.localStorage.setItem("name", name);
										window.localStorage.setItem("status_text", status);
										
										$('#cancel-info').hide();
										$('#done-info').hide();
										
										$('#back-info').show();
										
									}else{
										
										toastMessage( data['error_message'] , color_error );
										
									}
									
									$.mobile.loading("hide");
									
							},
							error: function(xhr, status, error) {
									
									$.mobile.loading("hide");
									
									toastMessage( "No Connection" , color_error );
									
							},
							dataType: 'json'
					});
				
				}
				
			}
			
			//
			function openDoublePopup(popup1, popup2){
				
				$('#'+popup1).popup("close");
				
				setTimeout(function()
				{
					$('#'+popup2).popup("open", {transition:"slideup"});
				}, 300);
				
			}
			
			//
			function openAudio(popup) {
				
				$('#'+popup).popup("close");
				
				$('#play-record').addClass('ui-disabled');
				
				$('#footer-chat').hide();
				$('#footer-audio').show();
				
			}
			
			function hideAudio() {
				
				window.localStorage.removeItem("FILE_MESSAGE");
				
				if(timerRecord){
				
					stopRecord();
				
				}
				
				$('#footer-chat').show();
				$('#footer-audio').hide();
				
				$("#timer").html("00:00");
				
			}
			
			//
			/*function recordSound(){
				
				navigator.device.capture.captureAudio(captureAudioSuccess, captureAudioError, {duration:10});
				
			}
			
			var captureAudioError = function(e) {
				console.log('captureError' ,e);
			}
			
			var captureAudioSuccess = function(e) {
				console.log('captureSuccess');
				console.dir(e);
				soundFile = e[0].localURL;
				soundFilePath = e[0].fullPath;
			}
			
			//
			function playSound(){
				
				if(!soundFile) {
					navigator.notification.alert("Record a sound first.", null, "Error");
					return;
				}
				
				var media = new Media(soundFile, function(e) {
					
					media.release();
					
				}, function(err) {
					
					console.log("media err", err);
					
				});
				
				media.play();
				
			}*/
			
			var recorder = new Object;
			
			//
			function recordTimer() {
				
				timerRecord = setInterval(function() {
				
					var myTime	= $("#timer").html();
					var ss		= myTime.split(":");
					var dt		= new Date();
					
					dt.setHours(0);
					dt.setMinutes(ss[0]);
					dt.setSeconds(ss[1]);
			
					var dt2		= new Date(dt.valueOf() + 1000);
					var temp	= dt2.toTimeString().split(" ");
					var ts		= temp[0].split(":");
			
					$("#timer").html(ts[1]+":"+ts[2]);
				
				}, 1000);
				
			}
			
			function stopTimerRecord() {
				
				$('#start-record').show();
				$('#stop-record').hide();
				
				if(timerRecord){
					
					clearInterval(timerRecord);
					
					timerRecord = null;
					
				}
				
				$('#play-record').removeClass('ui-disabled');
				
			}
			
			recorder.stop = function() {
				
				stopTimerRecord();
				
				window.plugins.audioRecorderAPI.stop( function(msg) {
					// success
					
					//alert('ok: ' + msg);
					
					window.localStorage.setItem("FILE_MESSAGE", msg);
					
				}, function(msg) {
					// failed
				
					toastMessage( 'Error record : '+msg , color_error );
					
					stopTimerRecord();
					
				});
			  
			}
			
			recorder.record = function() {
				
				$('#start-record').hide();
				$('#stop-record').show();
				
				$("#timer").html("00:00");
				
				$('#play-record').addClass('ui-disabled');
				
				recordTimer();
				
				window.plugins.audioRecorderAPI.record( function(msg) {
					// complete
					
					//alert('ok: ' + msg);
					
					window.localStorage.setItem("FILE_MESSAGE", msg);
					
					stopTimerRecord();
					
				}, function(msg) {
					// failed
				
					toastMessage( 'Error record : '+msg , color_error );
					
					stopTimerRecord();
					
				}, 120); // record 30 seconds
			  
			}
			
			recorder.playback = function() {
				
				$('#play-record').addClass('ui-disabled');
				
				window.plugins.audioRecorderAPI.playback( function(msg) {
					// complete
					//alert('ok: ' + msg);
					
					$('#play-record').removeClass('ui-disabled');
					
				}, function(msg) {
					// failed
				
					toastMessage( 'Error record : '+msg , color_error );
				
			  	});
			  
			}
			
			//
			function playRecord(){
				
				var deviceType = window.localStorage.getItem('deviceType');
				
				if( deviceType == "android" ){
					
					window.plugins.audioRecorderAPI.dopermissions(function (msg) {
						// success
						console.log('Audio permissions ok: ' + msg);
						
						recorder.record();
						
					}, function (msg) {
						// failed
						console.error("audioRecorderAPI: permission not granted");
						
						//alert("The app needs access to your microphone to function.");
						
						navigator.notification.alert(
							'The app needs access to your microphone to function.',  // message
							function() {
							},         // callback
							'Permission not granted',            // title
							'Done'                  // buttonName
						);
						
					});
					
				}else {
					
					recorder.record();
					
				}
				
				/**/
				
			}
			
			//
			function stopRecord(){
				
				recorder.stop();
				
			}
			
			//
			function playSound(){
				
				recorder.playback();
				
			}
			
			//
			function closePopup(id){
				
				$('#'+id).popup('close');
				
			}
			
			//Change photo
			function changePhotoProfil(imageURI) {
				
				$.mobile.loading("show",{
						text: "Loading ...",
						textVisible: false,
						theme: 'q',
						html: ''
				});
				
				var options			= new FileUploadOptions();
				options.fileKey		= "file";
				options.fileName		= imageURI.substr(imageURI.lastIndexOf('/')+1);
				options.mimeType		= "image/jpeg";
				options.httpMethod		= 'POST';
				
				
				var params				= new Object();
				params.email			= email_app;
				params.password		= password_app;
				
				options.params			= params;
				options.chunkedMode	= false;
	 
				var ft = new FileTransfer();
				ft.upload(imageURI, encodeURI(url_serv+"changePhotoProfil.php"), winProfil, fail, options);
				
			}
			
			//
			function winProfil(r) {
				
				console.log("Code = " + r.responseCode);
				console.log("Response = " + r.response);
				console.log("Sent = " + r.bytesSent);
				
				var response_tab = JSON.parse(r.response);
			
				//alert(response_tab['error_message']);
				
				if(response_tab['error_message'] == ""){
				
					toastMessage( 'Image changed', color_app );
					
					if( response_tab['photoProfil'] != null ){
					
						var elems = document.getElementsByClassName('photo_profil');
											
						for (var i = 0; i < elems.length; i++) {
													
							elems[i].src = url_serv + response_tab['photoProfil'];
													
						}
						
						window.localStorage.setItem("photoProfil", response_tab['photoProfil'] );
						
						
					}
					
				}else {
					
					toastMessage( response_tab['error_message'], color_error );
					
				}
				
				
				$.mobile.loading("hide");
				
			}
			
			//
			function fail(error) {
				
				toastMessage( "File not uploaded" , color_error );
				
				console.log("upload error source " + error.source);
				console.log("upload error target " + error.target);
				
				$.mobile.loading("hide");
				
			}
			
			//
			function getUpdatePhotoGroup() 
			{	
				
				navigator.camera.getPicture(onUpdatePhotoGroupDataSuccess, onFail, { quality: 50,
																		  targetWidth: 300,
        																  targetHeight: 300,
																		  allowEdit:true,
																		  destinationType: destinationType.FILE_URI,
																		  encodingType: Camera.EncodingType.JPEG,
																		  sourceType: pictureSource.PHOTOLIBRARY
																		});
				
				
			}
			
			//
			function onUpdatePhotoGroupDataSuccess(imageURI) {
				
				if( imageURI != null ){
					
					updatePhotoGroup(imageURI.split("?")[0]);
					
				}else {
					
					toastMessage( "Image not uploaded" , color_error );
					
				}
				
				
			}
			
			//
			function updatePhotoGroup(imageURI) {
				
				$.mobile.loading("show",{
						text: "Loading ...",
						textVisible: false
				});
				
				var group_id			= $('#group_id').val();
				
				//alert(group_id);
				
				var options			= new FileUploadOptions();
				options.fileKey		= "file";
				options.fileName		= imageURI.substr(imageURI.lastIndexOf('/')+1);
				options.mimeType		= "image/jpeg";
				options.httpMethod		= 'POST';
					
					
				var params				= new Object();
				params.email			= email_app;
				params.password		= password_app;
				params.group_id		= group_id;
					
				options.params			= params;
				options.chunkedMode	= false;
		 
				var ft = new FileTransfer();
				ft.upload(imageURI, encodeURI(url_serv+"updatePhotoGroup.php"), winUpdateGroup, fail, options);
				
			}
			
			//
			function winUpdateGroup(r) {
				
				console.log("Code = " + r.responseCode);
				console.log("Response = " + r.response);
				console.log("Sent = " + r.bytesSent);
				
				var response_tab = JSON.parse(r.response);
				
				if( response_tab['error_message'] == "" ){
				
					if( response_tab['photo_url'] != null ){
															
						img_src = url_serv + response_tab['photo_url'];
						
						$('#photo_infoGroup').css('background-image', 'url("'+img_src+'")' ).trigger('create');
						
					}
					
				}else {
					
					toastMessage( response_tab['error_message'], color_error );
					
				}
				
				
				$.mobile.loading("hide");
				
			}
			
			//
			function openOnePhoto(imageURL) {
			
				document.getElementById('imageOpen').src = imageURL;
					
				$.mobile.changePage( "#pageOpenGallery", { transition: "pop", changeHash: true });
					
			}
			
			//
			function sendCameraVideo(popup, type) 
			{	
				
				$('#footer-videoChat').hide();
				$('#footer-videoStatus').hide();
				
				if( type == 'status' ){
					
					$('#footer-videoStatus').show();
					
				}else if( type == 'chat' ){
					
					$('#footer-videoChat').show();
					
				}
				
				$('#'+popup).popup('close');
				
				navigator.device.capture.captureVideo( captureSuccess, captureError, { limit: 1, quality: 0 } );
				
				
			}
			
			//
			function captureError(e) {
				console.log("capture error: "+JSON.stringify(e));
			}
			
			//
			function captureSuccess(s) {
				
				console.log("Success");
				console.dir(s[0]);
				
				var file = s[0];
				
				window.localStorage.setItem("VIDEO_SAVE", file.fullPath);
				
				VideoEditor.getVideoInfo(
					getVideoInfoSuccess,
					getVideoInfoError,
					{
						fileUri: file.fullPath,
					}
				);
				
				/*var videoFileName = (new Date().getUTCMilliseconds()).toString(); // I suggest a uuid
			
				VideoEditor.transcodeVideo(
					videoTranscodeSuccess,
					videoTranscodeError,
					{
						fileUri: file.fullPath,
						outputFileName: videoFileName,
						outputFileType: VideoEditorOptions.OutputFileType.MPEG4,
						optimizeForNetworkUse: VideoEditorOptions.OptimizeForNetworkUse.YES,
						saveToLibrary: false,
						maintainAspectRatio: true,
						width: 540,
						height: 540,
						videoBitrate: 1000000, // 1 megabit
						audioChannels: 2,
						audioSampleRate: 44100,
						audioBitrate: 128000, // 128 kilobits
						progress: function(info) {
							console.log('transcodeVideo progress callback, info: ' + info);
						}
					}
				);*/
				
			}
			
			function videoTranscodeSuccess(result) {
				
				// result is the path to the transcoded video on the device
				console.log('videoTranscodeSuccess, result: ' + result);
				//alert('videoTranscodeSuccess, result: ' + result);
				
				$.mobile.loading("hide");
				
				var v = "<video controls='controls' preload='metadata' class='allVideo'>";
				v += "<source src='" + result + "#t=0.1' type='video/mp4'>";
				v += "</video>";
				
				document.querySelector("#videoArea").innerHTML = v;
				
				window.localStorage.setItem("FILE_MESSAGE", result);
				
				$.mobile.changePage( "#pageSendVideo", { transition: "pop", changeHash: true });
				
			}
			
			function videoTranscodeError(err) {
				
				console.log('videoTranscodeError, err: ' + err);
				
				$.mobile.loading("hide");
				
			}
			
			//
			function sendCameraPhoto(popup, type) 
			{	
				
				$('#footer-photoChat').hide();
				$('#footer-photoStatus').hide();
				
				if( type == 'status' ){
					
					$('#footer-photoStatus').show();
					
				}else if( type == 'chat' ){
					
					$('#footer-photoChat').show();
					
				}
				
				$('#'+popup).popup('close');
				
				navigator.camera.getPicture(onPhotoSendDataSuccess, onFail, { quality: 50, 
																		  destinationType: destinationType.FILE_URI,
																		  encodingType: Camera.EncodingType.JPEG,
																		  sourceType: pictureSource.CAMERA
																		});
				
				
			}
			
			//
			function sendGalleryVideo(popup, type) 
			{	
				
				$('#footer-videoChat').hide();
				$('#footer-videoStatus').hide();
				
				if( type == 'status' ){
					
					$('#footer-videoStatus').show();
					
				}else if( type == 'chat' ){
					
					$('#footer-videoChat').show();
					
				}
				
				$('#'+popup).popup('close');
				
				navigator.camera.getPicture(onVideoSendDataSuccess, onFail, { quality: 50,
																		  correctOrientation: true,
																		  destinationType: destinationType.FILE_URI,
																		  encodingType: Camera.EncodingType.JPEG,
																		  sourceType: pictureSource.PHOTOLIBRARY,
																		  mediaType: Camera.MediaType.VIDEO
																		});
				
				
			}
			
			//
			function onVideoSendDataSuccess(videoURI) {
				
				//alert(videoURI);
				
				var file = videoURI;
				
				if (cordova.platformId === 'android' && !(new RegExp(location.protocol + '//')).test(file)) {
    				file = location.protocol + '//' + file;
				}
				
				//alert(file);
				
				window.localStorage.setItem("VIDEO_SAVE", file);
				
				VideoEditor.getVideoInfo(
					getVideoInfoSuccess,
					getVideoInfoError,
					{
						fileUri: file
					}
				);
				
				
				/*var videoFileName = (new Date().getUTCMilliseconds()).toString(); // I suggest a uuid
			
				VideoEditor.transcodeVideo(
					videoTranscodeSuccess,
					videoTranscodeError,
					{
						fileUri: file,
						outputFileName: videoFileName,
						outputFileType: VideoEditorOptions.OutputFileType.MPEG4,
						optimizeForNetworkUse: VideoEditorOptions.OptimizeForNetworkUse.YES,
						saveToLibrary: false,
						maintainAspectRatio: true,
						width: 540,
						height: 540,
						videoBitrate: 1000000, // 1 megabit
						audioChannels: 2,
						audioSampleRate: 44100,
						audioBitrate: 128000, // 128 kilobits
						progress: function(info) {
							console.log('transcodeVideo progress callback, info: ' + info);
						}
					}
				);*/
				
			}
			
			function getVideoInfoSuccess(info) {
				
				//alert(info.width + " " +info.height);
				
				//alert(info.size);
				
				$.mobile.loading("show",{
						text: "Loading ...",
						textVisible: false
				});
				
				var file = window.localStorage.getItem("VIDEO_SAVE");
				
				var videoFileName = (new Date().getUTCMilliseconds()).toString(); // I suggest a uuid
				
				var outputWidth 	= 420;
				var outputHeight	= 420;
				
				/*var aspectRatio 	= info.width / info.height;
				
				var height			= 480;
				
				if( aspectRatio > 1 ){
					
					height = 480;
					
				}
				
				var outputWidth 	= height * aspectRatio;
				var outputHeight	= outputWidth / aspectRatio;
				
				/*alert(outputWidth+" "+outputHeight);
				
				if( outputWidth	>= 1080 || outputHeight >= 1080 ){
				
					outputWidth	= 480;
					outputHeight	= 640;
				
				}
				
				alert(outputWidth+" "+outputHeight);*/
				
				VideoEditor.transcodeVideo(
					videoTranscodeSuccess,
					videoTranscodeError,
					{
						fileUri: file,
						outputFileName: videoFileName,
						outputFileType: VideoEditorOptions.OutputFileType.MPEG4,
						optimizeForNetworkUse: VideoEditorOptions.OptimizeForNetworkUse.YES,
						saveToLibrary: false,
						maintainAspectRatio: true,
						width: outputWidth,
						height: outputHeight,
						videoBitrate: 420000, // 1 megabit
						fps: 24,
						audioChannels: 2,
						audioSampleRate: 44100,
						audioBitrate: 128000, // 128 kilobits
						progress: function(info) {
							console.log('transcodeVideo progress callback, info: ' + info);
						}
					}
				);
				
			}
			
			function getVideoInfoError(error) {
				
				toastMessage( "Error Info Video : "+error , color_error );
				
			}
			
			//
			function sendGalleryPhoto(popup, type) 
			{	
				
				$('#footer-photoChat').hide();
				$('#footer-photoStatus').hide();
				
				if( type == 'status' ){
					
					$('#footer-photoStatus').show();
					
				}else if( type == 'chat' ){
					
					$('#footer-photoChat').show();
					
				}
				
				$('#'+popup).popup('close');
				
				navigator.camera.getPicture(onPhotoSendDataSuccess, onFail, { quality: 50,
																		  correctOrientation: true,
																		  destinationType: destinationType.FILE_URI,
																		  encodingType: Camera.EncodingType.JPEG,
																		  sourceType: pictureSource.PHOTOLIBRARY,
																		  mediaType: Camera.MediaType.PHOTO
																		});
				
				
			}
			
			//
			function onPhotoSendDataSuccess(imageURI) {
			
				if( imageURI != null ){
					
					document.getElementById('imageSend').src = imageURI.split("?")[0];
					
					window.localStorage.setItem("FILE_MESSAGE", imageURI.split("?")[0]);

					$.mobile.changePage( "#pageSendGallery", { transition: "slideup", changeHash: true });
					
					//alert(imageURI.split("?")[0]);
					
					/*var index = document.getElementsByClassName('img-filter').length;
					
					for(var i=0; i < index; i++){
						
						document.getElementsByClassName('img-filter')[i].src = imageURI.split("?")[0];
						
						var idFilter = document.getElementsByClassName('img-filter')[i].id;
						
						ApplyEffects[idFilter]( document.getElementById(idFilter), 'jpeg');
						
					}*/
					
					//
					
				}else {
					
					toastMessage( "Image not uploaded" , color_error );
					
				}
				
			}
			
			//
			function filterImage(filter){
				
				/*$('#imageSend').parent().removeClass();
				
				if( filter != 'none' ){
					
					$('#imageSend').parent().addClass('filter-'+filter);
					
				}*/
				
				var img = document.getElementById("imageSend");
				
				alert( document.getElementById("imageSend").src );
				
				ApplyEffects[filter](img, 'jpeg');
				
				alert( document.getElementById("filteredPhoto").src );
				
				$('#filteredPhoto').addClass('fullImage');
				
			}
			
			//
			function getPhotoGroup() 
			{	
				
				navigator.camera.getPicture(onPhotoGroupDataSuccess, onFail, { quality: 50,
																		  targetWidth: 300,
        																  targetHeight: 300,
																		  allowEdit:true,
																		  destinationType: destinationType.FILE_URI,
																		  encodingType: Camera.EncodingType.JPEG,
																		  sourceType: pictureSource.PHOTOLIBRARY
																		});
				
				
			}
			
			//
			function onPhotoGroupDataSuccess(imageURI) 
			{
			
				if( imageURI != null ){
					
					
					document.getElementById('photo_group').src = imageURI.split("?")[0];
					
					window.localStorage.setItem( "GROUP_PHOTO", imageURI.split("?")[0] );
					
				}else {
					
					toastMessage( "Image not uploaded" , color_error );
					
				}
				
			}
			
			//
			function capturePhotoProfil(popupId)
			{
				
				$('#'+popupId).popup('close');
				
				navigator.camera.getPicture(onPhotoProfilDataSuccess, onFail, { quality: 50, 
																		  targetWidth: 300,
        																  targetHeight: 300,
																		  allowEdit:true,
																		  destinationType: destinationType.FILE_URI,
																		  encodingType: Camera.EncodingType.JPEG,
																		  sourceType: pictureSource.CAMERA
																		});
																		
			}
			
			//
			function setPhotoWallpaper() 
			{	
				
				navigator.camera.getPicture(onPhotoWallpaperDataSuccess, onFail, { quality: 50,
																		  correctOrientation: true,
																		  destinationType: destinationType.FILE_URI,
																		  encodingType: Camera.EncodingType.JPEG,
																		  sourceType: pictureSource.PHOTOLIBRARY
																		});
				
				
			}
			
			//
			//
			function onPhotoWallpaperDataSuccess(imageURI) 
			{
			
				if( imageURI != null ){
					
					//alert( imageURI );
					
					openPhotoPreview( imageURI );
					
				}else {
					
					toastMessage( "Error set Wallpaper" , color_error );
					
				}
				
			}
			
			//
			function getPhotoProfil( popupId ) 
			{	
				
				$('#'+popupId).popup('close');
				
				navigator.camera.getPicture(onPhotoProfilDataSuccess, onFail, { quality: 50,
																		  targetWidth: 300,
        																  targetHeight: 300,
																		  allowEdit:true,
																		  destinationType: destinationType.FILE_URI,
																		  encodingType: Camera.EncodingType.JPEG,
																		  sourceType: pictureSource.PHOTOLIBRARY
																		});
				
				
			}
			
			//
			function onPhotoProfilDataSuccess(imageURI) 
			{
			
				if( imageURI != null ){
					
					changePhotoProfil( imageURI.split("?")[0] );
					
				}else {
					
					toastMessage( "Image not uploaded" , color_error );
					
				}
				
			}
			
			//
			function onFail(message) 
			{
				
				console.log('Failed because: ' + message);
				
			}
			
			//
			function forgotPassword() {
				
				$.mobile.loading("show",{
						text: "Loading ...",
						textVisible: false
				});
				 
				var email      = $('#email_forgot').val();
				
				if( !email ) {
					
					toastMessage( "Enter a email" , color_error );
					
					$.mobile.loading("hide");
					
				}else{
						
					var postData = "email="+encodeURIComponent(email);
				 
					$.ajax({
							type: "POST",
							url: url_serv+'forgetPassword.php',
							data: postData,
							async: true,
							success: function(data){
									
									if(data['success']){
										
										toastMessage( "A message has been sent to your email address, please follow the instructions to restore your account." , color_app );
										
										$('#email_password').val( email );
										
										$.mobile.changePage( "#pageVerifyPassword", { transition: "fade", changeHash: true });
										
									}else{
										
										toastMessage( data['error_message'] , color_error );
										
									}
									
									$.mobile.loading("hide");
									
							},
							error: function(xhr, status, error) {
									
									$.mobile.loading("hide");
									
									toastMessage( "No Connection" , color_error );
									
							},
							dataType: 'json'
					});
				
				}
				
			}
			
			//
			function verifyPassword() {
				
				$.mobile.loading("show",{
						text: "Loading...",
						textVisible: false
				});
				 
				var code_forgot 	= $('#code_password').val();
				var email_verify	= $('#email_password').val();
				
				if( !code_forgot ) {
					
					toastMessage( "Please enter a verification code" , color_error );
					
					$.mobile.loading("hide");
					
				}else{
						
					var postData = "email="+encodeURIComponent(email_verify)+"&forgotCode="+encodeURIComponent(code_forgot);
				 
					$.ajax({
							type: "POST",
							url: url_serv+'verifyCode.php',
							data: postData,
							async: true,
							success: function(data){
									
									if( data['success'] ){
										
										$('#forgotCode').val( code_forgot );
										$('#emailForgot').val( email_verify );
										
										$.mobile.changePage( "#pageChangePassword", { transition: "fade", changeHash: true });
										
									}else{
										
										toastMessage( data['error_message'] , color_error );
										
									}
									
									$.mobile.loading("hide");
									
							},
							error: function(xhr, status, error) {
									
									$.mobile.loading("hide");
									
									toastMessage( "No Connection" , color_error );
									
							},
							dataType: 'json'
							
					});
				
				}
				
			}
			
			//
			function updateUnreadMessage(relation_id) {
				
				var postData = "email="+encodeURIComponent(email_app)+"&password="+encodeURIComponent(password_app)+"&relation_id="+encodeURIComponent(relation_id);
				 	
				$.ajax({
							type: "POST",
							url: url_serv+'readPrivates.php',
							data: postData,
							async: true,
							success: function(data){
									
									if( data['success'] ){
										
										//toastMessage( "Read" , color_app );
										
									}
									
							},
							error: function(xhr, status, error) {
									
									//toastMessage( "No Connection" , color_error );
									
							},
							dataType: 'json'
							
				});
				
				
			}
			

			//
			function updateUnreadGroup(groups_id) {
				
				var postData = "email="+encodeURIComponent(email_app)+"&password="+encodeURIComponent(password_app)+"&groups_id="+encodeURIComponent(groups_id);
				 	
				$.ajax({
							type: "POST",
							url: url_serv+'readGroups.php',
							data: postData,
							async: true,
							success: function(data){
									
									if( data['success'] ){
										
										//toastMessage( "Read" , color_app );
										
									}
									
							},
							error: function(xhr, status, error) {
									
									//toastMessage( "No Connection" , color_error );
									
							},
							dataType: 'json'
							
				});
				
				
			}
			
			//
			function sendFriendRequest(user_two) {
				
				var postData = "email="+encodeURIComponent(email_app)+"&password="+encodeURIComponent(password_app)+"&user_two="+encodeURIComponent(user_two);
				 	
				$.ajax({
							type: "POST",
							url: url_serv+'sendFriendRequest.php',
							data: postData,
							async: true,
							success: function(data){
									
									if( data['success'] ){
										
										toastMessage( "A friendship request was sent to him" , color_app );
										
										$('#li-searchFriend'+user_two).hide();
										
									}else{
										
										toastMessage( data['error_message'] , color_error );
										
									}
									
							},
							error: function(xhr, status, error) {
									
									$('#img_loading').hide();
									
									toastMessage( "No Connection" , color_error );
									
							},
							dataType: 'json'
							
				});
				
				
			}
			
			//
			//
			function searchGroups() {
				
				$('#img_loadingGroup').show();
				
				$('#list-searchGroup').empty();
				$('#noSearchGroup-div').hide();
				 
				var searchTxt 	= $('#search_group').val();
				
				if( !searchTxt ) {
					
					toastMessage( "Please enter a name of group " , color_error );
					
					$('#img_loadingGroup').hide();
					
				}else{
						
					var postData = "email="+encodeURIComponent(email_app)+"&password="+encodeURIComponent(password_app)+"&searchTxt="+encodeURIComponent(searchTxt);
				 	
					//alert(postData);
					
					$.ajax({
							type: "POST",
							url: url_serv+'searchGroups.php',
							data: postData,
							async: true,
							success: function(data){
									
									//alert(JSON.stringify(data));
									
									$('#img_loadingGroup').hide();
									
									if( data['error_message'] != "" ){
										
										toastMessage( data['error_message'] , color_error );
										
									}else{
										
										if( data['groups'] != undefined ){
											
											var groups = data['groups'];
											
											for(var i=0; i < groups.length; i++){
												
												var img_src = "images/groups.png";
												
												if( groups[i]['photo_url'] != null ){
													
													img_src = url_serv + groups[i]['directory'] + groups[i]['photo_url'];
													
												}
												
												$('#list-searchGroup').append('<li id="li-searchGroup'+groups[i]['id']+'">'+
																					'<div class="ui-grid-b">'+
																						   '<div class="ui-block-a block3-photo" onClick="openGroupId(\''+groups[i]['id']+'\');"><img src="'+img_src+'" class="roundedSmall"></div>'+
																						   '<div class="ui-block-b block3-text" onClick="openGroupId(\''+groups[i]['id']+'\');">'+
																								'<p class="name-profil">'+groups[i]['name']+'</p>'+
																								'<p class="status-profil">'+groups[i]['description']+'</p>'+
																						   '</div>'+
																						   '<div class="ui-block-c block3-btn" align="right"><a href="#" data-role="button" data-icon="plus" data-iconpos="notext" class="btn-app ui-nodisc-icon btn-nomargin" onClick="addGroupConfirm(\''+groups[i]['id']+'\', \''+groups[i]['name']+'\');"></a></div>'+
																					'</div>'+
																				  '</li>').trigger('create');
												
											}
											
											$('#list-searchGroup').listview("refresh");
											
										}else { // No friend
										
											$('#noSearchGroup-div').show();
											
										}
										
									}
									
							},
							error: function(xhr, status, error) {
									
									$('#img_loading').hide();
									
									toastMessage( "No Connection" , color_error );
									
							},
							dataType: 'json'
							
					});
				
				}
				
			}
			
			//
			function searchUsers() {
				
				$('#img_loading').show();
				
				$('#list-searchFriend').empty();
				$('#noSearch-div').hide();
				 
				var searchTxt 	= $('#search_text').val();
				
				if( !searchTxt ) {
					
					toastMessage( "Please enter a name, phone or email " , color_error );
					
					$('#img_loading').hide();
					
				}else{
						
					var postData = "email="+encodeURIComponent(email_app)+"&password="+encodeURIComponent(password_app)+"&searchTxt="+encodeURIComponent(searchTxt);
				 	
					//alert(postData);
					
					$.ajax({
							type: "POST",
							url: url_serv+'searchUsers.php',
							data: postData,
							async: true,
							success: function(data){
									
									//alert(JSON.stringify(data));
									
									$('#img_loading').hide();
									
									if( data['error_message'] != "" ){
										
										toastMessage( data['error_message'] , color_error );
										
									}else{
										
										if( data['users'] != undefined ){
											
											var users = data['users'];
											
											for(var i=0; i < users.length; i++){
												
												var img_src = "images/profil.png";
												
												if( users[i]['photo_profil'] != null ){
													
													img_src = url_serv + users[i]['directory'] + users[i]['photo_profil'];
													
												}
												
												$('#list-searchFriend').append('<li id="li-searchFriend'+users[i]['id']+'">'+
																					'<div class="ui-grid-b">'+
																						   '<div class="ui-block-a block3-photo"><img src="'+img_src+'" class="roundedSmall"></div>'+
																						   '<div class="ui-block-b block3-text" onClick="openProfilId(\''+users[i]['id']+'\');">'+
																								'<p class="name-profil">'+users[i]['name']+'</p>'+
																								'<p class="status-profil">'+users[i]['status_text']+'</p>'+
																						   '</div>'+
																						   '<div class="ui-block-c block3-btn" align="right"><a href="#" data-role="button" data-icon="plus" data-iconpos="notext" class="btn-app ui-nodisc-icon btn-nomargin" onClick="addFriendConfirm(\''+users[i]['id']+'\', \''+users[i]['name']+'\');"></a></div>'+
																					'</div>'+
																				  '</li>').trigger('create');
												
											}
											
											$('#list-searchFriend').listview("refresh");
											
										}else { // No friend
										
											$('#noSearch-div').show();
											
										}
										
									}
									
							},
							error: function(xhr, status, error) {
									
									$('#img_loading').hide();
									
									toastMessage( "No Connection" , color_error );
									
							},
							dataType: 'json'
							
					});
				
				}
				
			}
			
			//
			function sendPageGroup() {
				
				var group_id = $('#group_id').val();
				
				sendGroupRequest(group_id);
				
			}
			
			//
			function addGroupConfirm(group_id, name_group){
				
				window.localStorage.setItem("send_group", group_id);
				
				navigator.notification.confirm("Send an application to join the group "+name_group+"?",
															   function(buttonIndex) {
																   
																	if(buttonIndex == 2){
																		
																		var group_id = window.localStorage.getItem("send_group");
																		
																		sendGroupRequest(group_id);
																		
																	}
																	
																},
															   "Join the group",
																["No", "Yes"]);
				
			}
			
			//
			function deleteStatusConfirm(status_id){
				
				//window.localStorage.setItem("send_group", group_id);
				
				navigator.notification.confirm("Delete status update?",
															   function(buttonIndex) {
																   
																	if(buttonIndex == 2){
																		
																		deleteStatus(status_id);
																		
																	}
																	
																},
															   "Delete Status",
																["No", "Yes"]);
				
			}
			
			//
			function deleteStatus(status_id){
				
				var postData = "email="+encodeURIComponent(email_app)+"&password="+encodeURIComponent(password_app)+"&status_id="+encodeURIComponent(status_id);
				 	
				$.ajax({
							type: "POST",
							url: url_serv+'deleteStatus.php',
							data: postData,
							async: true,
							success: function(data){
									
								if( data['del_status'] ){
										
									toastMessage( "Status Deleted" , color_app );
									
									$('#li-status'+status_id).hide();
									
								}else{
										
									toastMessage( data['error_message'] , color_error );
										
								}
									
							},
							error: function(xhr, status, error) {
									
								toastMessage( "No Connection" , color_error );
									
							},
							dataType: 'json'
							
				});
				
			}
			
			//
			function sendGroupRequest(group_id) {
				
				var postData = "email="+encodeURIComponent(email_app)+"&password="+encodeURIComponent(password_app)+"&group_id="+encodeURIComponent(group_id);
				 	
				$.ajax({
							type: "POST",
							url: url_serv+'sendGroupRequest.php',
							data: postData,
							async: true,
							success: function(data){
									
								if( data['success'] ){
										
									toastMessage( "The request to join the group has been sent" , color_app );
									
									if( $('#li-searchGroup'+group_id).length ){
										
										$('#li-searchGroup'+group_id).hide();
										
									}
									
									$('#exit-infoGroup').show();
									$('#request-infoGroup').hide();
									
									$('#add-infoGroup').hide();
									
								}else{
										
									toastMessage( data['error_message'] , color_error );
										
								}
									
							},
							error: function(xhr, status, error) {
									
								toastMessage( "No Connection" , color_error );
									
							},
							dataType: 'json'
							
				});
				
				
			}
			
			//
			function addFriendConfirm(user_id, name_user){
				
				window.localStorage.setItem("send_user_friend", user_id);
				
				navigator.notification.confirm("Send him a friend request?",
															   function(buttonIndex) {
																   
																	if(buttonIndex == 2){
																		
																		var user_two = window.localStorage.getItem("send_user_friend");
																		
																		sendFriendRequest(user_two);
																		
																	}
																	
																},
															   "Add "+name_user,
																["No", "Yes"]);
				
			}
			
			//
			function updatePendingListGroups(refreshList) {
				
				//alert("OK");
				
				$('#list-pendingGroup').empty();
				$('#noPendingGroup-div').hide();
				
				$('#list-pendingMyGroup').empty();
				$('#noPendingMyGroup-div').hide();
				
				var groups 		= window.localStorage.getArray("PENDING_GROUPS");
				
				var mygroups	= window.localStorage.getArray("PENDING_MYGROUPS");
				
				//alert(groups.length);
				
				if( groups != undefined ){
					
					if( groups[0]['name'] != undefined ) {
					
						for(var i=0; i < groups.length; i++){
														
							var img_src = "images/groups.png";
														
							if( groups[i]['photo_url'] != null ){
															
								img_src = url_serv + groups[i]['directory'] + groups[i]['photo_url'];
															
							}
														
							$('#list-pendingGroup').append('<li id="li-requestGroup'+groups[i]['id']+'">'+
																'<div class="ui-grid-b">'+
																	   '<div class="ui-block-a block3-photo"><img src="'+img_src+'" class="roundedSmall"></div>'+
																	   '<div class="ui-block-b block3-text" onClick="openGroupId(\''+groups[i]['id']+'\');">'+
																			'<p class="name-profil">'+groups[i]['name']+'</p>'+
																			'<p class="status-profil">'+groups[i]['admin_name']+'</p>'+
																	   '</div>'+
																	   '<div class="ui-block-c block3-btn" align="right"><a href="#" data-role="button" data-icon="check" data-iconpos="notext" class="btn-app ui-nodisc-icon btn-nomargin" data-inline="true" onClick="acceptRequestGroup(\''+groups[i]['id']+'\');"></a><a href="#" data-role="button" data-icon="minus" data-iconpos="notext" class="btn-red ui-nodisc-icon btn-nomargin" data-inline="true" onClick="declinedRequestGroup(\''+groups[i]['id']+'\');"></a></div>'+
																'</div>'+
															  '</li>').trigger('create');
														
						}
					
					}else {
						
						$('#noPendingGroup-div').show();
						
					}
					
				}else {
					
					$('#noPendingGroup-div').show();
					
				}
				
				//
				if( mygroups != undefined ){
					
					//alert( JSON.stringify(mygroups) );
					
					if( mygroups[0]['name'] != undefined ) {
					
						for(var i=0; i < mygroups.length; i++){
														
							var img_src = "images/profil.png";
														
							if( mygroups[i]['photo_profil'] != null ){
															
								img_src = url_serv + mygroups[i]['directory'] + mygroups[i]['photo_profil'];
															
							}
														
							$('#list-pendingMyGroup').append('<li id="li-requestMyGroup'+mygroups[i]['groups_id']+mygroups[i]['user_id']+'">'+
																'<div class="ui-grid-b">'+
																	   '<div class="ui-block-a block3-photo"><img src="'+img_src+'" class="roundedSmall"></div>'+
																	   '<div class="ui-block-b block3-text" onClick="openProfilId(\''+mygroups[i]['user_id']+'\');">'+
																			'<p class="name-profil">'+mygroups[i]['name']+'</p>'+
																			'<p class="status-profil">Want to join group : '+mygroups[i]['name_group']+'</p>'+
																	   '</div>'+
																	   '<div class="ui-block-c block3-btn" align="right"><a href="#" data-role="button" data-icon="check" data-iconpos="notext" class="btn-app ui-nodisc-icon btn-nomargin" data-inline="true" onClick="acceptUserPageGroup(\''+mygroups[i]['groups_id']+'\', \''+mygroups[i]['user_id']+'\');"></a><a href="#" data-role="button" data-icon="minus" data-iconpos="notext" class="btn-red ui-nodisc-icon btn-nomargin" data-inline="true" onClick="declinedUserPageGroup(\''+mygroups[i]['groups_id']+'\', \''+mygroups[i]['user_id']+'\');"></a></div>'+
																'</div>'+
															  '</li>').trigger('create');
														
						}
					
					}else {
						
						$('#noPendingMyGroup-div').show();
						
					}
					
				}else {
					
					$('#noPendingMyGroup-div').show();
					
				}
				
				if( refreshList ){
					
					$('#list-pendingMyGroup').listview('refresh');
					
				}
				
			}
			
			//
			function acceptPageGroup(){
				
				var group_id = $('#group_id').val();
				
				acceptRequestGroup(group_id);
				
			}
			
			//
			function declinedPageGroup(){
				
				var group_id = $('#group_id').val();
				
				declinedRequestGroup(group_id);
				
			}
			
			//
			function acceptRequestGroup(group_id) {
				
				$.mobile.loading("show",{
						text: "Loading ...",
						textVisible: false
				});
				
				var postData = "email="+encodeURIComponent(email_app)+"&password="+encodeURIComponent(password_app)+"&group_id="+encodeURIComponent(group_id)+"&status=1";
				 	
				$.ajax({
							type: "POST",
							url: url_serv+'groupRequest.php',
							data: postData,
							async: true,
							success: function(data){
									
									if( data['success'] ){
										
										/*if( $.mobile.activePage.attr('id') == 'pageInfoProfil' ){
											
											window.history.go(-1);
											
										}*/
										
										if( $('#li-requestGroup'+group_id).length ){
											
											//alert("HIDE");
											
											$('#li-requestGroup'+group_id).hide();
											
										}
										
										$('#exit-infoGroup').show();
										$('#request-infoGroup').hide();
										
										$('#add-infoGroup').hide();
										
									}else{
										
										toastMessage( data['error_message'] , color_error );
										
									}
								
									$.mobile.loading("hide");
									
							},
							error: function(xhr, status, error) {
									
									$.mobile.loading("hide");
									
									toastMessage( "No Connection" , color_error );
									
							},
							dataType: 'json'
							
				});
				
			}
			
			//
			function declinedRequestGroup(group_id) {
				
				$.mobile.loading("show",{
						text: "Loading ...",
						textVisible: false
				});
				
				var postData = "email="+encodeURIComponent(email_app)+"&password="+encodeURIComponent(password_app)+"&group_id="+encodeURIComponent(group_id)+"&status=2";
				 	
				$.ajax({
					
						type: "POST",
						url: url_serv+'groupRequest.php',
						data: postData,
						async: true,
						success: function(data){
									
								if( data['success'] ){
										
									/*if( $.mobile.activePage.attr('id') == 'pageInfoProfil' ){
											
										window.history.go(-1);
											
									}*/
									
									if( $('#li-requestGroup'+group_id).length ){
											
										//alert("HIDE");
											
										$('#li-requestGroup'+group_id).hide();
											
									}
									
									$('#exit-infoGroup').hide();
									$('#request-infoGroup').hide();
									$('#add-infoGroup').hide();
										
								}else{
										
									toastMessage( data['error_message'] , color_error );
										
								}
								
								$.mobile.loading("hide");
									
						},
						error: function(xhr, status, error) {
									
								$.mobile.loading("hide");
									
								toastMessage( "No Connection" , color_error );
									
						},
						dataType: 'json'
							
				});
				
			}
			
			//
			function updatePendingListFriends(refreshList) {
				
				$('#list-pendingFriend').empty();
				$('#noPendingFriend-div').hide();
				
				var users = window.localStorage.getArray("PENDING_USERS");
				
				//alert(users.length);
				
				if( users != undefined ){
					
					if( users[0]['name'] != undefined ) {
					
						for(var i=0; i < users.length; i++){
														
							var img_src = "images/profil.png";
														
							if( users[i]['photo_profil'] != null ){
															
								img_src = url_serv + users[i]['directory'] + users[i]['photo_profil'];
															
							}
														
							$('#list-pendingFriend').append('<li id="li-requestFriend'+users[i]['user_id']+'">'+
																'<div class="ui-grid-b">'+
																	   '<div class="ui-block-a block3-photo"><img src="'+img_src+'" class="roundedSmall"></div>'+
																	   '<div class="ui-block-b block3-text" onClick="openProfilId(\''+users[i]['user_id']+'\');">'+
																			'<p class="name-profil">'+users[i]['name']+'</p>'+
																			'<p class="status-profil">'+users[i]['status_text']+'</p>'+
																	   '</div>'+
																	   '<div class="ui-block-c block3-btn" align="right"><a href="#" data-role="button" data-icon="check" data-iconpos="notext" class="btn-app ui-nodisc-icon btn-nomargin" data-inline="true" onClick="acceptRequestFriend(\''+users[i]['user_id']+'\');"></a><a href="#" data-role="button" data-icon="minus" data-iconpos="notext" class="btn-red ui-nodisc-icon btn-nomargin" data-inline="true" onClick="declinedRequestFriend(\''+users[i]['user_id']+'\');"></a></div>'+
																'</div>'+
															  '</li>').trigger('create');
														
						}
					
					}else {
						
						$('#noPendingFriend-div').show();
						
					}
					
				}else {
					
					$('#noPendingFriend-div').show();
					
				}
				
				if( refreshList ){
					
					$('#list-pendingFriend').listview('refresh');
					
				}
				
			}
			
			//
			function acceptRequestFriend(user_two) {
				
				$.mobile.loading("show",{
						text: "Loading ...",
						textVisible: false
				});
				
				var postData = "email="+encodeURIComponent(email_app)+"&password="+encodeURIComponent(password_app)+"&user_two="+encodeURIComponent(user_two)+"&status=1";
				 	
				$.ajax({
							type: "POST",
							url: url_serv+'friendRequest.php',
							data: postData,
							async: true,
							success: function(data){
									
									if( data['success'] ){
										
										if( $.mobile.activePage.attr('id') == 'pageInfoProfil' ){
											
											window.history.go(-1);
											
										}
										
										if( $('#li-requestFriend'+user_two).length ){
											
											//alert("HIDE");
											
											$('#li-requestFriend'+user_two).hide();
											
										}
										
									}else{
										
										toastMessage( data['error_message'] , color_error );
										
									}
									
									$.mobile.loading("hide");
									
							},
							error: function(xhr, status, error) {
									
									$.mobile.loading("hide");
									
									toastMessage( "No Connection" , color_error );
									
							},
							dataType: 'json'
							
				});
				
			}
			
			//
			function declinedRequestFriend(user_two) {
				
				$.mobile.loading("show",{
						text: "Loading ...",
						textVisible: false
				});
				
				var postData = "email="+encodeURIComponent(email_app)+"&password="+encodeURIComponent(password_app)+"&user_two="+encodeURIComponent(user_two)+"&status=2";
				 	
				$.ajax({
					
						type: "POST",
						url: url_serv+'friendRequest.php',
						data: postData,
						async: true,
						success: function(data){
									
								if( data['success'] ){
										
									if( $.mobile.activePage.attr('id') == 'pageInfoProfil' ){
											
										window.history.go(-1);
											
									}
									
									if( $('#li-requestFriend'+user_two).length ){
											
										//alert("HIDE");
											
										$('#li-requestFriend'+user_two).hide();
											
									}
										
								}else{
										
									toastMessage( data['error_message'] , color_error );
										
								}
								
								$.mobile.loading("hide");
									
						},
						error: function(xhr, status, error) {
									
								$.mobile.loading("hide");
									
								toastMessage( "No Connection" , color_error );
									
						},
						dataType: 'json'
							
				});
				
			}
			
			//
			function updateListFriends(refreshList) {
				
				$('#list-friend').empty();
				$('#noFriend-div').hide();
				
				var users = window.localStorage.getArray("USERS");
				
				//alert(JSON.stringify(users));
				
				if( users != undefined ){
					
					if( users[0]['name'] != undefined ) {
					
						for(var i=0; i < users.length; i++){
														
							var img_src = "images/profil.png";
														
							if( users[i]['photo_profil'] != null ){
															
								img_src = url_serv + users[i]['directory'] + users[i]['photo_profil'];
															
							}
														
							$('#list-friend').append('<li onClick="openOneProfil(\'USERS\', \''+i+'\')">'+
															'<div class="ui-grid-b">'+
																   '<div class="ui-block-a block3-photo"><img src="'+img_src+'" class="roundedSmall"></div>'+
																   '<div class="ui-block-b block3-text">'+
																		'<p class="name-profil">'+users[i]['name']+'</p>'+
																		'<p class="status-profil">'+users[i]['status_text']+'</p>'+
																   '</div>'+
																   '<div class="ui-block-c block3-btn" align="right">&nbsp;</div>'+
															'</div>'+
														  '</li>').trigger('create');
														
						}
					
					}else {
						
						$('#noFriend-div').show();
						
					}
					
				}else {
					
					$('#noFriend-div').show();
					
				}
				
				if( refreshList ){
					
					$('#list-friend').listview('refresh');
					
				}
				
			}
			
			//
			function updateAddFriends() {
				
				$('#list-myFriend').empty();
				$('#noMyFriend-div').hide();
				
				var users 		= window.localStorage.getArray("USERS");
				
				var users_g	= window.localStorage.getArray("USERS_GROUPS");
				
				//alert(JSON.stringify(users));
				
				if( users != undefined ){
					
					if( users[0]['name'] != undefined ) {
					
						for(var i=0; i < users.length; i++){
							
							var btn = "&nbsp;";
							
							if( indexOfJSON(users_g, 'id', users[i]['user_id']) == -1 ) {
								
								btn = '<a href="#" data-role="button" data-icon="plus" data-iconpos="notext" class="btn-app ui-nodisc-icon btn-nomargin" data-inline="true" onClick="addToGroup(\''+users[i]['user_id']+'\', this);"></a>';
								
							}
													
							var img_src = "images/profil.png";
														
							if( users[i]['photo_profil'] != null ){
															
								img_src = url_serv + users[i]['directory'] + users[i]['photo_profil'];
															
							}
														
							$('#list-myFriend').append('<li>'+
															'<div class="ui-grid-b">'+
																   '<div class="ui-block-a block3-photo"><img src="'+img_src+'" class="roundedSmall"></div>'+
																   '<div class="ui-block-b block3-text">'+
																		'<p class="name-profil">'+users[i]['name']+'</p>'+
																		'<p class="status-profil">'+users[i]['status_text']+'</p>'+
																   '</div>'+
																   '<div class="ui-block-c block3-btn" align="right">'+btn+'</div>'+
															'</div>'+
														  '</li>').trigger('create');
														
						}
					
					}else {
						
						$('#noMyFriend-div').show();
						
					}
					
				}else {
					
					$('#noMyFriend-div').show();
					
				}
				
				$.mobile.changePage( "#pageAddFriends", { transition: 'slideup', changeHash: true });
				
			}
			
			//
			function addToGroup(user_id, btn){
				
				var group_id = $('#group_id').val();
				
				var postData = "email="+encodeURIComponent(email_app)+"&password="+encodeURIComponent(password_app)+"&user_two="+encodeURIComponent(user_id)+"&group_id="+encodeURIComponent(group_id);
				
				//alert(postData);
				
				$.ajax({
						type: "POST",
						url: url_serv+'addToGroup.php',
						data: postData,
						async: true,
						success: function(data){
							
							if( data['error_message'] != "" ){
											
								toastMessage( data['error_message'], color_error );
											
							}else{
											
								$(btn).hide();
											
							}
							
						},
						error: function(xhr, status, error) {
									
							toastMessage( "No Connection" , color_error );
									
						},
						dataType: 'json'
							
				});
				
			}
			
			//
			//
			function exitGroup(){
				
				var group_id = $('#group_id').val();
				
				var postData = "email="+encodeURIComponent(email_app)+"&password="+encodeURIComponent(password_app)+"&group_id="+encodeURIComponent(group_id);
				
				//alert(postData);
				
				$.ajax({
						type: "POST",
						url: url_serv+'exitGroup.php',
						data: postData,
						async: true,
						success: function(data){
							
							if( data['error_message'] != "" ){
											
								toastMessage( data['error_message'], color_error );
											
							}else{
											
								$.mobile.changePage( "#pageGroups", { transition: 'slideup', changeHash: true });	
											
							}
							
						},
						error: function(xhr, status, error) {
									
							toastMessage( "No Connection" , color_error );
									
						},
						dataType: 'json'
							
				});
				
			}
			
			//
			function acceptUserPageGroup(group_id, user_two){
				
				var postData = "email="+encodeURIComponent(email_app)+"&password="+encodeURIComponent(password_app)+"&group_id="+encodeURIComponent(group_id)+"&user_two="+encodeURIComponent(user_two);
				
				//alert(postData);
				
				$.ajax({
						type: "POST",
						url: url_serv+'acceptRequestGroup.php',
						data: postData,
						async: true,
						success: function(data){
							
							if( data['error_message'] != "" ){
											
								toastMessage( data['error_message'], color_error );
											
							}else{
											
								$('#li-requestMyGroup'+group_id+user_two).hide();
											
							}
							
						},
						error: function(xhr, status, error) {
									
							toastMessage( "No Connection" , color_error );
									
						},
						dataType: 'json'
							
				});
				
			}
			
			
			//
			function declinedUserPageGroup(group_id, user_two){
				
				var postData = "email="+encodeURIComponent(email_app)+"&password="+encodeURIComponent(password_app)+"&group_id="+encodeURIComponent(group_id)+"&user_two="+encodeURIComponent(user_two);
				
				//alert(postData);
				
				$.ajax({
						type: "POST",
						url: url_serv+'declinedRequestGroup.php',
						data: postData,
						async: true,
						success: function(data){
							
							if( data['error_message'] != "" ){
											
								toastMessage( data['error_message'], color_error );
											
							}else{
											
								$('#li-requestMyGroup'+group_id+user_two).hide();
											
							}
							
						},
						error: function(xhr, status, error) {
									
							toastMessage( "No Connection" , color_error );
									
						},
						dataType: 'json'
							
				});
				
			}
			
			//
			function acceptUserGroup(group_id, user_two){
				
				var postData = "email="+encodeURIComponent(email_app)+"&password="+encodeURIComponent(password_app)+"&group_id="+encodeURIComponent(group_id)+"&user_two="+encodeURIComponent(user_two);
				
				//alert(postData);
				
				$.ajax({
						type: "POST",
						url: url_serv+'acceptRequestGroup.php',
						data: postData,
						async: true,
						success: function(data){
							
							if( data['error_message'] != "" ){
											
								toastMessage( data['error_message'], color_error );
											
							}else{
											
								$('#li-groupPending'+group_id+user_two).hide();
								
								$('#li-groupUser'+group_id+user_two).show();
											
							}
							
						},
						error: function(xhr, status, error) {
									
							toastMessage( "No Connection" , color_error );
									
						},
						dataType: 'json'
							
				});
				
			}
			
			//
			function blockUserGroup(group_id, user_two){
				
				var postData = "email="+encodeURIComponent(email_app)+"&password="+encodeURIComponent(password_app)+"&group_id="+encodeURIComponent(group_id)+"&user_two="+encodeURIComponent(user_two);
				
				//alert(postData);
				
				$.ajax({
						type: "POST",
						url: url_serv+'blockUserGroup.php',
						data: postData,
						async: true,
						success: function(data){
							
							if( data['error_message'] != "" ){
											
								toastMessage( data['error_message'], color_error );
											
							}else{
											
								$('#li-groupUser'+group_id+user_two).hide();
								$('#li-groupBlock'+group_id+user_two).show();
											
							}
							
						},
						error: function(xhr, status, error) {
									
							toastMessage( "No Connection" , color_error );
									
						},
						dataType: 'json'
							
				});
				
			}
			
			//
			function unblockUserGroup(group_id, user_two){
				
				var postData = "email="+encodeURIComponent(email_app)+"&password="+encodeURIComponent(password_app)+"&group_id="+encodeURIComponent(group_id)+"&user_two="+encodeURIComponent(user_two);
				
				//alert(postData);
				
				$.ajax({
						type: "POST",
						url: url_serv+'unblockUserGroup.php',
						data: postData,
						async: true,
						success: function(data){
							
							if( data['error_message'] != "" ){
											
								toastMessage( data['error_message'], color_error );
											
							}else{
											
								$('#li-groupUser'+group_id+user_two).show();
								$('#li-groupBlock'+group_id+user_two).hide();
											
							}
							
						},
						error: function(xhr, status, error) {
									
							toastMessage( "No Connection" , color_error );
									
						},
						dataType: 'json'
							
				});
				
			}
			
			//
			function deleteUserGroup(group_id, user_two){
				
				var postData = "email="+encodeURIComponent(email_app)+"&password="+encodeURIComponent(password_app)+"&group_id="+encodeURIComponent(group_id)+"&user_two="+encodeURIComponent(user_two);
				
				//alert(postData);
				
				$.ajax({
						type: "POST",
						url: url_serv+'deleteUserGroup.php',
						data: postData,
						async: true,
						success: function(data){
							
							if( data['error_message'] != "" ){
											
								toastMessage( data['error_message'], color_error );
											
							}else{
											
								$('#li-groupUser'+group_id+user_two).hide();
											
							}
							
						},
						error: function(xhr, status, error) {
									
							toastMessage( "No Connection" , color_error );
									
						},
						dataType: 'json'
							
				});
				
			}
			
			//
			//
			function blockContact(){
				
				var user_two = $('#user_two').val();
				
				var postData = "email="+encodeURIComponent(email_app)+"&password="+encodeURIComponent(password_app)+"&user_two="+encodeURIComponent(user_two);
				
				//alert(postData);
				
				$.ajax({
						type: "POST",
						url: url_serv+'blockFriend.php',
						data: postData,
						async: true,
						success: function(data){
							
							if( data['error_message'] != "" ){
											
								toastMessage( data['error_message'], color_error );
											
							}else{
											
								$.mobile.changePage( "#pageFriends", { transition: 'slideup', changeHash: true });	
											
							}
							
						},
						error: function(xhr, status, error) {
									
							toastMessage( "No Connection" , color_error );
									
						},
						dataType: 'json'
							
				});
				
			}
			
			//
			function updateListPrivates(refreshList) {
				
				$('#list-chats').empty();
				$('#noChats-div').hide();
				
				var chats = window.localStorage.getArray("PRIVATES");
				
				//alert(JSON.stringify(chats));
				
				var bubble_page = 0;
				
				if( chats != undefined ){
					
					if( chats[0]['name'] != undefined ) {
					
						for(var i=0; i < chats.length; i++){
														
							var img_src = "images/profil.png";
														
							if( chats[i]['photo_profil'] != null ){
															
								img_src = url_serv + chats[i]['directory'] + chats[i]['photo_profil'];
															
							}
							
							var unread			= ""; //'<span class="ui-li-count unread">12</span>'
							var last_message	= "";
							var date_chats		= moment(chats[i]['date_lastMessage']).calendar(null, {
																									sameDay: 'LT',
																									nextDay: '[Tomorrow]',
																									nextWeek: 'dddd',
																									lastDay: '[Yesterday]',
																									lastWeek: 'dddd',
																									sameElse: 'DD/MM/YYYY'
																								});
							
							if( parseInt(chats[i]['unread']) > 0 ){
								
								unread = '<span class="ui-li-count unread">'+chats[i]['unread']+'</span>';
								
								bubble_page++;
								
							}
							
							if( chats[i]['messages'] != null ){
								
								if( chats[i]['messages'][0]['type_message'] == 'text' ){
								
									last_message = chats[i]['messages'][0]['message'];
									
								}else if( chats[i]['messages'][0]['type_message'] == 'photo' ){
									
									last_message = '<div class="center-wrapper"><img src="images/camera-grey.png" width="20px"/>&nbsp;<span>Photo</span></div>';
									
								}else if( chats[i]['messages'][0]['type_message'] == 'audio' ){
									
									last_message = '<div class="center-wrapper"><img src="images/microphone-grey.png" width="20px"/>&nbsp;<span>Audio</span></div>';
									
								}else if( chats[i]['messages'][0]['type_message'] == 'video' ){
									
									last_message = '<div class="center-wrapper"><img src="images/film-grey.png" width="20px"/>&nbsp;<span>Video</span></div>';
									
								}
								
							}
							
							if( last_message != "" ){
							
								$('#list-chats').append('<li onClick="openChat(\'PRIVATES\', \''+i+'\', \'0\');">'+
							  
																'<div class="ui-grid-a grid-border">'+
																	   '<div class="ui-block-a block-rounded" align="center">'+
																			'<img src="'+img_src+'" class="roundedChat">'+
																		'</div>'+
																		'<div class="ui-block-b block-text">'+
																			'<div class="ui-grid-a">'+
																				'<div class="ui-block-a block-title">'+
																					'<h4 class="title-chat">'+chats[i]['name']+'</h4>'+
																				'</div>'+
																				'<div class="ui-block-b block-date" align="right">'+
																					'<span class="date-chat">'+date_chats+'</span>'+
																				'</div>'+
																			'</div>'+
																			'<div class="last-message">'+last_message+'</div>'+
																	   '</div>'+
																'</div>'+
																
																unread+
																
														 '</li>').trigger('create');
							}
							
						}
					
					}else {
						
						$('#noChats-div').show();
						
					}
					
				}else {
					
					$('#noChats-div').show();
					
				}
				
				adsShow();
				
				if( refreshList ){
					
					$('#list-chats').listview('refresh');
					
				}
				
				if( bubble_page == 0 ){
					
					$('.notify-chats').text("");
					$('.notify-chats').hide();
					
				}else {
					
					$('.notify-chats').text(bubble_page);
					$('.notify-chats').show(100);
					
				}
				
			}
			
			//
			function updateListGroups(refreshList) {
				
				$('#list-publicGroups').empty();
				$('#list-privateGroups').empty();
				
				$('#list-publicGroups').append('<li data-role="list-divider">PUBLIC GROUPS</li>').trigger('create');
							
				$('#list-privateGroups').append('<li data-role="list-divider">PRIVATE GROUPS</li>').trigger('create');
				
				$('#noGroups-div').hide();
				
				var groups = window.localStorage.getArray("GROUPS");
				
				//alert(JSON.stringify(users));
				
				var bubble_page = 0;
				var show_public = false, show_private = false;
				
				if( groups != undefined ){
					
					if( groups[0]['name'] != undefined ) {
					
						for(var i=0; i < groups.length; i++){
														
							var img_src = "images/groups.png";
														
							if( groups[i]['photo_url'] != null ){
															
								img_src = url_serv + groups[i]['directory'] + groups[i]['photo_url'];
															
							}
							
							var unread			= ""; //'<span class="ui-li-count unread">12</span>'
							var last_message	= "";
							var date_groups	= moment(groups[i]['date_lastMessage']).calendar(null, {
																									sameDay: 'LT',
																									nextDay: '[Tomorrow]',
																									nextWeek: 'dddd',
																									lastDay: '[Yesterday]',
																									lastWeek: 'dddd',
																									sameElse: 'DD/MM/YYYY'
																								});
							
							if( parseInt(groups[i]['unread']) > 0 ){
								
								unread = '<span class="ui-li-count unread">'+groups[i]['unread']+'</span>';
								
								bubble_page++;
								
							}
							
							if( groups[i]['messages'] != null ){
								
								if( groups[i]['messages'][0]['type_message'] == 'text' ){
								
									last_message = groups[i]['messages'][0]['message'];
									
								}else if( groups[i]['messages'][0]['type_message'] == 'photo' ){
									
									last_message = '<div class="center-wrapper"><img src="images/camera-grey.png" width="20px"/>&nbsp;<span>Photo</span></div>';
									
								}else if( groups[i]['messages'][0]['type_message'] == 'audio' ){
									
									last_message = '<div class="center-wrapper"><img src="images/microphone-grey.png" width="20px"/>&nbsp;<span>Audio</span></div>';
									
								}else if( groups[i]['messages'][0]['type_message'] == 'video' ){
									
									last_message = '<div class="center-wrapper"><img src="images/film-grey.png" width="20px"/>&nbsp;<span>Video</span></div>';
									
								}
								
							}
							
							var li_content = '<li onClick="openChat(\'GROUPS\', \''+i+'\', \'1\');">'+
                          
															'<div class="ui-grid-a grid-border">'+
																   '<div class="ui-block-a block-rounded" align="center">'+
																   		'<img src="'+img_src+'" class="roundedChat">'+
																	'</div>'+
																	'<div class="ui-block-b block-text">'+
																		'<div class="ui-grid-a">'+
																			'<div class="ui-block-a block-title">'+
																				'<h4 class="title-chat">'+groups[i]['name']+'</h4>'+
																			'</div>'+
																			'<div class="ui-block-b block-date" align="right">'+
																				'<span class="date-chat">'+date_groups+'</span>'+
																			'</div>'+
																		'</div>'+
																		'<div class="last-message">'+last_message+'</div>'+
																   '</div>'+
															'</div>'+
														  	
															unread+
															
													 '</li>';
							
							if( groups[i]['private'] == '0' ){
							
								$('#list-publicGroups').append(li_content).trigger('create');
								
								show_public = true;
								
							}else if( groups[i]['private'] == '1' ){
								
								$('#list-privateGroups').append(li_content).trigger('create');
								
								show_private = true;
								
							}
														
						}
						
						if(show_public){
							
							$('#list-publicGroups').show();
							
						}
						
						if(show_private){
							
							$('#list-privateGroups').show();
							
						}
						
					}else {
						
						$('#noGroups-div').show();
						
						$('#list-publicGroups').hide();
						$('#list-privateGroups').hide();
						
					}
					
				}else {
					
					$('#noGroups-div').show();
					
					$('#list-publicGroups').hide();
					$('#list-privateGroups').hide();
					
				}
				
				if( refreshList ){
					
					$('#list-publicGroups').listview('refresh');
					$('#list-privateGroups').listview('refresh');
					
				}
				
				if( bubble_page == 0 ){
					
					$('.notify-groups').text("");
					$('.notify-groups').hide();
					
				}else {
					
					$('.notify-groups').text(bubble_page);
					$('.notify-groups').show(100);
					
				}
				
			}
			
			//
			function changeNotify() {
				
				var value_notify = $('#flip-checkbox-notify').is(':checked')? '1' : '0';
				
				var postData = "email="+encodeURIComponent(email_app)+"&password="+encodeURIComponent(password_app)+"&notify="+encodeURIComponent(value_notify);
				
				if( value_notify != notify_app ){
					
					$.mobile.loading("show",{
							text: "Loading ...",
							textVisible: false
					});
					
					$.ajax({
						type: "POST",
						url: url_serv+'changeNotify.php',
						data: postData,
						async: true,
						success: function(data){
								
								if( data['error_message'] != "" ){
									
									toastMessage( data['error_message'], color_error );
									
								}else {
									
									//change event
									notify_app = value_notify;
									
									window.localStorage.setItem("notify", notify_app);
									
								}
									
								$.mobile.loading("hide");
									
						},
						error: function(xhr, status, error) {
								
							$.mobile.loading("hide");
								
							toastMessage( "No Connection" , color_error );
								
						},
						
						dataType: 'json'
						
					});
					
				}
				
			}
			
			//
			function changeReadOnly() {
				
				var value_readOnly	= $('#flip-checkbox-readOnly').is(':checked')? '1' : '0';
				
				var group_id		= $('#group_id').val()
				
				var postData = "email="+encodeURIComponent(email_app)+"&password="+encodeURIComponent(password_app)+"&readOnly="+encodeURIComponent(value_readOnly)+"&group_id="+encodeURIComponent(group_id);
				
				//alert(postData);
				
				$.mobile.loading("show",{
						text: "Loading ...",
						textVisible: false
				});
					
				$.ajax({
						type: "POST",
						url: url_serv+'changeReadOnly.php',
						data: postData,
						async: true,
						success: function(data){
								
								if( data['error_message'] != "" ){
									
									toastMessage( data['error_message'], color_error );
									
								}else {
									
									
									
								}
									
								$.mobile.loading("hide");
									
						},
						error: function(xhr, status, error) {
								
							$.mobile.loading("hide");
								
							toastMessage( "No Connection" , color_error );
								
						},
						
						dataType: 'json'
						
				});
				
			}
			
			//
			function updateMyGroups() {
				
				$('#list-myGroup').empty();
				$('#noMyGroups-div').hide();
				
				var groups = window.localStorage.getArray("GROUPS");
				
				//alert(JSON.stringify(users));
				
				if( groups != undefined ){
					
					if( groups[0]['name'] != undefined ) {
					
						for(var i=0; i < groups.length; i++){
							
							if( groups[i]['admin'] == "1" ){
														
								var img_src = "images/groups.png";
															
								if( groups[i]['photo_url'] != null ){
																
									img_src = url_serv + groups[i]['directory'] + groups[i]['photo_url'];
																
								}
								
								$('#list-myGroup').append('<li onClick="openOneGroups(\'GROUPS\', \''+i+'\', null);">'+
																'<div class="ui-grid-b">'+
																	   '<div class="ui-block-a block3-photo"><img src="'+img_src+'" class="roundedSmall"></div>'+
																	   '<div class="ui-block-b block3-text">'+
																			'<p class="name-profil">'+groups[i]['name']+'</p>'+
																			'<p class="status-profil">'+groups[i]['description']+'</p>'+
																	   '</div>'+
																	   '<div class="ui-block-c block3-btn" align="right">&nbsp;</div>'+
																'</div>'+
															  '</li>').trigger('create');
															  
							}
														
						}
					
					}else {
						
						$('#noMyGroups-div').show();
						
					}
					
				}else {
					
					$('#noMyGroups-div').show();
					
				}
				
			}
			
			//
			function openGroupId( group_id ){
				
				$('#list-groupUsers').empty();
				$('#list-groupPending').empty();
				$('#list-groupBlock').empty();
				
				var postData		= "email="+encodeURIComponent(email_app)+"&password="+encodeURIComponent(password_app)+"&group_id="+encodeURIComponent(group_id);
					 
				//alert(postData);
					 
				$.ajax({
						type: "POST",
						url: url_serv+'getOneGroup.php',
						data: postData,
						async: true,
						success: function(data){
							
							//alert( JSON.stringify(data) );
							
							if( data['error_message'] != "" ){
												
								toastMessage( data['error_message'], color_error );
												
							}else if( data['group'] != undefined ){
								
								openOneGroups(null, '0', data['group']);
								
							}
								
						},
						error: function(xhr, status, error) {
								
							toastMessage( "No Connection" , color_error );
										
						},
						dataType: 'json'
								
				});
				
			}
			
			//
			function openProfilId( user_two ){
				
				//alert(user_id_app + " " + user_two);
				
				if( user_id_app != user_two ){
					
					//$('#list-inGroups').empty();
					
					//$('#list-inGroups').append('<li class="title-text">JOIN GROUPS</li>');
					
					var postData = "email="+encodeURIComponent(email_app)+"&password="+encodeURIComponent(password_app)+"&user_two="+encodeURIComponent(user_two);
					 
					$.ajax({
							type: "POST",
							url: url_serv+'getOneProfil.php',
							data: postData,
							async: true,
							success: function(data){
								
								if( data['error_message'] != "" ){
												
									toastMessage( data['error_message'], color_error );
												
								}else if( data['user'] != undefined ){
									
									$('#name_infoProfil').text(data['user']['name']);
					
									$('#status_infoProfil').text(data['user']['status_text']);
									
									$('#user_two').val(user_two);
									
									window.localStorage.setItem("relation_id", data['relation_id']);
					
									if( data['status'] == '1' || data['status'] == '3' ){
										
										$('#btnPending_infoProfil').hide();
										
										$('#btnChat_infoProfil').show();
										$('#btnAdd_infoProfil').hide();
										$('#btnRequest_infoProfil').hide();
						
										document.getElementById('btnChat_infoProfil').onclick = function() {
							
											var Id = window.localStorage.getItem("relation_id");
							
											openChatId("PRIVATES", Id, '0');
							
										}
						
									}else if( data['status'] == '0' ) {
										
										if( data['action_user_id'] != user_id_app ){
										
											$('#btnPending_infoProfil').show();
											
											$('#btnPending_infoProfil').html('<a href="#" data-role="button" data-icon="check" data-iconpos="notext" class="btn-app ui-nodisc-icon btn-nomargin" data-inline="true" onClick="acceptRequestFriend(\''+user_two+'\');"></a><a href="#" data-role="button" data-icon="minus" data-iconpos="notext" class="btn-red ui-nodisc-icon btn-nomargin" data-inline="true" onClick="declinedRequestFriend(\''+user_two+'\');"></a>').trigger('create');
											
											$('#btnRequest_infoProfil').hide();
											$('#btnChat_infoProfil').hide();
											$('#btnAdd_infoProfil').hide();
										
										}else {
											
											$('#btnPending_infoProfil').hide();
											
											$('#btnRequest_infoProfil').show();
											$('#btnChat_infoProfil').hide();
											$('#btnAdd_infoProfil').hide();
											
										}
										
									}else {
										
										$('#btnPending_infoProfil').hide();
										
										$('#btnRequest_infoProfil').hide();
										$('#btnChat_infoProfil').hide();
										$('#btnAdd_infoProfil').show();
										
										$('#btnAdd_infoProfil').html('<a href="#" data-role="button" data-icon="plus" data-iconpos="notext" class="btn-app ui-nodisc-icon btn-nomargin" onClick="addFriendConfirm(\''+user_two+'\', \''+data['user']['name']+'\');"></a>').trigger('create');
										
									}
					
									var img_src = "images/profil.png";
															
									if( data['user']['photo_profil'] != null ){
																
										img_src = url_serv + data['user']['directory'] + data['user']['photo_profil'];
																
									}
					
									$('#photo_infoProfil').css('background-image', 'url("'+img_src+'")' ).trigger('create');		
									
									//Groups
									
									/*var groups = data['groups'];
									
									if( groups != null ){
					
										for(var i=0; i < groups.length; i++){
											
											//Image profil
											var img_src = "images/groups.png";
																				
											if( groups[i]['photo_url'] != null ){
																							
												img_src = url_serv + groups[i]['directory'] + groups[i]['photo_url'];
																							
											}
							
											$('#list-inGroups').append('<li onClick="openGroupId(\''+groups[i]['id']+'\');">'+
																				'<div class="ui-grid-b">'+
																					   '<div class="ui-block-a block3-photo"><img src="'+img_src+'" class="roundedSmall"></div>'+
																					   '<div class="ui-block-b block3-text">'+
																							'<p class="name-profil">'+groups[i]['name']+'</p>'+
																							'<p class="status-profil">'+groups[i]['description']+'</p>'+
																					   '</div>'+
																					   '<div class="ui-block-c block3-btn" align="right">&nbsp;</div>'+
																				'</div>'+
																			  '</li>').trigger('create');
										}
										
									}*/
									
									$.mobile.changePage( "#pageInfoProfil", { transition: 'slideup', changeHash: true });			
									
									//$('#list-inGroups').listview('refresh');
												
								}
								
							},
							error: function(xhr, status, error) {
								
								toastMessage( "No Connection" , color_error );
										
							},
							dataType: 'json'
								
					});
				
				}
				
			}
			
			//
			function openChatId(keyItem, Id, type){
				
				var data = window.localStorage.getArray(keyItem);
				
				var index = indexOfJSON(data, 'id', Id);
				
				openChat(keyItem, index, type);
				
			}
			
			//Open chat
			function openChat(keyItem, index, type){
				
				window.localStorage.setItem("keyItem", keyItem);
				window.localStorage.setItem("index", index);
				
				//alert(keyItem+" "+index);
				
				$('#list-messages').empty();
				$('#list-messages').hide();
				
				$('#type_conversation').val(type);
				
				$('#private_message').val("");
				$('#private_message').addClass("text-auto").trigger('create');
				
				var data		= window.localStorage.getArray(keyItem);
				
				//alert( JSON.stringify(data) );
				
				//window.localStorage.setItem("USER_TWO", data[index]['user_id']);
				
				//Title pageChat
				
				var title_profil = '<div class="ui-grid-solo">'+
										'<div class="ui-block-a">'+data[index]['name']+'</div>'+
									 '</div>';
				
				/*if( type == '0' && data[index]['photo_profil'] != null ){
															
					title_profil = '<div class="ui-grid-a">'+
											'<div class="ui-block-a block-imgTitle"><img src="'+url_serv + data[index]['directory'] + data[index]['photo_profil']+'" class="roundedTitle"></div>'+
											'<div class="ui-block-b block-textTitle">'+data[index]['name']+'</div>'+
										'</div>';
															
				}else if( type == '1' && data[index]['photo_url'] != null ){
					
					title_profil = '<div class="ui-grid-a">'+
											'<div class="ui-block-a block-imgTitle"><img src="'+url_serv + data[index]['directory'] + data[index]['photo_url']+'" class="roundedTitle"></div>'+
											'<div class="ui-block-b block-textTitle">'+data[index]['name']+'</div>'+
										'</div>';
					
				}*/
				
				$('#title-chat').html(title_profil).trigger('create');
				
				if( type == '0' ){
					
					document.getElementById('config-chat').onclick = function(){
						
						var keyItem 	= window.localStorage.getItem("keyItem");
						var index		= window.localStorage.getItem("index");
						
						//alert('profil: '+keyItem+" "+index);
						
						var data		= window.localStorage.getArray(keyItem);
						
						var user_two	= data[index]['user_id'];
						
						openProfilId(user_two);
						
					};
					
					updateUnreadMessage(data[index]['id']);
					
					$('#footer-chat').removeClass('ui-disabled');
					
				}else if( type == '1' ){
					
					document.getElementById('config-chat').onclick = function(){
						
						var keyItem 	= window.localStorage.getItem("keyItem");
						var index		= window.localStorage.getItem("index");
						
						//alert('groups: '+keyItem+" "+index);
						
						openOneGroups(keyItem, index, null);
						
					};
					

					updateUnreadGroup(data[index]['id']);
					
					//alert(data[index]['readonly']);
					
					if( data[index]['admin'] == '0' ) {
					
						if( data[index]['readonly'] == '1' ){
						
							$('#footer-chat').addClass('ui-disabled');
						
						}else {
						
							$('#footer-chat').removeClass('ui-disabled');
						
						}
						
					}else {
						
						$('#footer-chat').removeClass('ui-disabled');
						
					}
					
				}
				
				$('#conversation_id').val( data[index]['id'] );
				
				cur_message	= data[index]['messages'];
				
				start_message	= 0;
				end_message	= nbr_message;
				
				$.mobile.changePage( "#pageChat", { transition: 'slide', changeHash: true });
				
				uploadMessage( cur_message, false );
				
			}
			
			//
			function onPromptNameGroup(results) {
				
				if( results.buttonIndex == 2 ){
					
					if( results.input1 != "" ){
						
						var group_id		= $('#group_id').val();
						
						var postData		= "email="+encodeURIComponent(email_app)+"&password="+encodeURIComponent(password_app)+"&name_group="+encodeURIComponent(results.input1)+"&group_id="+encodeURIComponent(group_id);
						
						$.ajax({
								type: "POST",
								url: url_serv+'updateNameGroup.php',
								data: postData,
								async: true,
								success: function(data){
										
										if( data['success'] ){
											
											$('#name_infoGroup').text( data['new_name'] );
											
											$('#title-chat').text( data['new_name'] );
											
										}else{
											
											toastMessage( data['error_message'], color_error );
											
										}
										
										$.mobile.loading("hide");
										
								},
								error: function(xhr, status, error) {
										
										$.mobile.loading("hide");
										
										toastMessage( "No Connection" , color_error );
										
								},
								dataType: 'json'
						});
						
					}
					
				}
				
			}
			
			//
			function updateGroupName(){
				
				navigator.notification.prompt(
					'Please enter the group name',  // message
					onPromptNameGroup,                  // callback to invoke
					'Update Name',            // title
					['Cancel','Update'],             // buttonLabels
					$('#name_infoGroup').text()         // defaultText
				);
				
			}
			
			//
			function onPromptDescriptionGroup(results) {
				
				if( results.buttonIndex == 2 ){
					
					if( results.input1 != "" ){
						
						var group_id		= $('#group_id').val();
						
						var postData		= "email="+encodeURIComponent(email_app)+"&password="+encodeURIComponent(password_app)+"&info_group="+encodeURIComponent(results.input1)+"&group_id="+encodeURIComponent(group_id);
						
						$.ajax({
								type: "POST",
								url: url_serv+'updateDescriptionGroup.php',
								data: postData,
								async: true,
								success: function(data){
										
										if( data['success'] ){
											
											$('#description_infoGroup').text( data['new_info'] );
											
										}else{
											
											toastMessage( data['error_message'], color_error );
											
										}
										
										$.mobile.loading("hide");
										
								},
								error: function(xhr, status, error) {
										
										$.mobile.loading("hide");
										
										toastMessage( "No Connection" , color_error );
										
								},
								dataType: 'json'
						});
						
					}
					
				}
				
			}
			
			//
			function updateGroupDescription(){
				
				navigator.notification.prompt(
					'Please enter the group description',  // message
					onPromptDescriptionGroup,                  // callback to invoke
					'Update Description',            // title
					['Cancel','Update'],             // buttonLabels
					$('#description_infoGroup').text()         // defaultText
				);
				
			}
			
			//
			function openOneGroups(keyItem, index, data_group) {
				
				var oneGroup = null;
				
				if( keyItem != null ){
				
					var groups = window.localStorage.getArray(keyItem);
					
					oneGroup	= groups[index];
					
				}else {
					
					oneGroup	= data_group;
					
				}
				
				if( oneGroup == null ){
					
					return;
					
				}
				
				$('#list-groupUsers').empty();
				$('#list-groupPending').empty();
				$('#list-groupBlock').empty();
				
				var nbr		= oneGroup["users_accept"];
				var users	= oneGroup["users"];
				
				window.localStorage.setArray("USERS_GROUPS", users);
				
				$('#list-groupUsers').append('<li class="title-text"><span id="nbr-participant">'+nbr+'</span> PARTICIPANTS</li>').trigger('create');
				$('#list-groupPending').append('<li class="title-text">PENDING PARTICIPANTS</li>').trigger('create');
				$('#list-groupBlock').append('<li class="title-text">BLOCK PARTICIPANTS</li>').trigger('create');
				
				$('#name_infoGroup').text(oneGroup['name']);
				
				$('#description_infoGroup').text(oneGroup['description']);
				
				$('#group_id').val(oneGroup['id']);
				
				var img_src = "images/groups.png";
														
				if( oneGroup['photo_url'] != null ){
															
					img_src = url_serv + oneGroup['directory'] + oneGroup['photo_url'];
															
				}
				
				$('#photo_infoGroup').css('background-image', 'url("'+img_src+'")' ).trigger('create');
				
				if( oneGroup['admin'] == '1' ){
					
					$('#exit-infoGroup').hide();
					$('#request-infoGroup').hide();
					$('#add-infoGroup').hide();
					
					$('#list-readOnly').show();
					
					//Show pending & block users for admin
					$('#list-groupPending').show();
					$('#list-groupBlock').show();
					
					$('#list-groupUsers').append('<li class="li-btn">'+
														'<a href="#" data-icon="plus" data-role="button" data-iconpos="left" class="ui-nodisc-icon btn-list ui-alt-icon" onClick="updateAddFriends();">Add Participants</a>'+
												   '</li>').trigger('create');
					
					$('#name_infoGroup').removeClass('ui-disabled').trigger('create');
					$('#description_infoGroup').removeClass('ui-disabled').trigger('create');
					$('#btn-editPhotoGroup').removeClass('ui-hidden-accessible').trigger('create');
					
					if( users != null ){
					
						for(var i=0; i < users.length; i++){
							
							//Image profil
							var img_src = "images/profil.png";
																
							if( users[i]['photo_profil'] != null ){
																			
								img_src = url_serv + users[i]['directory'] + users[i]['photo_profil'];
																			
							}
							
							var btn_popup = '<a href="#" data-role="button" data-icon="gear" data-iconpos="notext" class="btn-red ui-nodisc-icon btn-nomargin" onClick="popupUserConfig(\''+oneGroup['id']+'\', \''+users[i]['id']+'\', \''+users[i]['name']+'\');"></a>';
								
							if( users[i]['admin'] == '1' ) {
									
								btn_popup = "";
									
							}
								
							//
							$('#list-groupUsers').append('<li id="li-groupUser'+oneGroup['id']+users[i]['id']+'">'+
																	'<div class="ui-grid-b">'+
																		   '<div class="ui-block-a block3-photo"><img src="'+img_src+'" class="roundedSmall"></div>'+
																		   '<div class="ui-block-b block3-text" onClick="openProfilId(\''+users[i]['id']+'\');">'+
																				'<p class="name-profil">'+users[i]['name']+'</p>'+
																				'<p class="status-profil">'+users[i]['status_text']+'</p>'+
																		   '</div>'+
																		   '<div class="ui-block-c block3-btn" align="right">'+btn_popup+'</div>'+
																	'</div>'+
																  '</li>').trigger('create');
								
							//
							var btn_blocked = '<a href="#" data-role="button" data-icon="check" data-iconpos="notext" class="btn-red ui-nodisc-icon btn-nomargin" onClick="confirmUnBlockUserGroup(\''+oneGroup['id']+'\', \''+users[i]['id']+'\', \''+users[i]['name']+'\');"></a>';
							
							$('#list-groupBlock').append('<li id="li-groupBlock'+oneGroup['id']+users[i]['id']+'">'+
																	'<div class="ui-grid-b">'+
																		   '<div class="ui-block-a block3-photo"><img src="'+img_src+'" class="roundedSmall"></div>'+
																		   '<div class="ui-block-b block3-text" onClick="openProfilId(\''+users[i]['id']+'\');">'+
																				'<p class="name-profil">'+users[i]['name']+'</p>'+
																				'<p class="status-profil">'+users[i]['status_text']+'</p>'+
																		   '</div>'+
																		   '<div class="ui-block-c block3-btn" align="right">'+btn_blocked+'</div>'+
																	'</div>'+
																  '</li>').trigger('create');
							
							//
							var btn_pending = '<a href="#" data-role="button" data-icon="check" data-iconpos="notext" class="btn-app ui-nodisc-icon btn-nomargin" onClick="confirmAcceptUserGroup(\''+oneGroup['id']+'\', \''+users[i]['id']+'\', \''+users[i]['name']+'\');"></a>';
								
							$('#list-groupPending').append('<li id="li-groupPending'+oneGroup['id']+users[i]['id']+'">'+
																	'<div class="ui-grid-b">'+
																		   '<div class="ui-block-a block3-photo"><img src="'+img_src+'" class="roundedSmall"></div>'+
																		   '<div class="ui-block-b block3-text" onClick="openProfilId(\''+users[i]['id']+'\');">'+
																				'<p class="name-profil">'+users[i]['name']+'</p>'+
																				'<p class="status-profil">'+users[i]['status_text']+'</p>'+
																		   '</div>'+
																		   '<div class="ui-block-c block3-btn" align="right">'+btn_pending+'</div>'+
																	'</div>'+
																  '</li>').trigger('create');
							
							$('#li-groupUser'+oneGroup['id']+users[i]['id']).hide();
							$('#li-groupBlock'+oneGroup['id']+users[i]['id']).hide();
							$('#li-groupPending'+oneGroup['id']+users[i]['id']).hide();
							
							if( users[i]['status'] == '0' && users[i]['action_user_id'] != user_id_app ){
								
								$('#li-groupPending'+oneGroup['id']+users[i]['id']).show();
								
							}else if( users[i]['status'] == '1' ){
								
								$('#li-groupUser'+oneGroup['id']+users[i]['id']).show();
														  
							}else if( users[i]['status'] == '3' ){
															  
								$('#li-groupBlock'+oneGroup['id']+users[i]['id']).show();
								
							}
							
						}
					
					}
					
				}else if( oneGroup['admin'] == '0' ){
					
					//hide pending & block groups
					$('#list-groupPending').hide();
					$('#list-groupBlock').hide();
					
					$('#list-readOnly').hide();
					
					if( oneGroup['status'] == '1' ){
					
						$('#exit-infoGroup').show();
						$('#request-infoGroup').hide();
						$('#add-infoGroup').hide();
					
					}else if( oneGroup['status'] == '0' ){
						
						if( oneGroup['action_user_id'] != user_id_app ){
						
							$('#exit-infoGroup').hide();
							$('#request-infoGroup').show();
							$('#add-infoGroup').hide();
						
						}else {
							
							//alert(oneGroup['private']);
							
							if( oneGroup['private'] == '0' ){
								
								$('#exit-infoGroup').hide();
								$('#request-infoGroup').hide();
								$('#add-infoGroup').hide();
								
							}else {
							
								$('#exit-infoGroup').show();
								$('#request-infoGroup').hide();
								$('#add-infoGroup').hide();
							
							}
							
						}
						
					}else {
						
						$('#exit-infoGroup').hide();
						$('#request-infoGroup').hide();
						$('#add-infoGroup').show();
						
					}
					
					$('#name_infoGroup').addClass('ui-disabled').trigger('create');
					$('#description_infoGroup').addClass('ui-disabled').trigger('create');
					$('#btn-editPhotoGroup').addClass('ui-hidden-accessible').trigger('create');
					
					if( users != null ){
					
						for(var i=0; i < users.length; i++){
							
							if( (users[i]['status'] == '1' || users[i]['status'] == '3') ){
							
								var img_src = "images/profil.png";
																
								if( users[i]['photo_profil'] != null ){
																			
									img_src = url_serv + users[i]['directory'] + users[i]['photo_profil'];
																			
								}
								
								$('#list-groupUsers').append('<li>'+
																	'<div class="ui-grid-b">'+
																		   '<div class="ui-block-a block3-photo"><img src="'+img_src+'" class="roundedSmall"></div>'+
																		   '<div class="ui-block-b block3-text" onClick="openProfilId(\''+users[i]['id']+'\');">'+
																				'<p class="name-profil">'+users[i]['name']+'</p>'+
																				'<p class="status-profil">'+users[i]['status_text']+'</p>'+
																		   '</div>'+
																		   '<div class="ui-block-c block3-btn" align="right">&nbsp;</div>'+
																	'</div>'+
																  '</li>').trigger('create');
							}
							
						}
						
					}
					
				}
				
				$.mobile.changePage( "#pageInfoGroup", { transition: 'slideup', changeHash: true });
				
				//alert(oneGroup['readonly']);
				
				if(oneGroup['readonly'] == '1'){
					
					$('#flip-checkbox-readOnly').prop("checked", true).flipswitch( "refresh" );
											
				}else{
											
					$('#flip-checkbox-readOnly').prop("checked", false).flipswitch( "refresh" );
											
				}
				
				$('#list-groupUsers').listview('refresh');
				$('#list-groupPending').listview('refresh');
				$('#list-groupBlock').listview('refresh');
				
			}
			
			//
			function confirmAcceptUserGroup(group_id, user_two, user_name){
				
				window.localStorage.setItem("D_userId", user_two);
				window.localStorage.setItem("D_groupId", group_id);
				
				navigator.notification.confirm("Accept "+user_name+" to Join Group?",
															   function(buttonIndex) {
																   
																	if(buttonIndex == 2){
																		
																		var user_two 	= window.localStorage.getItem("D_userId");
																		var group_id	= window.localStorage.getItem("D_groupId");
																		
																		acceptUserGroup(group_id, user_two);
																		
																	}
																	
																},
															   "Join to Group",
																["No", "Yes"]);
				
			}
			
			//
			function popupUserConfig(list_id, user_popup, user_name) {
				
				$('#popup-name').text(user_name);
				
				document.getElementById('popup-remove').onclick = function(){
					
					$('#popupUserConfig').popup("close");
					
					confirmDeleteUserGroup(list_id, user_popup, user_name);
					
				}
				
				document.getElementById('popup-block').onclick = function(){
					
					$('#popupUserConfig').popup("close");
					
					confirmBlockUserGroup(list_id, user_popup, user_name);
					
				}
				
				$('#popupUserConfig').popup('open', {transition:"slideup"});
				
			}
			
			//
			function confirmDeleteUserGroup(group_id, user_two, user_name){
				
				window.localStorage.setItem("D_userId", user_two);
				window.localStorage.setItem("D_groupId", group_id);
				
				navigator.notification.confirm("Delete "+user_name+" From this group?",
															   function(buttonIndex) {
																   
																	if(buttonIndex == 2){
																		
																		var user_two 	= window.localStorage.getItem("D_userId");
																		var group_id	= window.localStorage.getItem("D_groupId");
																		
																		deleteUserGroup(group_id, user_two);
																		
																	}
																	
																},
															   "Delete user",
																["No", "Yes"]);
				
			}
			
			//
			function confirmBlockUserGroup(group_id, user_two, user_name){
				
				//alert(group_id+","+ user_two+","+ user_name);
				
				window.localStorage.setItem("B_userId", user_two);
				window.localStorage.setItem("B_groupId", group_id);
				
				navigator.notification.confirm("Block "+user_name+" From this group?",
															   function(buttonIndex) {
																   
																	if(buttonIndex == 2){
																		
																		var user_two 	= window.localStorage.getItem("B_userId");
																		var group_id	= window.localStorage.getItem("B_groupId");
																		
																		blockUserGroup(group_id, user_two);
																		
																	}
																	
																},
															   "Block user",
																["No", "Yes"]);
				
			}
			
			//
			function confirmUnBlockUserGroup(group_id, user_two, user_name){
				
				//alert(group_id+","+ user_two+","+ user_name);
				
				window.localStorage.setItem("U_userId", user_two);
				window.localStorage.setItem("U_groupId", group_id);
				
				navigator.notification.confirm("Unblock "+user_name+" From this group?",
															   function(buttonIndex) {
																   
																	if(buttonIndex == 2){
																		
																		var user_two 	= window.localStorage.getItem("U_userId");
																		var group_id	= window.localStorage.getItem("U_groupId");
																		
																		unblockUserGroup(group_id, user_two);
																		
																	}
																	
																},
															   "Unblock user",
																["No", "Yes"]);
				
			}
			
			//
			function openOneProfil(keyItem, index) {
				
				var users = window.localStorage.getArray(keyItem);
				
				//alert(JSON.stringify(users[index]));
				
				//$('#list-inGroups').empty();
				
				//$('#list-inGroups').append('<li class="title-text">JOIN GROUPS</li>');
				
				$('#name_infoProfil').text(users[index]['name']);
				
				$('#status_infoProfil').text(users[index]['status_text']);
				
				$('#user_two').val( users[index]['user_id'] );
				
				window.localStorage.setItem("relation_id", users[index]['id']);
				
				if( users[index]['status'] == '1' || users[index]['status'] == '3' ){
					
					$('#btnPending_infoProfil').hide();
					
					$('#btnChat_infoProfil').show();
					$('#btnAdd_infoProfil').hide();
					$('#btnRequest_infoProfil').hide();
					
					document.getElementById('btnChat_infoProfil').onclick = function() {
						
						var Id = window.localStorage.getItem("relation_id");
						
						openChatId("PRIVATES", Id, '0');
						
					}
					
				}else if(users[index]['status'] == '0'){
					
					if(users[index]['action_user_id'] != user_id_app){
					
						$('#btnPending_infoProfil').show();
											
						$('#btnPending_infoProfil').html('<a href="#" data-role="button" data-icon="check" data-iconpos="notext" class="btn-app ui-nodisc-icon btn-nomargin" data-inline="true" onClick="acceptRequestFriend(\''+users[index]['user_id']+'\');"></a><a href="#" data-role="button" data-icon="minus" data-iconpos="notext" class="btn-red ui-nodisc-icon btn-nomargin" data-inline="true" onClick="declinedRequestFriend(\''+users[index]['user_id']+'\');"></a>').trigger('create');
											
						$('#btnChat_infoProfil').hide();
						$('#btnAdd_infoProfil').hide();
						$('#btnRequest_infoProfil').hide();
					
					}else {
						
						$('#btnPending_infoProfil').hide();
											
						$('#btnRequest_infoProfil').show();
						$('#btnChat_infoProfil').hide();
						$('#btnAdd_infoProfil').hide();
						
					}
					
				}else {
					
					$('#btnPending_infoProfil').hide();
					$('#btnChat_infoProfil').hide();
					$('#btnAdd_infoProfil').show();
					
					$('#btnAdd_infoProfil').html('<a href="#" data-role="button" data-icon="plus" data-iconpos="notext" class="btn-app ui-nodisc-icon btn-nomargin" onClick="addFriendConfirm(\''+users[index]['user_id']+'\', \''+users[index]['name']+'\');"></a>').trigger('create');
					
					$('#btnRequest_infoProfil').hide();
					
				}
				
				var img_src = "images/profil.png";
														
				if( users[index]['photo_profil'] != null ){
															
					img_src = url_serv + users[index]['directory'] + users[index]['photo_profil'];
															
				}
				
				$('#photo_infoProfil').css('background-image', 'url("'+img_src+'")' ).trigger('create');
				
				var groups = users[index]['groups'];
							
				/*if( groups != null ){
					
					for(var i=0; i < groups.length; i++){
											
						//Image profil
						var img_src = "images/groups.png";
																				
						if( groups[i]['photo_url'] != null ){
																							
							img_src = url_serv + groups[i]['directory'] + groups[i]['photo_url'];
																							
						}
							
						$('#list-inGroups').append('<li onClick="openGroupId(\''+groups[i]['id']+'\');">'+
																				'<div class="ui-grid-b">'+
																					   '<div class="ui-block-a block3-photo"><img src="'+img_src+'" class="roundedSmall"></div>'+
																					   '<div class="ui-block-b block3-text">'+
																							'<p class="name-profil">'+groups[i]['name']+'</p>'+
																							'<p class="status-profil">'+groups[i]['description']+'</p>'+
																					   '</div>'+
																					   '<div class="ui-block-c block3-btn" align="right">&nbsp;</div>'+
																				'</div>'+
																			  '</li>').trigger('create');
					}
										
				}*/
				
				$.mobile.changePage( "#pageInfoProfil", { transition: 'slideup', changeHash: true });
				
				//$('#list-inGroups').listview('refresh');
				
			}
			
			//
			function uploadMessage( messages, refreshList ) {
				
				if(messages != undefined){
					
					var parent_date 	= "";
					
					var first_li		= start_message;
					
					//alert( messages );
					
					for(var i = start_message; i < end_message; i++){
						
						if( i == messages.length ) {
							
							break;
							
						}else {
						
							parent_date = moment(messages[i]['create_date']).calendar(null, {
																										sameDay: '[Today]',
																										nextDay: '[Tomorrow]',
																										nextWeek: 'dddd',
																										lastDay: '[Yesterday]',
																										lastWeek: 'dddd',
																										sameElse: 'DD/MM/YYYY'
																									});
							
							
							var date_message		= moment(messages[i]['create_date']).format('LT');
							
							var myClass			= "";
							var classWhite			= "date-grey";
							var name_user			= messages[i]['name'];
							var img_status			= "";
							
							var content_message	= "";
							
							var img_profil			= "images/profil.png";
							
							if( messages[i]['photo_profil'] != null ){
								
								img_profil = url_serv + messages[i]['directory'] + messages[i]['photo_profil'];
								
							}
							
							var profil_info 		= '<div class="profil-chat" onClick="openProfilId(\''+messages[i]['user_id']+'\');">'+
								'<img src="'+img_profil+'" class="image-chat"/><span class="name-chat">&nbsp;<span class="name-chat">'+name_user+'</span>'+
								'</div>';
																		
							if( messages[i]['user_id'] == user_id_app ){
								
								myClass	 	= "bull-right";
								classWhite	= "date-white";
								profil_info= "";
								img_status	= '<img src="images/checkmark-white.png" class="image-status"/>';
								
							}
							
							if( messages[i]['type_message'] == 'text' ){
								
								content_message = '<li class="li-chat" id="unique-'+i+'">'+
															
																  '<div class="chat-bull div-chat '+myClass+'">'+
																  
																		profil_info+
																	
																	'<div class="message-chat">'+urlify(messages[i]['message'].replace(/\n/g, '<br>'))+'</div>'+
																	'<div class="center-chat date-bull">'+
																		'<span class="date-conversation '+classWhite+'">&nbsp;'+date_message+'</span>'+
																		img_status+
																	'</div>'+
																'</div>'+
																'<div class="ui-hidden-accessible date-hidden">'+parent_date+'</div>'+
															
													'</li>';
															 
								$('#list-messages').prepend(content_message).trigger("create");
								
							}else if( messages[i]['type_message'] == 'photo' ){
								
								classWhite	= "date-white";
								
								var url_image	= url_serv+messages[i]['directory']+messages[i]['message'];
								
								content_message = '<li class="li-chat" id="unique-'+i+'">'+
																  '<div class="chat-bull '+myClass+'">'+
																	
																		profil_info+
																	
																	'<div class="divChat-image" onClick="openOnePhoto(\''+url_image+'\');"></div>'+
																	'<div class="center-chat date-bull">'+
																		'<span class="date-conversation '+classWhite+'">&nbsp;'+date_message+'</span>'+
																		img_status+
																	'</div>'+
																'</div>'+
																'<div class="ui-hidden-accessible date-hidden">'+parent_date+'</div>'+
															 '</li>';
															 
								
								$('#list-messages').prepend(content_message).trigger("create");
								
								//alert(url_serv+messages[i]['directory']+messages[i]['message']);
								
								$('#unique-'+i+' .divChat-image').css('background', 'url("'+url_image+'")').trigger('create');
								
							}else if( messages[i]['type_message'] == 'audio' ){
								
								var url_audio	= url_serv + messages[i]['directory'] + messages[i]['message'];
									
								content_message = '<li class="li-chat" id="unique-'+i+'">'+
														
																  '<div class="chat-audio '+myClass+'">'+
																	
																	'<div class="ui-grid-b grid-audio">'+
																		'<div class="ui-block-a block-image">'+
																			'<img src="'+img_profil+'" class="image-audio"/>'+
																		 '</div>'+
                         												'<div class="ui-block-b block-play"><a href="#" data-iconpos="notext" data-role="button" class="ui-nodisc-icon btn-transparent btn-play" data-icon="play" onClick="playingAudio(\''+url_audio+'\',\'unique-'+i+'\');">Play</a><a href="#" data-iconpos="notext" data-role="button" class="ui-nodisc-icon btn-transparent btn-pause" data-icon="pause" style="display:none;" onClick="pauseAudio(\'unique-'+i+'\');">Pause</a></div>'+
																		 '<div class="ui-block-c block-slide">'+
																			'<input type="range" name="audio_position" class="audio_position" value="0" min="0" max="100" data-highlight="true" onChange="updatePosition(\'unique-'+i+'\');" data-mini="true" /><span class="time-audio">00:00</span>'+
																		 '</div>'+
																	'</div>'+
																	
																	'<div class="center-chat date-bull">'+
																		'<span class="date-conversation '+classWhite+'">&nbsp;'+date_message+'</span>'+
																		img_status+
																	'</div>'+
																'</div>'+
																'<div class="ui-hidden-accessible date-hidden">'+parent_date+'</div>'+
														
												'</li>';
															 
								
								$('#list-messages').prepend(content_message).trigger("create");
								
							}else if( messages[i]['type_message'] == 'video' ){
								
								var url_video	= url_serv + messages[i]['directory'] + messages[i]['message'];
									
								content_message = '<li class="li-chat" id="unique-'+messages[i]['unique_code']+'">'+
															
														'<div class="chat-video '+myClass+'">'+
																		
															'<video controls="controls" preload="metadata">'+
																'<source src="'+url_video+'#t=0.5" type="video/mp4">'+
															'</video>'+
																		
															'<div class="center-chat date-bull">'+
																	'<span class="date-conversation '+classWhite+'">&nbsp;'+date_message+'</span>'+img_status+
															'</div>'+
														'</div>'+
														'<div class="ui-hidden-accessible date-hidden">'+parent_date+'</div>'+	
													'</li>';
																 
									
								$('#list-messages').prepend(content_message).trigger("create");
								
							}
							
							//Parent date
							
							if( (i+1) < messages.length ){
								
								var next_date = moment(messages[i+1]['create_date']).calendar(null, {
																										sameDay: '[Today]',
																										nextDay: '[Tomorrow]',
																										nextWeek: 'dddd',
																										lastDay: '[Yesterday]',
																										lastWeek: 'dddd',
																										sameElse: 'DD/MM/YYYY'
																									});
								
								//alert(next_date +"##"+parent_date);
								
								if( next_date != parent_date ){
									
									$('#list-messages').prepend('<li class="li-date"><center><div class="date-back">'+parent_date+'</div></center></li>').trigger('create');
								
								}
								
							}else {
								
								$('#list-messages').prepend('<li class="li-date"><center><div class="date-back">'+parent_date+'</div></center></li>').trigger('create');
								
							}
						
						}
						
					}// end for
					
					if( refreshList ){
					
						$('#list-messages').listview("refresh");
						
						//alert( first_li +" "+ $('#unique-'+first_li).text() );
						
						var last_li = $('#unique-'+first_li).position().top;
						
						//alert(last_li);
						
						$(document).scrollTop(last_li);
						
					}
					
					start_message 	+= nbr_message;
					end_message 	+= nbr_message;
					
				}
				
			}
			
			//
			function playingAudio(src_url , uniqueId){
				
				var lastUniqueId = window.localStorage.getItem("UNIQUE_AUDIO");
				
				if( lastUniqueId == uniqueId && mediaTimer != null ){
					
					my_media.play();
					
					$('#'+uniqueId+' .btn-play').hide();
					$('#'+uniqueId+' .btn-pause').show();
					
				}else {
					
					playAudio(src_url, uniqueId);
					
				}
				
			}
			
			//
			var Utility = {
			   formatTime: function(milliseconds) {
				  if (milliseconds <= 0)
					 return '00:00';
			 
				  var seconds = Math.round(milliseconds);
				  var minutes = Math.floor(seconds / 60);
				  if (minutes < 10)
					 minutes = '0' + minutes;
			 
				  seconds = seconds % 60;
				  if (seconds < 10)
					 seconds = '0' + seconds;
			 
				  return minutes + ':' + seconds;
			   },
			   endsWith: function(string, suffix) {
				  return string.indexOf(suffix, string.length - suffix.length) !== -1;
			   }
			};
			
			//
			//
			function playAudio(src_url , uniqueId) {
				
				//alert(uniqueId);
				
				var lastUniqueId = window.localStorage.getItem("UNIQUE_AUDIO");
				
				window.localStorage.setItem("UNIQUE_AUDIO", uniqueId);
				
				if(my_media != null ){
					
					my_media.stop();
					
					clearInterval(mediaTimer);
					mediaTimer = null;
					
					$('#'+lastUniqueId+' .btn-play').show();
					$('#'+lastUniqueId+' .btn-pause').hide();
					
				}
				// Create Media object from src
				my_media = new Media( src_url , onAudioSuccess, onAudioError, function(status) {
					
					if(status === Media.MEDIA_STOPPED) {
						
						var lastUniqueId = window.localStorage.getItem("UNIQUE_AUDIO");
						
						$('#'+uniqueId+' .btn-play').show();
						$('#'+uniqueId+' .btn-pause').hide();
						
						my_media.seekTo(0);
						
						setAudioPosition(0, lastUniqueId);
						
					}
					
				});
	
				// Play audio
				my_media.play();
				
				$('#'+uniqueId+' .btn-play').hide();
				$('#'+uniqueId+' .btn-pause').show();
				
				// Update my_media position every second
				if (mediaTimer == null) {
					
					mediaTimer = setInterval(function() {
						// get my_media position
						my_media.getCurrentPosition(
							// success callback
							function(position) {
								
								if (position > 0) {
									
									setAudioPosition( position, uniqueId );
									
								}
								
							},
							// error callback
							function(e) {
								console.log("Error getting pos=" + e);
								//setAudioPosition("Error: " + e);
							}
						);
					}, 1000);
					
					var timerDuration = setInterval(
						function() {
			 
						   var duration = my_media.getDuration() - 1;
						   
						   if (duration > -1)
						   {
							  //alert(duration);
							  //$('#'+uniqueId+' .time-audio').text(Utility.formatTime(duration));
							  $('#'+uniqueId+' .audio_position').attr('max', Math.round(duration));
							  $('#'+uniqueId+' .audio_position').slider('refresh');
							  clearInterval(timerDuration);
							  
						   }
						   /*else
							  $('#media-duration').text("تحميل...");*/
						},
					1000);
					
				}
				
			}
			
			//
			function updatePosition(uniqueId) {
				
				//alert($('#audio_position').val());
				
				var lastUniqueId = window.localStorage.getItem("UNIQUE_AUDIO");
				
				if (my_media === null || lastUniqueId != uniqueId)
					 return;
				
				seconds = $('#'+uniqueId+' .audio_position').val();
				
				my_media.seekTo(seconds * 1000);
				setAudioPosition(seconds, uniqueId);
				
			}
			
			// 
			function pauseAudio(uniqueId) {
				
				if (my_media) {
					
					my_media.pause();
					
					$('#'+uniqueId+' .btn-play').show();
					$('#'+uniqueId+' .btn-pause').hide();
					
				}
				
			}
			
			// Set audio position
			// 
			function setAudioPosition(seconds, uniqueId) {
				//document.getElementById('audio_position'+element_id).innerHTML = position;
				
				var slider = $('#'+uniqueId+" .audio_position");
 
				if (seconds < slider.attr('min'))
					 slider.val(slider.attr('min'));
				else if (seconds > slider.attr('max'))
					 slider.val(slider.attr('max'));
				else
					 slider.val(Math.round(seconds));
			 
				slider.slider('refresh');
				
				$('#'+uniqueId+' .time-audio').text(Utility.formatTime(seconds));
				
			}
			
			// onSuccess Callback
			//
			function onAudioSuccess() {
				console.log("playAudio():Audio Success");
			}
	
			// onError Callback 
			//
			function onAudioError(error) {
				console.log('code: '    + error.code    + '\n' + 
					  'message: ' + error.message + '\n');
			}
			
			//
			//
			function changePass() {
				
				$.mobile.loading("show",{
						text: "Loading ...",
						textVisible: false
				});
				
				var passwordNew 	= $('#password_new').val();
				var passwordRe 	= $('#repassword_new').val();
				
				var email_verify	= $('#emailForgot').val();					
				var forgotCode		= $('#forgotCode').val();
				
				if( !passwordNew || !passwordRe  ) {
					
					toastMessage( "Enter a password" , color_error );
					
					$.mobile.loading("hide");
					
				}else{
					
					var changePassword = true;
					
					if( passwordNew.length < 6 ){
						
						toastMessage("Use 6 characters or more for your password", color_error);
						
						changePassword = false;
						
						$.mobile.loading("hide");
						
					}else if( passwordNew != passwordRe ){
						
						toastMessage("Those passwords didn't match. Try again.", color_error);
						
						changePassword = false;
						
						$.mobile.loading("hide");
						
					}
					
					if( changePassword ) {
						
						var postData = "email="+encodeURIComponent(email_verify)+"&forgotCode="+encodeURIComponent(forgotCode)+"&password="+encodeURIComponent(CryptoJS.MD5(passwordNew));
						
						$.ajax({
								type: "POST",
								url: url_serv+'changeForgotPassword.php',
								data: postData,
								async: true,
								success: function(data){
										
										if(data['success']){
											
											toastMessage( data['valide_message'], color_app );
											
											$('#password_new').val('');
											$('#repassword_new').val('');
											
											$('#forgotCode').val('');
											$('#emailForgot').val('');
											
											$('#code_password').val('');
											$('#email_password').val('');
											
											$.mobile.changePage( "#pageIntro", { transition: "fade", changeHash: true });
											
											showBtn();
											
										}else{
											
											toastMessage( data['error_message'], color_error );
											
										}
										
										$.mobile.loading("hide");
										
								},
								error: function(xhr, status, error) {
										
										$.mobile.loading("hide");
										
										toastMessage( "No Connection" , color_error );
										
								},
								dataType: 'json'
						});
						
					}
					
				}
				
			}
			
			//
			function saveGallery() {
				
				var image_url		= document.getElementById('imageOpen').src;
				
				//saveImageToPhone(image_url, successSave, errorSave);
				
				var filename		= cordova.file.dataDirectory + image_url.substring( image_url.lastIndexOf('/')+1 );
				var uri				= encodeURI( image_url );
				
				var fileTransfer 	= new FileTransfer();
				
				fileTransfer.download(
					uri,
					filename,
					function(entry) {
						
						console.log("download complete: " + entry.toURL());
						
						window.cordova.plugins.imagesaver.saveImageToGallery(entry.toURL(),function() {
							
							toastMessage( "Photo Saved" , color_app );
							
						}, function(error) {
							
							console.log('--------------error: ' + error);
							
						});
                      
					},
					function(error) {
						
						console.log("download error source " + error.source);
						console.log("download error target " + error.target);
						console.log("download error code" + error.code);
						
					},
					false,
					{
						headers: {
							"Authorization": "Basic dGVzdHVzZXJuYW1lOnRlc3RwYXNzd29yZA=="
						}
					}
				);
				
			}
			
			//
			/*function saveImageToPhone(url, success, error) {
				var canvas, context, imageDataUrl, imageData;
				var img = new Image();
				
				img.onload = function() {
					canvas = document.createElement('canvas');
					canvas.width = img.width;
					canvas.height = img.height;
					context = canvas.getContext('2d');
					context.drawImage(img, 0, 0);
					try {
						imageDataUrl = canvas.toDataURL('image/jpeg', 1.0);
						imageData = imageDataUrl.replace(/data:image\/jpeg;base64,/, '');
						cordova.exec(
							success,
							error,
							'Canvas2ImagePlugin',
							'saveImageDataToLibrary',
							[imageData]
						);
					}
					catch(e) {
						error(e.message);
					}
				};
				try {
					img.src = url;
				}
				catch(e) {
					error(e.message);
				}
				
			}
			
			var successSave = function(msg){
				
				console.info(msg);
				
				toastMessage( "Photo Saved" , color_app );
				
			};
			
			var errorSave = function(err){
				
				console.error(err);
				
			};*/
			
			function sendLocation() {
				
				var lng = $('#lng_map').val();
				var lat = $('#lat_map').val();
				
				if( lng != "none" && lat != "none" ) {
					
					var url_google = 'https://www.google.com/maps/place/'+lat+','+lng+'/@'+lat+','+lng+',13z';
					
					$('#private_message').val(url_google);
					
					window.history.back();
					
					sendChat();
					
				}
				
			}
			
			
			//Change Password
			function changePassword(){
				
				$.mobile.loading("show",{
						text: "Loading ...",
						textVisible: false
				});
				
				var old_password	= $('#old_password').val();
				var password   	= $('#new_password').val();
				var repassword 	= $('#renew_password').val();
				
				if( !old_password || !password || !repassword ) {

					toastMessage( "Enter a password" , color_error );
					
					$.mobile.loading("hide");
					
				}else{
					
					var change = true;
					
					if( password != repassword ){
						
						toastMessage("Those passwords didn't match. Try again.", color_error);
						
						change = false;
						
						$.mobile.loading("hide");
						
					}
					
					if( password.length < 6 ){
						
						toastMessage("Use 6 characters or more for your password", color_error);
						
						change = false;
						
						$.mobile.loading("hide");
						
					}
					
					if( change ){
						
						var postData = "email="+encodeURIComponent(email_app)+"&oldPassword="+encodeURIComponent(CryptoJS.MD5(old_password))+"&newPassword="+encodeURIComponent(CryptoJS.MD5(password));
				 
						$.ajax({
							type: "POST",
							url: url_serv+'changePassword.php',
							data: postData,
							async: true,
							success: function(data){
									
									if(data['success']){
										
										toastMessage(data['valide_message'], color_app);
										
										$('#old_password').val('');
										$('#new_password').val('');
										$('#renew_password').val('');
										
										resetLogin();
										
										$.mobile.changePage( "#pageIntro", { transition: "fade", changeHash: true });
										
										showBtn();
										
									}else{
										
										toastMessage( data['error_message'], color_error );
										
									}
									
									$.mobile.loading("hide");
									
							},
							error: function(xhr, status, error) {
										
									$.mobile.loading("hide");
										
									toastMessage( "No Connection", color_error );
										
							},
							dataType: 'json'});
							
					}
					
				}
				
			}
			
			//
			function createGroup() {
				
				$.mobile.loading("show",{
						text: "Loading ...",
						textVisible: false
				});
				
				var name_group		= $('#group_name').val();
				var info_group   	= $('#group_description').val();
				var imageURI 		= window.localStorage.getItem( "GROUP_PHOTO" );
				
				if( !name_group || !info_group || imageURI == undefined ) {

					toastMessage( "Enter a Group subject, Description, And photo" , color_error );
					
					$.mobile.loading("hide");
					
				}else{
					
					var options			= new FileUploadOptions();
					options.fileKey		= "file";
					options.fileName		= imageURI.substr(imageURI.lastIndexOf('/')+1);
					options.mimeType		= "image/jpeg";
					options.httpMethod		= 'POST';
					
					
					var params				= new Object();
					params.email			= email_app;
					params.password		= password_app;
					params.name			= name_group;
					params.info			= info_group;
					
					options.params			= params;
					options.chunkedMode	= false;
		 
					var ft = new FileTransfer();
					ft.upload(imageURI, encodeURI(url_serv+"createGroup.php"), winGroup, fail, options);
					
				}
				
			}
			
			//
			function winGroup(r) {
				
				console.log("Code = " + r.responseCode);
				console.log("Response = " + r.response);
				console.log("Sent = " + r.bytesSent);
				
				var response_tab = JSON.parse(r.response);
				
				if( response_tab['error_message'] == "" ){
				
					toastMessage( 'Group successfully created', color_app );
					
					window.history.back();
					
				}else {
					
					toastMessage( response_tab['error_message'], color_error );
					
				}
				
				
				$.mobile.loading("hide");
				
			}
			
			//
			function sendChat(){
				
				var text_reply			= $('#private_message').val();
				var conversation_id	= $('#conversation_id').val();
				var type_conversation = $('#type_conversation').val();
				var unique_code		= (new Date()).getTime()+""+user_id_app+""+conversation_id+""+type_conversation;
				
				var date_message		= moment(new Date()).format('LT');
				var li_date			= moment(new Date()).calendar(null, {
																										sameDay: '[Today]',
																										nextDay: '[Tomorrow]',
																										nextWeek: 'dddd',
																										lastDay: '[Yesterday]',
																										lastWeek: 'dddd',
																										sameElse: 'DD/MM/YYYY'
																									});
				
				if(text_reply != "") {
					
					var data = window.localStorage.getArray("MESSAGES");
					
					if( data == undefined ){
						
						data = new Array();
						
					}
					
					data.push({
									"conversation_id" 		: conversation_id,
									"type_conversation"	: type_conversation,
									"unique_code"			: unique_code,
									"message"				: text_reply,
									"type_message"			: "text"
								});
					
					window.localStorage.setArray("MESSAGES", data);
					
					var last_date = $('.date-hidden').last().text();
					
					//alert(last_date);
					
					if( li_date != last_date ){
						
						$('#list-messages').append('<li class="li-date"><center><div class="date-back">'+li_date+'</div></center></li>').trigger('create');
						
					}
					
					$('#list-messages').append('<li class="li-chat" id="li-'+unique_code+'">'+
														
																  '<div class="chat-bull div-chat bull-right">'+
																	'<div class="name-chat"></div>'+
																	'<div class="message-chat">'+urlify(text_reply).replace(/\n/g, '<br>')+'</div>'+
																	'<div class="center-chat date-bull">'+
																		'<span class="date-conversation date-white">&nbsp;'+date_message+'</span>'+
																		'<img src="images/clock-white.png" class="image-status img_clock"/>'+
																		'<img src="images/checkmark-white.png" class="image-status img_check" style="display:none;"/>'+
																	'</div>'+
																'</div>'+
																'<div class="ui-hidden-accessible date-hidden">'+li_date+'</div>'+
														
													'</li>').trigger('create');
															 
					
				}
				
				$('#private_message').val("");
				$('#private_message').addClass("text-auto").trigger('create');
				
				$('#list-messages').listview("refresh");
				
				var last_li = $("#list-messages li:last-child").offset().top;
       			$.mobile.silentScroll(last_li+90);
				
			}
			
			//
			function resetWallpaper() {
				
				window.localStorage.removeItem("WALLPAPER");
				window.localStorage.removeItem("CODE");
				
				$('.background-chat').css('background', 'url("images/background/0.jpg")').trigger('create');
				
				$('#popupReset').popup('close');
				
			}
			
			//
			function setWallpaper() {
				
				window.localStorage.removeItem("CODE");
				
				if( photo_wallpaper ){
					
					var fileName = wallpaper_src.substring( wallpaper_src.lastIndexOf('/')+1 )
				
					copyFile(wallpaper_src, fileName, LocalFileSystem.PERSISTENT);
					
				}else {
				
					window.localStorage.setItem("WALLPAPER", wallpaper_src);
					$('.background-chat').css('background', 'url("'+wallpaper_src+'")').trigger('create');
				
				}
				
				window.history.back();
				
			}
			
			function setColorWallpaper() {
				
				window.localStorage.removeItem("WALLPAPER");
				
				window.localStorage.setItem("CODE", code_src);
				
				$('.background-chat').css('background', code_src).trigger('create');
				window.history.back();
				
			}
			
			//
			function openColorPreview(code) {
				
				code_src = code
				
				$('.background-preview').css('background', code).trigger('create');
				
				$('#btn-color').show();
				$('#btn-wallpaper').hide();
				
				$.mobile.changePage( "#pagePreview", { transition: "slideup", changeHash: true });
				
			}
			
			//Show div
			function showDiv(elementShow, elementHide){
				
				$('#'+elementHide).hide();
				$('#'+elementShow).show();
				
			}
			
			//
			function openPreview(element) {
				
				wallpaper_src 		=  $(element).find('img').attr('src');
				
				photo_wallpaper	= false;
				
				$('#btn-color').hide();
				$('#btn-wallpaper').show();
				
				$('.background-preview').css('background', 'url("'+wallpaper_src+'")').trigger('create');
				
				$.mobile.changePage( "#pagePreview", { transition: "slideup", changeHash: true });
				
			}
			
			//
			function copyFile(baseFileURI, destPathName, fileSystem){
				
				window.resolveLocalFileSystemURL(baseFileURI, 
					function(file){        
						window.requestFileSystem(fileSystem, 0, 
							function (fileSystem) {
								
								var documentsPath = fileSystem.root;
								
								console.log(documentsPath);
								
								file.copyTo(documentsPath, destPathName,
								
								function(res){ 
								                       
									console.log('copying was successful to: ' + res.nativeURL);
									
									window.localStorage.setItem("WALLPAPER", res.nativeURL);
									$('.background-chat').css('background', 'url("'+res.nativeURL+'")').trigger('create');
									
								}, 
								function(){
									
									console.log('unsuccessful copying');
									
								});
							});
					}, 
					function(){
						
						console.log('failure! file was not found');
						
					});
					
			}
			
			//
			function sendStatus( type_status ) {
				
				//alert("Send Status : "+type_status);
				
				var fileURI = window.localStorage.getItem("FILE_MESSAGE");
				
				//alert(fileURI);
				
				if( fileURI ) {
					
					$.mobile.loading("show",{
							text: "Loading ...",
							textVisible: false,
							theme: 'q',
							html: ''
					});
					
					var options			= new FileUploadOptions();
					options.fileKey		= "file";
					options.fileName		= fileURI.substr(fileURI.lastIndexOf('/')+1);
					options.httpMethod		= 'POST';
					
					if( type_status == "photo" ){
						
						options.mimeType		= "image/jpeg";
							
					}else if( type_status == "video" ){
						
						options.mimeType		= "video/mp4";
						
					}
					
					
					var params				= new Object();
					params.email			= email_app;
					params.password		= password_app;
					params.type_status		= type_status;
					
					options.params			= params;
					options.chunkedMode	= false;
		 
					var ft = new FileTransfer();
					ft.upload(fileURI, encodeURI(url_serv+"statusFile.php"), winStatus, fail, options);
				
				}
				
			}
			
			//
			function winStatus(r) {
				
				console.log("Code = " + r.responseCode);
				console.log("Response = " + r.response);
				console.log("Sent = " + r.bytesSent);
				
				var response_tab = JSON.parse(r.response);
				
				if( response_tab['error_message'] == "" ){
					
					window.history.back();
					
					//Add New status
					
					/*var date_status	= moment( response_tab['create_date'] ).fromNow();
						
					var url_status		= url_serv + response_tab['fileURL'];
						
					var image_status	= "";
					
					if( response_tab['status_type'] == 'video' ){
							
						image_status = '<div class="video-mask">'+
												'<video webkit-playsinline playsinline class="roundedVideo">'+
													'<source src="'+url_status+'#t=0.1" type="video/mp4">'+
												'</video>'+
											'</div>';
							
					}else {
							
						image_status = '<img src="'+url_status+'" class="roundedStatus">';
							
					}
					
					//alert(url_status);
						
					$('#list-myStatus').prepend('<li>'+
						
														'<div class="ui-grid-b">'+
														   '<div class="ui-block-a block-roundedStatus" onClick="showStory(\'MYSTATUS\', \'0\', \'My status\');">'+image_status+'</div>'+
														   '<div class="ui-block-b block-textStatus" align="center">'+
															  '<div align="left" style="display: inline-block; margin-top:22px">'+date_status+'</div>'+
														   '</div>'+
														   '<div class="ui-block-c block-btnStatus" align="right">'+
															'<a href="#" data-role="button" data-icon="minus" data-iconpos="notext" class="ui-nodisc-icon btn-red"></a>'+
														   '</div>'+
														'</div>'+
														
													 '</li>').trigger('create');
													 
					$('#list-myStatus').listview("refresh");*/
					
				}else {
					
					toastMessage( response_tab['error_message'], color_error );
					
				}
				
				$.mobile.loading("hide");
				
			}
			
			//
			function sendFile( type_message ){
				
				//alert("Send Message : " + type_message);
				
				var fileURI = window.localStorage.getItem("FILE_MESSAGE");
				
				//alert(fileURI);
				
				if( fileURI ) {
				
					var conversation_id	= $('#conversation_id').val();
					var type_conversation = $('#type_conversation').val();
					var unique_code		= (new Date()).getTime()+""+user_id_app+""+conversation_id+""+type_conversation;
					
					var data = new Array();
					
					data.push({
										"conversation_id" 		: conversation_id,
										"type_conversation"	: type_conversation,
										"unique_code"			: unique_code,
										"type_message"			: type_message
								});
					
					//alert( JSON.stringify(data) );
					
					//var imageURI = window.localStorage.getItem("FILE_MESSAGE");
					
					$.mobile.loading("show",{
							text: "Loading ...",
							textVisible: false,
							theme: 'q',
							html: ''
					});
					
					var options			= new FileUploadOptions();
					options.fileKey		= "file";
					options.fileName		= fileURI.substr(fileURI.lastIndexOf('/')+1);
					options.httpMethod		= 'POST';
					
					if( type_message == "photo" ){
						
						options.mimeType		= "image/jpeg";
						
					}else if( type_message == "audio" ){
						
						options.mimeType		= "audio/mp4";
						
					}else if( type_message == "video" ){
						
						options.mimeType		= "video/mp4";
						
					}
					
					
					var params				= new Object();
					params.email			= email_app;
					params.password		= password_app;
					params.array_messages	= JSON.stringify(data);
					
					options.params			= params;
					options.chunkedMode	= false;
		 
					var ft = new FileTransfer();
					ft.upload(fileURI, encodeURI(url_serv+"messageFile.php"), winMessage, fail, options);
				
				}
				
			}
			
			//
			function winMessage(r) {
				
				console.log("Code = " + r.responseCode);
				console.log("Response = " + r.response);
				console.log("Sent = " + r.bytesSent);
				
				var response_tab = JSON.parse(r.response);
				
				if( response_tab['error_message'] == "" ){
					
					if(response_tab['type_message'] != "audio"){
						
						window.history.back();
						
					}
					
					window.localStorage.removeItem("FILE_MESSAGE");
					
					var date_message		= moment(new Date()).format('LT');
					var li_date			= moment(new Date()).calendar(null, {
																										sameDay: '[Today]',
																										nextDay: '[Tomorrow]',
																										nextWeek: 'dddd',
																										lastDay: '[Yesterday]',
																										lastWeek: 'dddd',
																										sameElse: 'DD/MM/YYYY'
																									});
					
					var last_date 			= $('.date-hidden').last().text();
					
					if( li_date != last_date ){
						
						$('#list-messages').append('<li class="li-date"><center><div class="date-back">'+li_date+'</div></center></li>').trigger('create');
						
					}
					
					var url_file	= url_serv + response_tab['fileURL'];
					
					if(response_tab['type_message'] == "photo"){
						
						$('#list-messages').append('<li class="li-chat" id="unique-'+response_tab['unique_code']+'">'+
																	  '<div class="chat-bull bull-right">'+
																		'<div class="divChat-image" onClick="openOnePhoto(\''+url_file+'\');"></div>'+
																		'<div class="center-chat date-bull">'+
																			'<span class="date-conversation date-white">&nbsp;'+date_message+'</span>'+
																			'<img src="images/checkmark-white.png" class="image-status img_check"/>'+
																		'</div>'+
																	'</div>'+
																	'<div class="ui-hidden-accessible date-hidden">'+li_date+'</div>'+
																 '</li>').trigger('create');
						
						$('#unique-'+response_tab['unique_code']+' .divChat-image').css('background', 'url("'+url_file+'")').trigger('create');
					
					}else if(response_tab['type_message'] == "audio"){
						
						var img_profil = url_serv + window.localStorage.getItem("photoProfil");
						
						$('#list-messages').append('<li class="li-chat" id="unique-'+response_tab['unique_code']+'">'+
														
															'<div class="chat-audio bull-right">'+
																
																 '<div class="ui-grid-b grid-audio">'+
																		'<div class="ui-block-a block-image">'+
																			'<img src="'+img_profil+'" class="image-audio"/>'+
																		 '</div>'+
                         												'<div class="ui-block-b block-play"><a href="#" data-iconpos="notext" data-role="button" class="ui-nodisc-icon btn-transparent btn-play" data-icon="play" onClick="playingAudio(\''+url_file+'\',\'unique-'+response_tab['unique_code']+'\');">Play</a><a href="#" data-iconpos="notext" data-role="button" class="ui-nodisc-icon btn-transparent btn-pause" data-icon="pause" style="display:none;" onClick="pauseAudio(\'unique-'+response_tab['unique_code']+'\');">Pause</a></div>'+
																		 '<div class="ui-block-c block-slide">'+
																			'<input type="range" name="audio_position" class="audio_position" value="0" min="0" max="100" data-highlight="true" onChange="updatePosition(\'unique-'+response_tab['unique_code']+'\');" data-mini="true" /><span class="time-audio">00:00</span>'+
																		 '</div>'+
																 '</div>'+
																	
																 '<div class="center-chat date-bull">'+
																		'<span class="date-conversation date-white">&nbsp;'+date_message+'</span>'+
																		'<img src="images/checkmark-white.png" class="image-status img_check"/>'+
																'</div>'+
															'</div>'+
															'<div class="ui-hidden-accessible date-hidden">'+li_date+'</div>'+
														
													'</li>').trigger("create");
						
						hideAudio();
						
					}else if(response_tab['type_message'] == "video"){
						
						$('#list-messages').append('<li class="li-chat" id="unique-'+response_tab['unique_code']+'">'+
														
															'<div class="chat-video bull-right">'+
																
																 '<video controls="controls" preload="metadata">'+
																	'<source src="'+url_file+'#t=0.5" type="video/mp4">'+
																'</video>'+
																	
																 '<div class="center-chat date-bull">'+
																		'<span class="date-conversation date-white">&nbsp;'+date_message+'</span>'+
																		'<img src="images/checkmark-white.png" class="image-status img_check"/>'+
																'</div>'+
															'</div>'+
															'<div class="ui-hidden-accessible date-hidden">'+li_date+'</div>'+
														
													'</li>').trigger("create");
						
					}
					
					$('#list-messages').listview('refresh');
					
				}else {
					
					toastMessage( response_tab['error_message'], color_error );
					
				}
				
				$.mobile.loading("hide");
				
			}
			
			//
			//
			function openPhotoPreview(image) {
				
				//
				
				//alert( image.substring( image.lastIndexOf('/')+1 ) );
				
				//var fileName = image.substring( image.lastIndexOf('/')+1 )
				
				//copyFile(image, fileName, LocalFileSystem.PERSISTENT);
				
				wallpaper_src		= image;
				
				photo_wallpaper	= true;
				
				$('.background-preview').css('background', 'url("'+wallpaper_src+'")').trigger('create');
				
				$.mobile.changePage( "#pagePreview", { transition: "slideup", changeHash: true });
				
			}
			
			//
			function openUrl(url) {
				
				//alert(url);
				
				cordova.InAppBrowser.open( encodeURI(url), '_system', 'location=yes' );
				
			}
			
			//
			function adsShow() {
				
				var arrayAds = window.localStorage.getArray("ADS");
					
				console.log("Timeout Ads : "+ JSON.stringify(arrayAds) );
					
				if( arrayAds != undefined && indexAds < arrayAds.length ){
						
					$('#li-ads').remove();
						
					var image_ads = "";
						
					if(arrayAds[indexAds]['url_photo'] != undefined){
							
						image_ads = '<div class="ui-grid-solo">'+
											'<div class="ui-block-a">'+
												'<img src="'+url_serv + arrayAds[indexAds]['url_photo']+'" class="image-ads">'+
											'</div>'+
										  '</div>';
							
					}
						
					var link_ad = "";
							
					if( arrayAds[indexAds]['url_address'] != null ){
								
						link_ad = '<button data-role="button" onClick="openUrl(\''+arrayAds[indexAds]['url_address']+'\');" class="btn-ads" >open</button>';
								
					}
						
					//alert(link_ad);
						
					var indexLi = $('#list-chats li').length;
						
					if ( indexLi > 3 ) {
							
						indexLi = 3;
							
					}
						
					$('#list-chats>:nth-child('+indexLi+')').after('<li id="li-ads">'+
																		'<div class="ui-grid-a grid-border">'+
																			'<div class="ui-block-a block-adsRounded" align="center">'+
																			   '<img src="images/ads.png" class="image-audio">'+
																			'</div>'+
																			'<div class="ui-block-b block-adsText">'+
																			   '<div class="ui-grid-solo">'+
																				   '<div class="ui-block-a">'+
																						'<h4 class="title-ads">'+arrayAds[indexAds]['name_ads']+'</h4>'+
																					   '<span class="date-chat">Ads</span>'+
																				   '</div>'+
																			   '</div>'+
																			   '<p class="ads-message">'+arrayAds[indexAds]['text_ads']+'</p>'+
																			   
																			   image_ads+
																			   
																			   link_ad+
																			   
																			'</div>'+
																			
																			
																	  '</div>'+
																  '</li>').trigger('create');
																  
					indexAds++;
						
				}else{
						
					indexAds = 0;
						
				}
				
			}
			
			//	
			//Header For IPHONE
			$(document).on('pagebeforeshow', '.ui-page', function() {
				
				if( $(this).attr('id') != "page" && $(this).attr('id') != "pageIntro" ){
					
					if((navigator.userAgent.match(/iPhone/i)) || (navigator.userAgent.match(/iPod/i)) || (navigator.userAgent.match(/iPad/i))) {
						
						var heightScreen = parseInt( $(window).height() );
						
						//alert(heightScreen);
						
						if( heightScreen < 734 ){
						
							$('.ui-header').addClass('header-margin').trigger('create');
							$('.ui-header').find('.ui-btn').addClass('header-btn-margin').trigger('create');
							
							//$('.alert').addClass('header-margin').trigger('create');
							
						}else {
							
							$('.ui-header').addClass('header-iphoneX').trigger('create');
							//$('.alert').addClass('header-iphoneX').trigger('create');
							$('.ui-header').find('.ui-btn').addClass('header-btn-iphoneX').trigger('create');
							
							$('.ui-footer').addClass('footer-iphoneX').trigger('create');
							$('.footer-chat').find('.ui-btn').addClass('footer-btn-iphoneX').trigger('create');
							
						}
						
					}
				
				}
				
			});
			
			
			//
			$(document).on('pagebeforehide', '#pageShowStatus', function() {
				
				if( $('#video-status').length ){
					
					//alert($('#video-status').length);
					
					//document.getElementById('video-status').stop();
					
					$('#content-status').html('');
					
				}
				
			});
			
			//pageIntro
			$(document).on('pageshow', '#pageIntro', function() {
				
				$('#content_intro').animate({ opacity: 1}, 3000, function() {
					// Animation complete
					
				});
				
			});
			
			//pageSettings
			$(document).on('pageshow', '#pageSettings', function() {
				
				if(notify_app == '1'){
					
					$('#flip-checkbox-notify').attr("checked", true).flipswitch( "refresh" );
											
				}else{
											
					$('#flip-checkbox-notify').attr("checked", false).flipswitch( "refresh" );
											
				}
				
			});
			
			//pageHome
			$(document).on('pagebeforeshow', '#pageHome', function() {
				
				updateListPrivates(false);
				$('#list-chats').hide();
				
			});
			
			//pageHome
			$(document).on('pageshow', '#pageHome', function() {
				
				$('#list-chats').show();
				$('#list-chats').listview('refresh');
				
			});
			
			//pageHome
			$(document).on('pagebeforehide', '#pageHome', function() {
				
				//$('.notify-chats').hide(100);
				
			});
			
			//pageMyStatus
			$(document).on('pagebeforeshow', '#pageMyStatus', function() {
				
				listMyStatus(false);
				
			});
			
			$(document).on('pageshow', '#pageMyStatus', function() {
				
				$('#list-myStatus').listview('refresh');
				
			});
			
			//pageMyStatus
			$(document).on('pagebeforeshow', '#pageStatus', function() {
				
				listStatus(false);
				
			});
			
			$(document).on('pageshow', '#pageStatus', function() {
				
				$('#list-status').listview('refresh');
				
			});
			
			//pageStatus
			$(document).on('pagebeforeshow', '#pageStatus', function() {
				
				var data = window.localStorage.getArray("MYSTATUS");
				
				if( data != undefined ){
					
					var date_status	= moment(data[0]['create_date']).fromNow();
					
					var url_status		= url_serv + data[0]['directory'] + data[0]['status_url'];
					
					var image_status	= "";
					
					if( data[0]['status_type'] == 'video' ){
						
						image_status = '<div class="video-mask">'+
											'<video webkit-playsinline playsinline class="roundedVideo">'+
												'<source src="'+url_status+'#t=0.1" type="video/mp4">'+
											'</video>'+
										'</div>';
						
					}else {
						
						image_status = '<img src="'+url_status+'" class="roundedStatus">';
						
					}
					
					$('#divStatus').html(image_status);
					$('#timeStatus').html(date_status);
					
				}else {
					
					var image_profil = window.localStorage.getItem("photoProfil");
					
					var image_status = "images/profil.png";
					
					if( image_profil != null ){
						
						image_status = url_serv + image_profil;
						
					}
					
					$('#divStatus').html('<img src="'+image_status+'" class="roundedStatus photo_profil">');
					$('#timeStatus').html("Add to my snaps");
					
				}
				
			});
			
			//pageChat
			$(document).on('pagebeforehide', '#pageChat', function(event, data) {
				
				//$('#conversation_id').val("-1");
				//$('#type_conversation').val("-1");
				
				//alert( data.nextPage.attr('id') );
				
				if( data.nextPage.attr('id') != 'pageSendGallery' && data.nextPage.attr('id') != 'pageSendVideo' ){
					
					hideAudio();
					
					if(my_media != null ){
						
						my_media.stop();
						
						clearInterval(mediaTimer);
						mediaTimer = null;
						
					}
					
				}
				
			});
			
			//pageChat
			var updateChat = true;
			
			$(document).on('pagebeforeshow', '#pageChat', function(event, data){
				
				if( data.prevPage.attr('id') == 'pageOpenGallery' ){
					
					updateChat = false;
					
				}else {
					
					updateChat = true;
					
				}
			
			});
			
			$(document).on('pageshow', '#pageChat', function() {
				
				if( updateChat ){
					
					$('#list-messages').show();
					$('#list-messages').listview('refresh');
					
					if( $("#list-messages li:last-child").length ){
					
						var last_li = $("#list-messages li:last-child").offset().top;
						
						$.mobile.silentScroll(last_li+90);
						
					}
					
				}
				
			});
			
			//pageSendGallery
			$(document).on('pagebeforehide', '#pageSendGallery', function() {
				
				//$('.notify-groups').hide(100);
				
				window.localStorage.removeItem("FILE_MESSAGE");
				
			});
			
			//pageGroups
			$(document).on('pagebeforehide', '#pageGroups', function() {
				
				//$('.notify-groups').hide(100);
				
			});
			
			//pageGroups
			$(document).on('pagebeforeshow', '#pageGroups', function() {
				
				$('#list-publicGroups').hide();
				$('#list-privateGroups').hide();
				
				updateListGroups(false);
				
			});
			
			//pageGroups
			$(document).on('pageshow', '#pageGroups', function() {
				
				//$('#list-publicGroups').show();
				//$('#list-privateGroups').show();
				
				$('#list-publicGroups').listview('refresh');
				$('#list-privateGroups').listview('refresh');
				
			});
			
			$(document).on('pageshow', '#pageMap', function() {
				
				if( marker_click != undefined ){
		
					marker_click.remove();
					
				}
				
				$('#lat_map').val("none");
				$('#lng_map').val("none");
				
				/*map = plugin.google.maps.Map.getMap(mapDiv, {
					
						'controls': {
							'compass': true,
							'myLocationButton': true,
							'zoom': true,
							'mapToolbar': true
						}
						
				});*/
				
			});
			
			//pageAddFriends
			/*$(document).on('pagebeforeshow', '#pageAddFriends', function() {
				
				updateAddFriends(false);
				$('#list-myFriend').hide();
				
			});*/
			
			//pageAddFriends
			$(document).on('pageshow', '#pageAddFriends', function() {
				
				$('#list-myFriend').show();
				$('#list-myFriend').listview('refresh');
				
			});
			
			//pageFriends
			$(document).on('pagebeforeshow', '#pageFriends', function() {
				
				updateListFriends(false);
				$('#list-friend').hide();
				
			});
			
			//pageFriends
			$(document).on('pageshow', '#pageFriends', function() {
				
				$('#list-friend').show();
				$('#list-friend').listview('refresh');
				
			});
			
			//pageFriends
			$(document).on('pagebeforehide', '#pageFriends', function() {
				
				$('.notify-friend').hide(100);
				
			});
			
			//pagePendingFriends
			$(document).on('pagebeforeshow', '#pagePendingFriends', function() {
				
				updatePendingListFriends(false);
				$('#list-pendingFriend').hide();
				
			});
			
			//pagePendingFriends
			$(document).on('pageshow', '#pagePendingFriends', function() {
				
				$('#list-pendingFriend').show();
				$('#list-pendingFriend').listview('refresh');
				
			});
			
			//pagePendingFriends
			$(document).on('pagebeforehide', '#pagePendingFriends', function() {
				
				$('.notify-pendingFriend').hide(100);
				
			});
			
			//pageNewGroup
			$(document).on('pagebeforehide', '#pageNewGroup', function() {
				
				$('#group_description').val('');
				$('#group_name').val('');
				
				document.getElementById('photo_group').src = "images/groups.png";
				
				window.localStorage.removeItem( "GROUP_PHOTO" );
				
			});
			
			
			//pagePendingGroups
			$(document).on('pagebeforeshow', '#pagePendingGroups', function() {
				
				updatePendingListGroups(false);
				$('#list-pendingGroup').hide();
				$('#list-pendingMyGroup').hide();
				
			});
			
			//pageSignUp
			$(document).on('pageshow', '#pageSignUp', function() {
				
				$('#btn_signup').addClass('ui-disabled');
				
				$('#checkbox-policy').prop('checked', false).checkboxradio('refresh');
				
			});
			
			//pagePendingGroups
			$(document).on('pageshow', '#pagePendingGroups', function() {
				
				$('#list-pendingGroup').show();
				$('#list-pendingGroup').listview('refresh');
				
				$('#list-pendingMyGroup').show();
				$('#list-pendingMyGroup').listview('refresh');
				
			});
			
			//pagePendingGroups
			$(document).on('pagebeforehide', '#pagePendingGroups', function() {
				
				$('.notify-pendingGroup').hide(100);
				
			});
			
			//pageMyGroups
			$(document).on('pagebeforeshow', '#pageMyGroups', function() {
				
				updateMyGroups();
				$('#list-myGroup').hide();
				
			});
			
			//pageMyGroups
			$(document).on('pageshow', '#pageMyGroups', function() {
				
				$('#list-myGroup').show();
				$('#list-myGroup').listview('refresh');
				
			});
			
			//ready document
			
			$(document).ready(function() {
				
				/*$.mobile.loading("show",{
						text: "Loading ...",
						textVisible: false
				});*/
				
				/*$('#list-chats').delegate('li', 'click', function () {
					
					//alert($(this).index());
					
				});*/
				
				$('#content-status').on('click', function(event, ui) {
					
					//alert("Test st");
					
					indexStatus++;
					
					var keyItem = window.localStorage.getItem("KEY_STATUS");
					
					var data = window.localStorage.getArray(keyItem);
					
					if( indexStatus >= data.length ) {
						
						window.history.back();
						
					}else {
						
						showStory(keyItem, indexStatus, $('#title-story').text());
						
					}
					
				});
				
				//Share App
				$('.share-btn').on('click', function(event, ui) {
					
					//alert("ok");
					window.plugins.socialsharing.share(message_app, null, null, url_app);
					
				});
				
				$('#checkbox-policy').on('change', function(event, ui) {
					
					if( $(this).is(':checked') ){
						
						$('#btn_signup').removeClass('ui-disabled');
						
					}else{
						
						$('#btn_signup').addClass('ui-disabled');
						
					}
					
				});
				
				//
				$( "input, textarea" ).bind( "tap", function(event, ui) {
					
					$('#'+this.id+'_label').show();
					
				});
				
				$( "input, textarea" ).bind( "focusout", function(event, ui) {
					
					if( $(this).val() == "")
						$('#'+this.id+'_label').hide();
					
					
				});
				
				//
				$( "#name_text, #status_text" ).bind( "tap", function(event, ui) {
					
					$('#cancel-info').show();
					$('#done-info').show();
					
					$('#back-info').hide();
					
				});
				
				//Fix header & footer
				$(document).on('focus', 'input,textArea,select', function() {
					
					if((navigator.userAgent.match(/iPhone/i)) || (navigator.userAgent.match(/iPod/i))) {
						
						$('div[data-role="header"]').addClass('Element-header-fixed');
						//$('div[data-role="footer"]').css('position', 'absolute');
						//$(document).scrollTop(document.body.scrollHeight);
						//$(document).trigger("refresh");
						
					}
					
				})
				.on('blur', 'input,textArea,select', function() {
					
					if((navigator.userAgent.match(/iPhone/i)) || (navigator.userAgent.match(/iPod/i))) {
						
						//$('div[data-role="header"]').css('position', 'fixed');
						//$('div[data-role="footer"]').css('position', 'fixed');
						
						$('div[data-role="header"]').removeClass('Element-header-fixed');
						
					}
					
				});
				
				$('.btn-down').on('click', function(event, ui) {
					
					var last_li = $("#list-messages li:last-child").offset().top;
					$("html,body").animate({scrollTop: last_li+90});
					
					$(this).hide();
					
				});
				
				// Ads
				
				setInterval(function(){
					
					adsShow();
					
				}, 20000);
				
			});
			
			
			
			//
			$(document).bind('scrollstart', function () {
				
				if ( $(window).scrollTop() + $(window).height() >= ($(document).height() - 100)) {
					 
					 scrollEnd = true;
					 $('.btn-down').hide();
					 
				}else{
					 
					 scrollEnd = false;
					 
					 if( $.mobile.activePage.attr('id') == "pageChat" ){
					 	$('.btn-down').show();
					 }
					 
				}
				
			});
			
			$(document).bind('touchmove', function () {
				
				if( $.mobile.activePage.attr('id') == "pageChat" ){
					
					//alert($(window).scrollTop());
					
					if( $(window).scrollTop() <= 100 ){
					
						uploadMessage( cur_message, true );
						
					}
					
				}
				
			});
			
		</script>
        
    </head>
    <body>
    	 
        <div class='ui-loader-background'></div>
        
        <div data-role="page" id="pageIntro">
            
			<div data-role="content" align="center">
              
              <div class="centered" align="center" style="opacity:0;" id="content_intro">
                  
                  <img src="images/logo.png" class="logo-first">
                  
                  <h4>Twtchat</h4>
                  
                  <img id="loading-img" src="css/images/loading.gif" width="30px" style="display:none;">
                  
              </div>
              
              <div class="div-btn" align="center" style="display:none;">
              
              		<a href="#pageSignIn" data-role="button" data-transition="slideup" class="btn-text-app">Log In</a>
              
              		<a href="#pageSign" data-role="button" data-transition="slideup" class="btn-noradius btn-simple-app">Sign Up</a>
                    
                  <!--a href="#pageHome" data-role="button" data-transition="slideup" class="btn-noradius btn-simple-app">Page Home</a-->
              
              </div>
              
			</div>
            
        </div>
        
        <!-- -->
        
        <div data-role="page" id="pageSignIn">
        	 
            <div data-role="header" data-theme="c" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                
                <a href="#" data-rel="back" data-role="button" data-icon="carat-l" data-iconpos="notext" class="btn-header ui-btn-left ui-nodisc-icon"></a>
                
                <h1 class="ui-title title-left">Login on chat</h1>
                   
           </div> 
            
            <div data-role="content" class="div-signin" align="center">
               <img src="images/logo.png" class="logo-small">
               <form method="post" action="javascript:signin();">
                	<div align="center">
                    
                    	<label for="email_signin" id="email_signin_label" class="label_small" style="display:none;">Email</label>
                      <input name="email_signin" id="email_signin" data-wrapper-class="input-app" value="" type="email" placeholder="Email">
                        
                      
                      <label for="password_signin" id="password_signin_label" class="label_small" style="display:none;">Password</label>
                      <input name="password_signin" id="password_signin" data-wrapper-class="input-app" value="" type="password" placeholder="Password">
                      
                      <br><br>
                      <a href="#pageForgot" data-transition="slideup" class="forget-password">Forgot password?</a>
                      <br><br>
                      <button type="submit" data-role="button" class="btn-app" id="btn_signin">Log in</button>
                	</div>
               </form>
               <br>
               
               
            </div>
            
        </div>
        
        <!-- -->
        
        <div data-role="page" id="pageSign">
        	
           <div data-role="header" class="header-white" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                
                <a href="#" data-rel="back" data-role="button" data-icon="carat-l" data-iconpos="notext" class="btn-header ui-btn-left ui-nodisc-icon ui-alt-icon"></a>
                
                <h1 class="ui-title">Sign Up</h1>
                
           </div> 
           
           <div data-role="content" class="div-signin" align="center">
            
              <img src="images/logo.png" class="logo-first">
              
              <div class="div-btn" align="center">
              		
                  <a href="#pageSignUp" data-role="button" data-transition="slideup" class="btn-noradius btn-text-app ui-nodisc-icon" data-icon="email">Sign Up with Email</a>
                  
                  <p>OR</p>  
                  
              		<a href="#" data-role="button" data-transition="slideup" class="btn-noradius btn-facebook ui-nodisc-icon" data-icon="facebook" onClick="signupFacebook();">Sign Up with Facebook</a>
                    
                  <!--a href="#" data-role="button" data-transition="slideup" class="btn-noradius btn-simple-app ui-nodisc-icon" data-icon="twitter">Sign Up with Twitter</a-->
                  
                  <a href="#" data-role="button" data-transition="slideup" class="btn-noradius btn-googleplus ui-nodisc-icon" data-icon="googleplus" onClick="signupGooglePlus();">Sign Up with Google+</a>
              
              		
                    
                  <!--a href="#pageHome" data-role="button" data-transition="slideup" class="btn-noradius btn-simple-app">Page Home</a-->
              
              </div>
               
           </div>
            
        </div>
        
        <!-- -->
        
        <div data-role="page" id="pageSignUp">
        	 
            <div data-role="header" data-theme="c" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                
                <a href="#" data-rel="back" data-role="button" data-icon="carat-l" data-iconpos="notext" class="btn-header ui-btn-left ui-nodisc-icon"></a>
                
                <h1 class="ui-title title-left">Sign Up</h1>
                   
           </div> 
            
            <div data-role="content" class="div-signin" align="center">
            
               <img src="images/logo.png" class="logo-small">
               
               <form method="post" action="javascript:signup();" id="formSignUp">
                	<div align="center">
                    
                    	<label for="name_signup" id="name_signup_label" class="label_small" style="display:none;">Name</label>
                      <input name="name_signup" id="name_signup" data-wrapper-class="input-app" value="" type="text" placeholder="Name">
                      
                      <label for="phone_signup" id="phone_signup_label" class="label_small" style="display:none;">Phone</label>
                      <input name="phone_signup" id="phone_signup" data-wrapper-class="input-app" value="" type="tel" placeholder="Phone">
                      
                      <label for="email_signup" id="email_signup_label" class="label_small" style="display:none;">Email</label>
                      <input name="email_signup" id="email_signup" data-wrapper-class="input-app" value="" type="email" placeholder="Email">  
                      
                      <label for="password_signup" id="password_signup_label" class="label_small" style="display:none;">Password</label>
                      <input name="password_signup" id="password_signup" data-wrapper-class="input-app" value="" type="password" placeholder="Password">
                      
                      <label for="Vpassword_signup" id="Vpassword_signup_label" class="label_small" style="display:none;">Confirm password</label>
                      <input name="Vpassword_signup" id="Vpassword_signup" data-wrapper-class="input-app" value="" type="password" placeholder="Confirm password">
                      
                	</div>
               </form>
               
            </div>
            
            <div data-role="footer" class="footer-transparent" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
            	 <div class="ui-grid-a">
               	<div class="ui-block-a block-checkbox">
                       <label class="checkbox-label"><input type="checkbox" name="checkbox-policy" id="checkbox-policy" class="checkbox-small">&nbsp;</label>
                  </div>
                  <div class="ui-block-b block-textCheckbox" align="left">
                       <a href="#pagePolicy" data-transition="slideup">I Agree to Twtchat’s Terms of Service.</a>
                  </div>
               </div>
                <div class="ui-grid-solo">
                    <div class="ui-block-a block-footer">
                        <button type="submit" data-role="button" class="btnOne-footer btn-app btn-noradius" id="btn_signup" form="formSignUp">Sign up</button>
                    </div>
                </div>
            </div>
            
        </div>
        
        <!-- -->
        
        <div data-role="page" id="pageForgot">
            <div data-role="header" data-theme="c" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                
                <a href="#" data-rel="back" data-role="button" data-icon="carat-l" data-iconpos="notext" class="btn-header ui-btn-left ui-nodisc-icon"></a>
                
                <h1 class="ui-title title-left">Password Reset</h1>
                
            </div>
            
			
            	<form method="post" action="javascript:forgotPassword();">
                <div data-role="content">
                    <div class="div-spacing" align="center">
                    		<img src="images/logo.png" class="logo-small">
                         <p>Enter your recovery email</p>
                         <label for="email_forgot" id="email_forgot_label" class="label_small" style="display:none;">Email</label>
                         <input name="email_forgot" id="email_forgot" data-wrapper-class="input-app" value="" type="email" placeholder="Email">
                         
                    </div>
                </div>
                <div data-role="footer" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                    <div class="ui-grid-solo">
                         <div class="ui-block-a blockOne-footer">
                            <button type="submit" data-role="button" class="btnOne-footer btn-simple-app btn-noradius" id="btn_forgot">Next</button>
                         </div>
                    </div>
                </div>
            	</form>
                
        </div>
        
        <!-- -->
        
        <div data-role="page" id="pageVerifyPassword">
           
           <div data-role="content" align="center" class="div-spacing">
           
           	<img src="images/logo.png" class="logo-small">
              <h4 align="center">Validation code</h4>
               
           	<form method="post" action="javascript:verifyPassword();">
                    	                        
                    <label for="code_password" id="code_password_label" class="label_small" style="display:none;">Verification code</label>
                    <input name="code_password" id="code_password" data-wrapper-class="input-app" value="" type="tel" placeholder="Write verification code">
                        
                    <input name="email_password" id="email_password" value="0" type="hidden">
                    
                    <br>
                    <button type="submit" data-role="button" class="btn-app">Verify</button>
                    
               </form>
            </div>
                
            <div data-role="footer" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                <div class="ui-grid-a">
                    <div class="ui-block-a" align="left">
                       <a href="#" data-rel="back" class="ui-alt-icon ui-nodisc-icon btn-transparent" data-role="button" data-icon="carat-l" data-iconpos="left">Back</a>    
                    </div>
                    <div class="ui-block-b">
                       &nbsp;
                    </div>
                </div>
            </div>
        
        </div>
        
        <!-- -->
        
        <div data-role="page" id="pageChangePassword">
           
           <div data-role="content" align="center" class="div-spacing">
           
           	<img src="images/logo.png" class="logo-small">
              <h4 align="center">Change Password</h4>
               
           	<form method="post" action="javascript:changePass();">
                    	                        
                    <label for="password_new" id="password_new_label" class="label_small" style="display:none;">New Password</label>
                    <input name="password_new" id="password_new" data-wrapper-class="input-app" value="" type="password" placeholder="New Password">
                    
                    <label for="repassword_new" id="repassword_new_label" class="label_small" style="display:none;">Confirm your new Password</label>
                    <input name="repassword_new" id="repassword_new" data-wrapper-class="input-app" value="" type="password" placeholder="Confirm your new Password">
                       
                    <input name="forgotCode" id="forgotCode" value="0" type="hidden">
                    <input name="emailForgot" id="emailForgot" value="0" type="hidden">
                    
                    <br>
                    <button type="submit" data-role="button" class="btn-app">Save</button>
                    
               </form>
            </div>
                
            <div data-role="footer" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                <div class="ui-grid-a">
                    <div class="ui-block-a" align="left">
                       <a href="#" data-rel="back" class="ui-alt-icon ui-nodisc-icon btn-transparent" data-role="button" data-icon="carat-l" data-iconpos="left">Back</a>    
                    </div>
                    <div class="ui-block-b">
                       &nbsp;
                    </div>
                </div>
            </div>
        
        </div>
        
        <!-- -->
        
        <div data-role="page" id="pageHome" class="page-white">
        	
            <div data-role="header" class="header-white" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                
                <h1 class="ui-title">Chat</h1>
                
            </div>
            
			 <div data-role="content" class="content-noMargin">
             	  
                <ul data-role="listview" data-icon="none" data-inset="true" class="ui-nodisc-icon list-chat" id="list-chats">
                		<!--li>
                        	<div class="ui-grid-a grid-border">
                            		<div class="ui-block-a block-adsRounded" align="center">
                                   <img src="images/ads.png" class="image-audio">
                                </div>
                                <div class="ui-block-b block-adsText">
                                	   <div class="ui-grid-solo">
                                       <div class="ui-block-a">
                                       		<h4 class="title-ads">Title ads</h4>
                                           <span class="date-chat">Ads</span>
                                       </div>
                                   </div>
                                   <p class="ads-message">Text ads Text ads Text ads Text ads Text ads Text ads Text ads Text ads</p>
                                   
                                </div>
                          </div>
                      </li>
                		<!--li onClick="openChat();">
                          
                            <div class="ui-grid-a grid-border">
                            		<div class="ui-block-a block-rounded" align="center">
                                   <img src="images/1.png" class="roundedChat">
                                </div>
                                <div class="ui-block-b block-text">
                                	   <div class="ui-grid-a">
                                       <div class="ui-block-a">
                                       		<h4 class="title-chat">Private</h4>
                                       </div>
                                       <div class="ui-block-b" align="right">
                                       		<span class="date-chat">32 years</span>
                                       </div>
                                   </div>
                                   <p class="last-message">Message</p>
                                   
                                </div>
                            </div>
                          
                     </li>
                     <li>
                          
                            <div class="ui-grid-a grid-border">
                            		<div class="ui-block-a block-rounded" align="center">
                                   <img src="images/profil.png" class="roundedChat">
                                </div>
                                <div class="ui-block-b block-text">
                                	   <div class="ui-grid-a">
                                       <div class="ui-block-a">
                                       		<h4 class="title-chat">Private</h4>
                                       </div>
                                       <div class="ui-block-b" align="right">
                                       		<span class="date-chat">32 years</span>
                                       </div>
                                   </div>
                                   <p class="last-message">Message</p>
                                   
                                </div>
                            </div>
                          
                     </li-->
                </ul>
                
                <div id="noChats-div" align="center" >
                    <br>
                    <img src="images/sad.png" width="110">
                    <h3 class="text-silver">No Messages, yet.</h3>
                </div>
                
            </div>
        	 
            <div data-role="footer" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                <div data-role="navbar">
                    <ul>
                        <li>
                        	<a href="#" data-icon="chat-app" data-role="button" class="btn-text-app btn-noradius btn-navbar">Chats<span class="notify-bubble notify-chats">0</span></a>
                        </li>
                        <li>
                        	<a href="#pageGroups" data-icon="group-grey" data-role="button" class="btn-text-grey btn-noradius btn-navbar">Groups<span class="notify-bubble notify-groups">0</span></a>
                        </li>
                        <li>
                        	<a href="#pageStatus" data-icon="status-grey" data-role="button" class="btn-text-grey btn-noradius btn-navbar">Snaps</a>
                        </li>
                        <li>
                        	<a href="#pageFriends" data-icon="friend-grey" data-role="button" class="btn-text-grey btn-noradius btn-navbar">Friends<span class="notify-bubble notify-friend">0</span></a>
                        </li>
                        <li>
                        	<a href="#pageSettings" data-icon="cog-grey" data-role="button" class="btn-text-grey btn-noradius btn-navbar">Settings</a>
                        </li>
                    </ul>
                </div>
            </div>
       		
        </div>
        
        <!-- -->
        
        <div data-role="page" id="pageGroups" class="page-white">
        	
            <div data-role="header" class="header-white" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                
                <a href="#pageSearchGroups" data-transition="slideup" data-role="button" data-icon="plus-app" data-iconpos="notext" class="btn-header ui-nodisc-icon ui-btn-right"></a>
                
                <h1 class="ui-title">Groups</h1>
                
                <a href="#pagePendingGroups" data-transition="slideup" data-role="button" data-icon="bell-app" data-iconpos="notext" class="btn-header ui-nodisc-icon ui-btn-left"><span class="notify-nobubble notify-pendingGroup">&nbsp;</span></a>
                
            </div>
            
			 <div data-role="content" class="content-noMargin">
             	  
                <!--div class="div-input">
                	<input name="search_group" id="search_group" data-wrapper-class="input-search"  type="search" placeholder="Search">
                    
                    data-filter="true" data-input="#search_group"
                </div-->
                <ul data-role="listview" data-icon="none" data-inset="true" class="ui-nodisc-icon list-chat" id="list-publicGroups">
                </ul>
                <ul data-role="listview" data-icon="none" data-inset="true" class="ui-nodisc-icon list-chat" id="list-privateGroups">
                		
                </ul>
                <div id="noGroups-div" align="center" >
                    <br>
                    <img src="images/sad.png" width="110">
                    <h3 class="text-silver">No Groups, yet.</h3>
                </div>
                
            </div>
        	 
            <div data-role="footer" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                <div data-role="navbar">
                    <ul>
                        <li>
                        	<a href="#pageHome" data-icon="chat-grey" data-role="button" class="btn-text-grey btn-noradius btn-navbar">Chats<span class="notify-bubble notify-chats">0</span></a>
                        </li>
                        <li>
                        	<a href="#" data-icon="group-app" data-role="button" class="btn-text-app btn-noradius btn-navbar">Groups<span class="notify-bubble notify-groups">0</span></a>
                        </li>
                        <li>
                        	<a href="#pageStatus" data-icon="status-grey" data-role="button" class="btn-text-grey btn-noradius btn-navbar">Snaps</a>
                        </li>
                        <li>
                        	<a href="#pageFriends" data-icon="friend-grey" data-role="button" class="btn-text-grey btn-noradius btn-navbar">Friends<span class="notify-bubble notify-friend">0</span></a>
                        </li>
                        <li>
                        	<a href="#pageSettings" data-icon="cog-grey" data-role="button" class="btn-text-grey btn-noradius btn-navbar">Settings</a>
                        </li>
                    </ul>
                </div>
            </div>
       		
        </div>
        
        <!-- -->
        
        <div data-role="page" id="pageFriends">
        	
            <div data-role="header" class="header-white" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                
                <a href="#pageSearchFriends" data-transition="slideup" data-role="button" data-icon="plus-app" data-iconpos="notext" class="btn-header ui-nodisc-icon ui-btn-right"></a>
                
                <h1 class="ui-title">Friends</h1>
                
                <a href="#pagePendingFriends" data-transition="slideup" data-role="button" data-icon="bell-app" data-iconpos="notext" class="btn-header ui-nodisc-icon ui-btn-left"><span class="notify-nobubble notify-pendingFriend">&nbsp;</span></a>
                
            </div>
            
			 <div data-role="content" class="content-noMargin">
             	
              <div class="div-input">
              		<input name="search_friend" id="search_friend" data-wrapper-class="input-search"  type="search" placeholder="Search">
              </div>  
              
              <ul data-role="listview" data-inset="true" data-filter="true" data-input="#search_friend" class="ui-nodisc-icon list-app-small" id="list-friend" data-autodividers="true">
                	<!--li>
                    <div class="ui-grid-b">
                           <div class="ui-block-a block3-photo"><img src="images/logo.png" class="roundedSmall"></div>
                           <div class="ui-block-b block3-text">
                            <p class="name-profil">Aboubaker</p>
                            <p class="status-profil">test</p>
                           </div>
                           <div class="ui-block-c block3-btn" align="right">&nbsp;</div>
                    </div>
                    <span class="ui-li-count">12</span>
                  </li>
                  <li>
                    <div class="ui-grid-b">
                           <div class="ui-block-a block3-photo"><img src="images/logo.png" class="roundedSmall"></div>
                           <div class="ui-block-b block3-text">
                            <p class="name-profil">Aboubaker</p>
                            <p class="status-profil">test</p>
                           </div>
                           <div class="ui-block-c block3-btn" align="right">&nbsp;</div>
                    </div>
                  </li-->
                </ul>  
                
                <div id="noFriend-div" align="center" >
                    <br>
                    <img src="images/sad.png" width="110">
                    <h3 class="text-silver">No Friends, yet.</h3>
                </div>
                
            </div>
        	 
            <div data-role="footer" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                <div data-role="navbar">
                    <ul>
                        <li>
                        	<a href="#pageHome" data-icon="chat-grey" data-role="button" class="btn-text-grey btn-noradius btn-navbar">Chats<span class="notify-bubble notify-chats">0</span></a>
                        </li>
                        <li>
                        	<a href="#pageGroups" data-icon="group-grey" data-role="button" class="btn-text-grey btn-noradius btn-navbar">Groups<span class="notify-bubble notify-groups">0</span></a>
                        </li>
                        <li>
                        	<a href="#pageStatus" data-icon="status-grey" data-role="button" class="btn-text-grey btn-noradius btn-navbar">Snaps</a>
                        </li>
                        <li>
                        	<a href="#" data-icon="friend-app" data-role="button" class="btn-text-app btn-noradius btn-navbar">Friends<span class="notify-bubble notify-friend">0</span></a>
                        </li>
                        <li>
                        	<a href="#pageSettings" data-icon="cog-grey" data-role="button" class="btn-text-grey btn-noradius btn-navbar">Settings</a>
                        </li>
                    </ul>
                </div>
            </div>
       		
        </div>
        
        <!-- -->
        
        <div data-role="page" id="pageSettings">
        	 
             
           <!--div class="alert">
			  <span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span> 
			  This is an alert box.
			</div-->
            
            <div data-role="header" class="header-white" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                
                <h1 class="ui-title">Settings</h1>
                
            </div>
            
			 <div data-role="content" class="content-noMargin">
             	  
                <ul data-role="listview" data-inset="true" class="ui-nodisc-icon list-app ui-alt-icon">
                	<li>
                    <a href="#pageProfil" data-transition="slide">
                        <div class="ui-grid-a">
                           <div class="ui-block-a block-rounded"><img src="images/profil.png" class="roundedChat photo_profil"></div>
                           <div class="ui-block-b block-text">
                            <p class="title-name">Aboubaker</p>
                            <p class="title-status">Test</p>
                           </div>
                        </div>
                    </a>
                  </li>
                </ul>
                <br>
                <ul data-role="listview" data-inset="true" class="ui-nodisc-icon list-app ui-alt-icon">
                	<li>
                    <a href="#pageWallpaper" data-transition="slide">
                    	<div class="center-wrapper">
                        	<img width="25px" src="images/chat.png" />&nbsp;<span>Chat Wallpaper</span>
                      </div>
                    </a>
                  </li>
                	<li data-icon="none">
                    <div class="center-wrapper">
                        	<img width="25px" src="images/bell.png" />&nbsp;<span>Notification</span>
                         <span class="fliper-enable">
                            <form>                                
                                <input data-role="flipswitch" name="flip-checkbox-notify" id="flip-checkbox-notify" data-on-text="" data-off-text="" data-wrapper-class="custom-label-flipswitch" type="checkbox" onChange="changeNotify();" />
                            </form>
							</span>
                    </div>
                     
                  </li>
                  <li>
                    <a href="#pageMyGroups">
                    	<div class="center-wrapper">
                        	<img width="25px" src="images/people.png" />&nbsp;<span>Setting Groups</span>
                      </div>
                    </a>
                  </li>
                </ul>
                <br>
                <ul data-role="listview" data-inset="true" class="ui-nodisc-icon list-app ui-alt-icon">
                	<li>
                    <a href="#pageHelp" data-transition="slide">
                    	<div class="center-wrapper">
                        	<img width="25px" src="images/info.png" />&nbsp;<span>Help</span>
                      </div>
                    </a>
                  </li>
                	<li>
                    <a href="#" onClick="logout();">
                    	<div class="center-wrapper">
                        	<img width="25px" src="images/close.png" />&nbsp;<span>Log Out</span>
                      </div>
                    </a>
                  </li>
                </ul>
                
            </div>
        	 
            <div data-role="footer" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                <div data-role="navbar">
                    <ul>
                        <li>
                        	<a href="#pageHome" data-icon="chat-grey" data-role="button" class="btn-text-grey btn-noradius btn-navbar">Chats<span class="notify-bubble notify-chats">0</span></a>
                        </li>
                        <li>
                        	<a href="#pageGroups" data-icon="group-grey" data-role="button" class="btn-text-grey btn-noradius btn-navbar">Groups<span class="notify-bubble notify-groups">0</span></a>
                        </li>
                        <li>
                        	<a href="#pageStatus" data-icon="status-grey" data-role="button" class="btn-text-grey btn-noradius btn-navbar">Snaps</a>
                        </li>
                        <li>
                        	<a href="#pageFriends" data-icon="friend-grey" data-role="button" data-iconpos="top" class="btn-text-grey btn-noradius btn-navbar">Friends<span class="notify-bubble notify-friend">0</span></a>
                        </li>
                        <li>
                        	<a href="#" data-icon="cog-app" data-role="button" class="btn-text-app btn-noradius btn-navbar">Settings</a>
                        </li>
                    </ul>
                </div>
            </div>
       		
        </div>
        
        <!-- -->
        
        <div data-role="page" id="pageSearchFriends">
        	
            <div data-role="header" class="header-white" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                
                <a href="#" data-rel="back" data-role="button" data-icon="carat-l" data-iconpos="notext" class="btn-header ui-nodisc-icon ui-btn-left ui-alt-icon"></a>
                
                <h1 class="ui-title title-left">Add Friends</h1>
                
            </div>
            
			 <div data-role="content" class="content-noMargin">
             	  
                <div class="inline-form">
                      <div class="wrapper">
                        <div class="content">
                          <input name="search_text" id="search_text" data-wrapper-class="input-search" type="text" placeholder="Search (Phone, Name, Email)...">
                        </div>
                      </div>

                      <div class="right">
                        <a href="#" data-role="button" data-icon="search" data-iconpos="notext" class="btn-app ui-nodisc-icon" onClick="searchUsers();"></a>
                      </div>
                </div>
                
                <br>
                
                <center><img id="img_loading" src="css/images/loading.gif" width="30px" style="display:none;"></center>
                
                <ul data-role="listview" data-inset="true" class="ui-nodisc-icon list-app-small" id="list-searchFriend">
                	<!--li>
                    <div class="ui-grid-b">
                           <div class="ui-block-a block3-photo"><img src="images/logo.png" class="roundedSmall"></div>
                           <div class="ui-block-b block3-text">
                            <p class="name-profil">Aboubaker</p>
                            <p class="status-profil">test</p>
                           </div>
                           <div class="ui-block-c block3-btn" align="right"><a href="#" data-role="button" data-icon="check" data-iconpos="notext" class="btn-app ui-nodisc-icon btn-nomargin" data-inline="true"></a><a href="#" data-role="button" data-icon="minus" data-iconpos="notext" class="ui-nodisc-icon btn-nomargin btn-red" data-inline="true"></a></div>
                    </div>
                  </li>
                  <li>
                    <div class="ui-grid-b">
                           <div class="ui-block-a block3-photo"><img src="images/logo.png" class="roundedSmall"></div>
                           <div class="ui-block-b block3-text">
                            <p class="name-profil">Aboubaker</p>
                           </div>
                           <div class="ui-block-c block3-btn" align="right"><a href="#" data-role="button" data-icon="plus" data-iconpos="notext" class="btn-app ui-nodisc-icon btn-nomargin"></a></div>
                    </div>
                  </li-->
                </ul>
                
                <div id="noSearch-div" align="center" style="display:none;">
                    <br>
                    <img src="images/sad.png" width="110">
                    <h3 class="text-silver">No search results found</h3>
                </div>
                
            </div>
        	 
        </div>
        
        <!-- -->
        
        <div data-role="page" id="pageChat" class="page-transparent">

           <div class="background-chat"></div>

           <div data-role="header" data-theme="c" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">

                <a href="#" data-role="button" data-icon="cog-white" data-iconpos="notext" class="btn-header ui-btn-right ui-nodisc-icon" id="config-chat"></a>

                <h1 class="ui-title title-left" id="title-chat">
                	Name
                </h1>

                <a href="#" data-rel="back" data-role="button" data-icon="carat-l" data-iconpos="notext" class="btn-header ui-btn-left ui-nodisc-icon"></a>

           </div>

			<div data-role="content" data-iscroll>

                <ul data-icon="none" class="ul-conversation" data-role="listview" id="list-messages">
                		<li class="li-date">15 May</li>
                      <li class="li-chat">
                     	  <div class="chat-video">

                         <video controls='controls'>
								<source src='images/dimag.mp4' type='video/mp4'>
							</video>

                     		<div class="center-chat date-bull">
                            <span class="date-conversation date-grey">&nbsp;11:10 PM</span>
                            <img src="images/clock-grey.png" class="image-status"/>
							</div>
                        </div>
                        <div class="ui-hidden-accessible date-hidden">tttt</div>
                     </li>
                     <!--li class="li-chat">
                     	  <div class="chat-audio">

                         <div class="ui-grid-b grid-audio">
                         		<div class="ui-block-a block-image">
                                <img src="images/city.jpeg" class="image-audio"/>
                             </div>
                         		<div class="ui-block-b block-play"><a href="#" data-iconpos="notext" data-role="button" class="ui-nodisc-icon btn-transparent" data-icon="play" id="play-record">Play</a></div>
                             <div class="ui-block-c block-slide">
                             	<input type="range" name="audio_position" class="audio_position " value="0" min="0" max="100" data-highlight="true" onChange="updatePosition();" data-mini="true" /><span class="time-audio">00:00</span>
                             </div>
                         </div>

                     		<div class="center-chat date-bull">
                            <span class="date-conversation date-grey">&nbsp;11:10 PM</span>
                            <img src="images/clock-grey.png" class="image-status"/>
							</div>
                        </div>
                        <div class="ui-hidden-accessible date-hidden">tttt</div>
                     </li>
                     <!--li class="li-chat">
                     		<div class="chat-bull">
                            <div class="divChat-image"></div>
                            <div class="center-chat date-bull">
                            <span class="date-conversation date-grey">&nbsp;11:10 PM</span>
                            <img src="images/checkmark-grey.png" class="image-status"/>
							</div>
                         </div></li>
                     <li class="li-chat"><div class="chat-bull"><div class="message-chat">الرسائل الرسائل الرسائل RIGHT</div></div></li>
                     <li class="li-chat">
                     <div class="chat-bull bull-right">الرسائل الرسائل الرسائل LEFT<br>الرسائل الرسائل الرسائل الرسائل<br>الرسائل الرسائل
                     الرساlljlkjlkjlkjlkjlkjlkjlk lkjlkjl lkjkj kjlkjkmlkm mlkئل
                     		<div class="center-chat">
                            <span class="date-conversation date-white">&nbsp;11:10 PM</span>
                            <img src="images/checkmark-grey.png" class="image-status"/>
							</div>
                     </div>
                     </li>
                     <li class="li-chat">
                     		<div class="chat-bull bull-right divChat-image">
                            <div class="center-chat date-bull">
                            <span class="date-conversation date-grey">&nbsp;11:10 PM</span>
                            <img src="images/checkmark-grey.png" class="image-status"/>
							</div>
                         </div></li>
                     <li class="li-chat"><div class="chat-bull">الرسائل الرسائل الرسائل RIGHT</div></li>
                     <li class="li-chat"><div class="chat-bull">الرسائل الرسائل الرسائل RIGHT</div></li>
                     <li class="li-chat"><div class="chat-bull">الرسائل الرسائل الرسائل RIGHT</div></li>
                     <li class="li-chat"><div class="chat-bull">الرسائل الرسائل الرسائل RIGHT</div></li>
                     <li class="li-chat"><div class="chat-bull">الرسائل الرسائل الرسائل RIGHT</div></li>
                     <li class="li-chat"><div class="chat-bull">الرسائل الرسائل الرسائل RIGHT</div></li>
                     <li class="li-chat"><div class="chat-bull">الرسائل الرسائل الرسائل RIGHT</div></li>
                     <li class="li-chat"><div class="chat-bull">الرسائل الرسائل الرسائل RIGHT</div></li-->
                </ul>

               <a href="#" data-role="button" data-transition="slideup" data-iconpos="notext" data-icon="carat-d" class="ui-nodisc-icon btn-down btn-text-app ui-alt-icon" style="display:none;"></a>

			</div>

            <div data-role="footer" class="footer-chat" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="" id="footer-chat">

            	<a href="#" onClick="sendChat();" data-iconpos="notext" data-role="button" class="btn-sendChat btn-transparent ui-nodisc-icon" data-icon="send"></a>
            	  <div class="ui-grid-solo">
                    <div class="ui-block-a block-TextChat">
                    	<input type="hidden" value="-1" id="conversation_id"/>
                      <input type="hidden" value="-1" id="type_conversation"/>
                    	<textarea name="private_message" id="private_message" class="text-chat text-auto" placeholder="Aa" ></textarea>
                    </div>
                </div>
                <a href="#popupAttach" data-rel="popup" data-iconpos="notext" data-role="button" class="btn-sendDoc btn-transparent ui-nodisc-icon" data-icon="attach" data-transition="slideup"></a>
            </div>

            <div data-role="footer" class="footer-audio" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="" id="footer-audio" style="display:none">

              <div class="ui-grid-solo">
                  <div class="ui-block-a"><a href="#" data-iconpos="left" data-role="button" class="btn-transparent ui-nodisc-icon ui-alt-icon" data-icon="delete" onClick="hideAudio();">Record Audio</a></div>
              </div>

              <a href="#" onClick="sendFile('audio');" data-iconpos="notext" data-role="button" class="btn-sendChat btn-transparent ui-nodisc-icon" data-icon="send"></a>

              <div class="ui-grid-a grid-audio">
                  <div class="ui-block-a" align="left">
                    	<a href="#" data-iconpos="notext" data-role="button" class="ui-nodisc-icon btn-app ui-disabled" data-icon="play-white" onClick="playSound();" data-inline="true" id="play-record">Play</a>
                      <a href="#" data-iconpos="notext" data-role="button" class="ui-nodisc-icon btn-app" data-icon="microphone-white" onClick="playRecord();" id="start-record" data-inline="true">Record</a>
                      <a href="#" data-iconpos="notext" data-role="button" class="ui-nodisc-icon btn-red" data-icon="stop-white" onClick="stopRecord();" style="display:none;" id="stop-record" data-inline="true">Stop</a>
                  </div>
                  <div class="ui-block-b" align="left">
                    	<a href="#" data-iconpos="notext" data-role="button" class="ui-nodisc-icon btn-transparent" id="timer">00:00</a>
                  </div>
              </div>

            </div>

            <div data-role="popup" id="popupAttach" data-tolerance="0" data-position-to="window" data-overlay-theme="b" style="border:none; box-shadow: none; background-color: transparent;" data-history="false">
              	<ul data-role="listview" data-inset="true" data-icon="none" style="min-width:210px;" class="ui-nodisc-icon ul-chat ui-alt-icon">
                   <li>
                   	<a href="#" onClick="openDoublePopup('popupAttach', 'popupPhotoAttach');">Photo
                    		<div class="left-radio">
                            <img width="25px" src="images/image.png" />
                          </div>
                   	</a>
                   </li>
                   <li>
                   	<a href="#" onClick="openAudio('popupAttach');">Audio
                          <div class="left-radio">
                            <img width="25px" src="images/microphone.png" />
                          </div>
                      </a>
                   </li>
                   <li>
                   	<a href="#" onClick="openDoublePopup('popupAttach', 'popupVideoAttach');">Video
                          <div class="left-radio">
                            <img width="25px" src="images/film-outline.png" />
                          </div>
                      </a>
                   </li>
                   <li><a href="#pageMap">Location
                   		<div class="left-radio">
                            <img width="25px" src="images/location-outline.png" />
                          </div>
                   	 </a>
                   </li>
               </ul>
               <ul data-role="listview" data-inset="true" data-icon="none" style="min-width:210px;" class="ui-nodisc-icon ul-picture">
                   <li><a href="#" onClick="closePopup('popupAttach');">Cancel</a></li>
              	</ul>
         	 </div>

            <div data-role="popup" id="popupPhotoAttach" data-tolerance="0" data-position-to="window" data-overlay-theme="b" style="border:none; box-shadow: none; background-color: transparent;" data-history="false">
              	<ul data-role="listview" data-inset="true" data-icon="none" style="min-width:210px;" class="ui-nodisc-icon ul-picture ui-alt-icon">
                   <li>
                   	<a href="#" onClick="sendCameraPhoto('popupPhotoAttach', 'chat');">Camera</a>
                   </li>
                   <li>
                   	<a href="#" onClick="sendGalleryPhoto('popupPhotoAttach', 'chat');">Photo Library</a>
                   </li>
               </ul>
               <ul data-role="listview" data-inset="true" data-icon="none" style="min-width:210px;" class="ui-nodisc-icon ul-picture">
                   <li><a href="#" onClick="closePopup('popupPhotoAttach');">Cancel</a></li>
              	</ul>
         	 </div>

           <div data-role="popup" id="popupVideoAttach" data-tolerance="0" data-position-to="window" data-overlay-theme="b" style="border:none; box-shadow: none; background-color: transparent;" data-history="false">
              	<ul data-role="listview" data-inset="true" data-icon="none" style="min-width:210px;" class="ui-nodisc-icon ul-picture ui-alt-icon">
                   <li>
                   	<a href="#" onClick="sendCameraVideo('popupVideoAttach', 'chat');">Camera</a>
                   </li>
                   <li>
                   	<a href="#" onClick="sendGalleryVideo('popupVideoAttach', 'chat');">Video Library</a>
                   </li>
               </ul>
               <ul data-role="listview" data-inset="true" data-icon="none" style="min-width:210px;" class="ui-nodisc-icon ul-picture">
                   <li><a href="#" onClick="closePopup('popupVideoAttach');">Cancel</a></li>
              	</ul>
         	 </div>

            <script type="text/javascript">

				$("#private_message").focus(function() {
					$(this).removeClass("text-auto").trigger('create');

				}).blur(function() {
					if (this.value === '') {
						$(this).addClass("text-auto").trigger('create');
					}
				});

			</script>

        </div>

        <!-- -->
        
        <div data-role="page" id="pageProfil">
        	
            <div data-role="header" class="header-white" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                
                <a href="#" id="back-info" data-rel="back" data-role="button" data-icon="carat-l" data-iconpos="notext" class="btn-header ui-btn-left ui-nodisc-icon ui-alt-icon"></a>
                
                <a href="#" id="cancel-info" data-role="button" data-icon="none" class="btn-header ui-btn-left ui-nodisc-icon btn-text-header" style="display:none;" onClick="cancelInfo();">Cancel</a>
                
                <h1 class="ui-title">Edit Profile</h1>
                
                <a href="#" id="done-info" data-role="button" data-icon="none" class="btn-header ui-btn-right ui-nodisc-icon btn-text-header" style="display:none;" onClick="updateInfo();">Done</a>
                
            </div>
            
			 <div data-role="content" class="content-noMargin">
             	  
                <div class="profil-header" align="center">
                   <div class="imagewrap">
                        <img src="images/profil.png" class="roundedImage photo_profil" />
                        <a href="#popupPhoto" data-rel="popup" data-icon="camera" data-role="button" data-iconpos="notext" class="btn-app ui-nodisc-icon button-photo" data-transition="slideup"></a>
                   </div>
                   <input name="name_text" id="name_text" data-wrapper-class="input-search" type="text" placeholder="Name..." value="">
               </div> 
               
               <ul data-role="listview" class="ui-nodisc-icon list-text ui-alt-icon">
                	<li class="title-text">STATUS</li>
                	<li>
                    <input name="status_text" id="status_text" data-wrapper-class="input-transparent" type="text" placeholder="Status..." value="">
                  </li>
                </ul>
                
               <ul data-role="listview" class="ui-nodisc-icon list-text ui-alt-icon">
                	<li class="title-text">PHONE NUMBER</li>
                	<li>
                    <p class="text-normal title-phone">&nbsp;</p>
                  </li>
                </ul>
                
                <ul data-role="listview" class="ui-nodisc-icon list-text ui-alt-icon">
                	<li class="title-text">EMAIL</li>
                	<li>
                    <p class="text-normal title-email">&nbsp;</p>
                  </li>
                </ul>
                
                <br><br>
                
                <div align="center">
                	
                    <a href="#pageChangeMyPassword" class="simple-link">Change Password</a>
                	
                </div>
                
            </div>
        	 
            <div data-role="popup" id="popupPhoto" data-tolerance="0" data-position-to="window" data-overlay-theme="b" style="border:none; box-shadow: none; background-color: transparent;" data-history="false">
              	<ul data-role="listview" data-inset="true" data-icon="none" style="min-width:210px;" class="ui-nodisc-icon ul-picture">
                   <li><a href="#" onClick="getPhotoProfil('popupPhoto');">Choose Photo</a></li>
                   <li><a href="#" onClick="capturePhotoProfil('popupPhoto');">Take Photo</a></li>
              </ul>
              <ul data-role="listview" data-inset="true" data-icon="none" style="min-width:210px;" class="ui-nodisc-icon ul-picture">
                   <li><a href="#" onClick="closePopup('popupPhoto');" class="red-text">Cancel</a></li>
              	</ul>
         	 </div>
       		
        </div>
        
        <!-- -->
        
        <div data-role="page" id="pageChangeMyPassword">
        
            <div data-role="header" data-theme="c" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                
                <h1 class="ui-title">Change Password</h1>
                
                <a href="#" data-rel="back" data-role="button" data-icon="carat-l" data-iconpos="notext" class="btn-header ui-btn-left ui-nodisc-icon"></a>
                
            </div>
            
            <form method="post" action="javascript:changePassword();">
				
                <div data-role="content" align="center">
            		
                    <div class="div-spacing">
                    	<label for="old_password" id="old_password_label" class="label_small" style="display:none;">Current Password</label>
                        <input name="old_password" id="old_password" data-wrapper-class="input-app" value="" type="password" placeholder="Current Password">
                        
                        <label for="new_password" id="new_password_label" class="label_small" style="display:none;">New Password</label>
                        <input name="new_password" id="new_password" data-wrapper-class="input-app" value="" type="password" placeholder="New Password">
                        
                        <label for="renew_password" id="renew_password_label" class="label_small" style="display:none;">Confirm your new Password</label>
                        <input name="renew_password" id="renew_password" data-wrapper-class="input-app" value="" type="password" placeholder="Confirm your new Password">
                        
                    </div>
                
				</div>
                
                <div data-role="footer" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                    <div class="ui-grid-solo">
                         <div class="ui-block-a block-footer">
                         		<button type="submit" data-role="button" class="btnOne-footer btn-app btn-noradius">Save</button>
                         </div>
                    </div>
                </div>
                
            </form>
        
        </div>
        
        <!-- -->
        
        <div data-role="page" id="pagePendingFriends">
        	
            <div data-role="header" class="header-white" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                
                <h1 class="ui-title">Pending Friends</h1>
                
                <a href="#" data-rel="back" data-role="button" data-icon="carat-l" data-iconpos="notext" class="btn-header ui-nodisc-icon ui-btn-left ui-alt-icon"></a>
                
            </div>
            
			 <div data-role="content" class="content-noMargin">
             	  
              <ul data-role="listview" data-inset="true" class="ui-nodisc-icon list-app-small" id="list-pendingFriend">
                	<!--li>
                    <div class="ui-grid-b">
                           <div class="ui-block-a block3-photo"><img src="images/logo.png" class="roundedSmall"></div>
                           <div class="ui-block-b block3-text">
                            <p class="name-profil">Aboubaker</p>
                            <p class="status-profil">test</p>
                           </div>
                           <div class="ui-block-c block3-btn" align="right">&nbsp;</div>
                    </div>
                  </li>
                  <li>
                    <div class="ui-grid-b">
                           <div class="ui-block-a block3-photo"><img src="images/logo.png" class="roundedSmall"></div>
                           <div class="ui-block-b block3-text">
                            <p class="name-profil">Aboubaker</p>
                            <p class="status-profil">test</p>
                           </div>
                           <div class="ui-block-c block3-btn" align="right">&nbsp;</div>
                    </div>
                  </li-->
                </ul>  
                
                <div id="noPendingFriend-div" align="center" >
                    <br>
                    <img src="images/sad.png" width="110">
                    <h3 class="text-silver">No Friends, yet.</h3>
                </div>
                
            </div>
        	 
        </div>
        
        <!-- -->
        
        <div data-role="page" id="pageNewGroup">
        	
            <div data-role="header" class="header-white" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                
                <a href="#" data-rel="back" data-role="button" data-icon="carat-l" data-iconpos="notext" class="btn-header ui-nodisc-icon ui-btn-left ui-alt-icon"></a>
                
                <h1 class="ui-title">Add a new group</h1>
                
                <a href="#" data-role="button" data-icon="none" class="btn-header ui-btn-right ui-nodisc-icon btn-text-header" onClick="createGroup();">Create</a>
                
            </div>
            
			 <div data-role="content">
             
             	  <div align="center">
                    <div class="imagewrap">
                        <img src="images/groups.png" class="roundedImage" id="photo_group" />
                        <a href="#" data-icon="camera" data-role="button" data-iconpos="notext" class="btn-app ui-nodisc-icon button-photo" onClick="getPhotoGroup();"></a>
                    </div>
                </div>
                <br><br>
                <input name="group_name" id="group_name" data-wrapper-class="input-app" value="" type="text" placeholder="Group Subject" maxlength="24">
                <br>
                <textarea name="group_description" id="group_description" data-wrapper-class="input-app" placeholder="Group Description"></textarea>
                
            </div>
        	 
        </div>
        
        <!-- -->
        
        <div data-role="page" id="pageInfoGroup">
        	
            <div data-role="header" class="header-white" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                
                <a href="#" data-rel="back" data-role="button" data-icon="carat-l" data-iconpos="notext" class="btn-header ui-nodisc-icon ui-btn-left ui-alt-icon"></a>
                
                <h1 class="ui-title">Group info</h1>
                
            </div>
            
			 <div data-role="content" class="content-noMargin">
             
             	  <div class="imagewrap div_img">
                   <div class="image-cadre" id="photo_infoGroup"></div>
                   <a href="#" data-icon="camera" data-role="button" data-iconpos="notext" class="btn-app ui-nodisc-icon button-photo" onClick="getUpdatePhotoGroup();" id="btn-editPhotoGroup"></a>
                </div>
                
                <input type="hidden" value="0" id="group_id">
                
               
                <ul data-role="listview" class="ui-nodisc-icon list-info ui-alt-icon list-minus">
                	<li>
                    <a class="text-normal text_noOpacity" id="name_infoGroup" onClick="updateGroupName();">Test Name</a>
                  </li>
                  <li>
                    <a class="text-normal text_noOpacity" id="description_infoGroup" onClick="updateGroupDescription();">Add group description</a>
                  </li>
                </ul>
                <br>
                <ul data-role="listview" class="ui-nodisc-icon list-info ui-alt-icon list-minus" id="list-readOnly">
                	<li data-icon="none">
                    <div class="center-wrapper">
                        	<span>Read-Only</span>
                         <span class="fliper-enable">
                            <form>                                
                                <input data-role="flipswitch" name="flip-checkbox-readOnly" id="flip-checkbox-readOnly" data-on-text="" data-off-text="" data-wrapper-class="custom-label-flipswitch" type="checkbox" onChange="changeReadOnly();" />
                            </form>
							</span>
                    </div>
                     
                  </li>
                </ul>
                
                
                <ul data-role="listview" class="ui-nodisc-icon list-text" id="list-groupUsers">
                	<li class="title-text"><span id="nbr-participant">0</span> PARTICIPANTS</li>
                  <li class="li-btn">
                    <a href="#" data-icon="plus" data-role="button" data-iconpos="left" class="ui-nodisc-icon btn-list ui-alt-icon" data-transition="slideup">Add Participants</a>
                  </li>
                  <!--li>
                    <div class="ui-grid-b">
                           <div class="ui-block-a block3-photo"><img src="images/1.png" class="roundedSmall"></div>
                           <div class="ui-block-b block3-text">
                            <p class="name-profil">Aboubaker</p>
                            <p class="status-profil">test</p>
                           </div>
                           <div class="ui-block-c block3-btn" align="right"><a href="#" data-role="button" data-icon="minus" data-iconpos="notext" class="btn-red ui-nodisc-icon btn-nomargin"></a></div>
                    </div>
                  </li-->
                </ul>
                
                <ul data-role="listview" class="ui-nodisc-icon list-text" id="list-groupPending">
                	<li class="title-text">PENDING PARTICIPANTS</li>
                </ul>
                
                <ul data-role="listview" class="ui-nodisc-icon list-text" id="list-groupBlock">
                	<li class="title-text">BLOCK PARTICIPANTS</li>
                </ul>
                
                <br>
                
                <ul data-role="listview" data-inset="true" data-icon="none" class="ui-nodisc-icon list-app" id="request-infoGroup">
                  <li>
                    <a href="#" onClick="acceptPageGroup();">
                    		Confirm Request
                    </a>
                  </li>
                	<li>
                    <a href="#" onClick="declinedPageGroup();">
                    	<div class="red-text">
                        	Delete Request
                      </div>
                    </a>
                  </li>
                </ul>
                
                <ul data-role="listview" data-inset="true" data-icon="none" class="ui-nodisc-icon list-app" id="add-infoGroup">
                  <li>
                    <a href="#" onClick="sendPageGroup();">
                    		Join Group
                    </a>
                  </li>
                </ul>
                
                <ul data-role="listview" data-inset="true" data-icon="none" class="ui-nodisc-icon list-app" id="exit-infoGroup">
                	<li>
                    <a href="#popupExitGroup" data-rel="popup" data-transition="slideup">
                    	<div class="red-text">
                        	Exit Group
                      </div>
                    </a>
                  </li>
                </ul>
                
            </div>
        	 
            <div data-role="popup" id="popupExitGroup" data-tolerance="0" data-position-to="window" data-overlay-theme="b" style="border:none; box-shadow: none;" data-history="false">
              	<ul data-role="listview" data-inset="true" data-icon="none" style="min-width:210px;" class="ui-nodisc-icon ul-picture">
                   <li><a href="#" onClick="exitGroup();">Exit Group</a></li>
                   <li><a href="#" onClick="closePopup('popupExitGroup');">Cancel</a></li>
              	</ul>
         	 </div>
            
            <div data-role="popup" id="popupUserConfig" data-tolerance="0" data-position-to="window" data-overlay-theme="b" style="border:none; box-shadow: none; background-color:transparent;" data-history="false">
              	<ul data-role="listview" data-inset="true" data-icon="none" style="min-width:210px;" class="ui-nodisc-icon ul-picture">
                	 <li><a href="#" style="color:#BBB !important;" id="popup-name">Name</a></li>
                   <li><a href="#" id="popup-remove">Remove from group</a></li>
                   <li><a href="#" id="popup-block">Block User</a></li>
              	</ul>
              <ul data-role="listview" data-inset="true" data-icon="none" style="min-width:210px;" class="ui-nodisc-icon ul-picture">
                   <li><a href="#" onClick="closePopup('popupUserConfig');">Cancel</a></li>
              	</ul>
         	 </div>
            
        </div>
        
        <!-- -->
        
        <div data-role="page" id="pageInfoProfil">
        	
            <div data-role="header" class="header-white" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                
                <a href="#" data-rel="back" data-role="button" data-icon="carat-l" data-iconpos="notext" class="btn-header ui-nodisc-icon ui-btn-left ui-alt-icon"></a>
                
                <h1 class="ui-title">Contact Info</h1>
                
            </div>
            
			 <div data-role="content" class="content-noMargin">
             	  
                <input id="user_two" name="user_two" type="hidden" value="">
                 
             	  <div class="imagewrap div_img">
                   <div class="image-cadre" id="photo_infoProfil"></div>
                </div>
                
                <ul data-role="listview" data-icon="none" class="ui-nodisc-icon list-info list-minus">
                	<li>
                    <div class="ui-grid-a">
                        <div class="ui-block-a">
                            <h3 class="text-normal" id="name_infoProfil">Test Name</h3>
                            <div class="status-profil" id="status_infoProfil">Status</div>
                        </div>
                        <div class="ui-block-b" align="right">
                            <a href="#" data-role="button" data-icon="comment" data-iconpos="notext" class="btn-app ui-nodisc-icon btn-nomargin" style="display:none;" id="btnChat_infoProfil"></a>
                            <div style="display:none;" id="btnAdd_infoProfil"></div>
                            <a href="#" data-role="button" data-icon="clock" data-iconpos="notext" class="btn-orange ui-nodisc-icon btn-nomargin" style="display:none;" id="btnRequest_infoProfil"></a>
                            
                            <div id="btnPending_infoProfil"></div>
                            
                        </div>
                    </div>
                  </li>
                </ul>
                
                <br>
                
                <!--ul data-role="listview" class="ui-nodisc-icon list-text" id="list-inGroups">
                	<li class="title-text">JOIN GROUPS</li>
                  
                </ul-->
                
                <!--ul data-role="listview" data-inset="true" data-icon="none" class="ui-nodisc-icon list-app" id="block_infoProfil">
                	<li>
                    <a href="#popupBlock" data-rel="popup" data-transition="slideup">
                    	<div class="red-text">
                        	Block contact
                      </div>
                    </a>
                  </li>
                </ul-->
                
            </div>
        	 
            <!--div data-role="popup" id="popupBlock" data-tolerance="0" data-position-to="window" data-overlay-theme="b" style="border:none; box-shadow: none;" data-history="false">
              	<ul data-role="listview" data-inset="true" data-icon="none" style="min-width:210px;" class="ui-nodisc-icon ul-picture">
                   <li><a href="#" onClick="blockContact();">Block contact</a></li>
                   <li><a href="#" onClick="closePopup('popupBlock');">Cancel</a></li>
              	</ul>
         	 </div--> 
            
        </div>
        
        <!-- -->
        
        <div data-role="page" id="pageWallpaper">
        	
            <div data-role="header" class="header-white" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                
                <a href="#" data-rel="back" data-role="button" data-icon="carat-l" data-iconpos="notext" class="btn-header ui-nodisc-icon ui-btn-left ui-alt-icon"></a>
                
                <h1 class="ui-title">Chat Wallpaper</h1>
                
            </div>
            
			 <div data-role="content" class="content-noMargin">
             	  
                <ul data-role="listview" data-inset="true" class="ui-nodisc-icon list-app ui-alt-icon">
                	<li>
                    <a href="#pageLibrary" data-transition="slide">
                        Wallpaper Library
                    </a>
                  </li>
                  <li>
                    <a href="#pageColor" data-transition="slide">
                        Solid Colors
                    </a>
                  </li>
                  <li>
                    <a href="#" onClick="setPhotoWallpaper();">
                        Photos
                    </a>
                  </li>
                </ul>
                
                <br>
                
                <ul data-role="listview" data-inset="true" data-icon="none" class="ui-nodisc-icon list-app">
                	<li>
                    <a href="#popupReset" data-rel="popup" data-transition="slideup">
                    	<div class="red-text">
                        	Reset Wallpaper
                      </div>
                    </a>
                  </li>
                </ul>
                
                
            </div>
            
       		 <div data-role="popup" id="popupReset" data-tolerance="0" data-position-to="window" data-overlay-theme="b" style="border:none; box-shadow: none; background-color:transparent;" data-history="false">
              	<ul data-role="listview" data-inset="true" data-icon="none" style="min-width:210px;" class="ui-nodisc-icon ul-picture">
                   <li><a href="#" onClick="resetWallpaper();">Reset Wallpaper</a></li>
                   <li><a href="#" onClick="closePopup('popupReset');">Cancel</a></li>
              	</ul>
         	 </div>
        </div>
        
        <!-- -->
        
        <div data-role="page" id="pageLibrary" class="my-page">
        	
            <div data-role="header" class="header-white" data-theme="c" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                
                <a href="#" data-rel="back" data-role="button" data-icon="carat-l" data-iconpos="notext" class="btn-header ui-nodisc-icon ui-btn-left ui-alt-icon"></a>
                
                <h1 class="ui-title">WallPaper Library</h1>
                
            </div>
            
			 <div data-role="content"  class="content-noMargin">
             	  
                  <ul data-role="listview" data-inset="true" class="list-rect ui-nodisc-icon" data-icon="none">
                  	<li>
                          <a href="#" onClick="openPreview(this);"><img src="images/background/0.jpg" class="ui-li-thumb"></a>
                    	</li>
                      <li>
                          <a href="#" onClick="openPreview(this);"><img src="images/background/1.jpg" class="ui-li-thumb"></a>
                    	</li>
                      <li>
                          <a href="#" onClick="openPreview(this);"><img src="images/background/2.jpg" class="ui-li-thumb"></a>
                    	</li>
                      <li>
                          <a href="#" onClick="openPreview(this);"><img src="images/background/3.jpg" class="ui-li-thumb"></a>
                    	</li>
                      <li>
                          <a href="#" onClick="openPreview(this);"><img src="images/background/4.jpg" class="ui-li-thumb"></a>
                    	</li>
                      <li>
                          <a href="#" onClick="openPreview(this);"><img src="images/background/5.jpg" class="ui-li-thumb"></a>
                    	</li>
                      <li>
                          <a href="#" onClick="openPreview(this);"><img src="images/background/6.jpg" class="ui-li-thumb"></a>
                    	</li>
                      <li>
                          <a href="#" onClick="openPreview(this);"><img src="images/background/7.jpg" class="ui-li-thumb"></a>
                    	</li>
                  </ul>
                  
            </div>
            
        </div>
        
        <!-- -->
        
        <div data-role="page" id="pagePreview" class="page-transparent">
           
           <div class="background-preview"></div>
           
           <div data-role="header" data-theme="c" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                
                <h1 class="ui-title">Wallpaper Preview</h1>
                
                <a href="#" data-rel="back" data-role="button" data-icon="carat-l" data-iconpos="notext" class="btn-header ui-btn-left ui-nodisc-icon"></a>
                
           </div>
            
			<div data-role="content">
            	   
                <ul data-icon="none" class="ul-conversation" data-role="listview">
                	   <li class="li-date"><center><div class="date-back">Today</div></center></li>
                     <li class="li-chat">
                     	
                     	  <div class="chat-bull div-chat">
                     		<div class="message-chat">Hello World!!!</div>
                     		<div class="center-chat date-bull">
                            <span class="date-conversation date-grey">&nbsp;4:10 PM</span>
							</div>
                        </div>
                      
                     </li>
                     <li class="li-chat">
                      
                     		<div class="chat-bull bull-right div-chat">
                            <div class="message-chat">Hi!!!</div>
                            <div class="center-chat date-bull">
                                <span class="date-conversation date-white">&nbsp;11:10 PM</span>
                                <img src="images/checkmark-white.png" class="image-status"/>
                            </div>
                         </div>
                      
                    </li>
                     
               </ul>
               
			</div>
            
            <div data-role="footer" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
            	<div data-role="navbar">
                    <ul>
                        <li>
                        	<a href="#" data-rel="back" data-role="button" class="btn-text-app btn-noradius">Cancel</a>
                        </li>
                        <li>
                        	<a href="#" data-role="button" class="btn-text-app btn-noradius" onClick="setWallpaper();" id="btn-wallpaper">Set</a>
                         <a href="#" data-role="button" class="btn-text-app btn-noradius" onClick="setColorWallpaper();" id="btn-color" style="display:none;">Set</a>
                        </li>
                    </ul>
              </div>
            </div>
            
        </div>
        
        <!-- -->
        
        <div data-role="page" id="pageColor" class="my-page">
        	
            <div data-role="header" class="header-white" data-theme="c" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                
                <a href="#" data-rel="back" data-role="button" data-icon="carat-l" data-iconpos="notext" class="btn-header ui-nodisc-icon ui-btn-left ui-alt-icon"></a>
                
                <h1 class="ui-title">Solid Color</h1>
                
            </div>
            
			 <div data-role="content"  class="content-noMargin">
             	  
                  <ul data-role="listview" data-inset="true" class="list-rect ui-nodisc-icon" data-icon="none">
                  	<li>
                          <a href="#" onClick="openColorPreview('#075e54');" style="background-color:#075e54;"></a>
                    	</li>
                      <li>
                          <a href="#" onClick="openColorPreview('#128c7e');" style="background-color:#128c7e;"></a>
                    	</li>
                      <li>
                          <a href="#" onClick="openColorPreview('#25d366');" style="background-color:#25d366;"></a>
                    	</li>
                      <li>
                          <a href="#" onClick="openColorPreview('#dcf8c6');" style="background-color:#dcf8c6;"></a>
                    	</li>
                      <li>
                          <a href="#" onClick="openColorPreview('#34b7f1');" style="background-color:#34b7f1;"></a>
                    	</li>
                      <li>
                          <a href="#" onClick="openColorPreview('#ece5dd');" style="background-color:#ece5dd;"></a>
                    	</li>
                      <li>
                          <a href="#" onClick="openColorPreview('#3369e7');" style="background-color:#3369e7;"></a>
                    	</li>
                      <li>
                          <a href="#" onClick="openColorPreview('#8e43e7');" style="background-color:#8e43e7;"></a>
                    	</li>
                      <li>
                          <a href="#" onClick="openColorPreview('#FFF');" style="background-color:#FFF;"></a>
                    	</li>
                      <li>
                          <a href="#" onClick="openColorPreview('#000');" style="background-color:#000;"></a>
                    	</li>
                  </ul>
                  
            </div>
            
        </div>
        
        <!-- -->
        
        <div data-role="page" id="pageAddFriends">
        	
            <div data-role="header" class="header-white" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                
                <a href="#" data-rel="back" data-role="button" data-icon="carat-l" data-iconpos="notext" class="btn-header ui-nodisc-icon ui-btn-left ui-alt-icon"></a>
                
                <h1 class="ui-title title-left">Add Participants</h1>
                
            </div>
            
			 <div data-role="content" class="content-noMargin">
             	  
                <div class="div-input">
              		<input name="search_myFriend" id="search_myFriend" data-wrapper-class="input-search"  type="search" placeholder="Search">
              </div>  
              
              <ul data-role="listview" data-inset="true" data-filter="true" data-input="#search_myFriend" class="ui-nodisc-icon list-app-small" id="list-myFriend" data-autodividers="true">
                	<!--li>
                    <div class="ui-grid-b">
                           <div class="ui-block-a block3-photo"><img src="images/logo.png" class="roundedSmall"></div>
                           <div class="ui-block-b block3-text">
                            <p class="name-profil">Aboubaker</p>
                            <p class="status-profil">test</p>
                           </div>
                           <div class="ui-block-c block3-btn" align="right"><a href="#" data-role="button" data-icon="check" data-iconpos="notext" class="btn-app ui-nodisc-icon btn-nomargin" data-inline="true"></a><a href="#" data-role="button" data-icon="minus" data-iconpos="notext" class="ui-nodisc-icon btn-nomargin btn-red" data-inline="true"></a></div>
                    </div>
                  </li>
                  <li>
                    <div class="ui-grid-b">
                           <div class="ui-block-a block3-photo"><img src="images/logo.png" class="roundedSmall"></div>
                           <div class="ui-block-b block3-text">
                            <p class="name-profil">Aboubaker</p>
                           </div>
                           <div class="ui-block-c block3-btn" align="right"><a href="#" data-role="button" data-icon="plus" data-iconpos="notext" class="btn-app ui-nodisc-icon btn-nomargin"></a></div>
                    </div>
                  </li-->
                </ul>
                
                <div id="noMyFriend-div" align="center" >
                    <br>
                    <img src="images/sad.png" width="110">
                    <h3 class="text-silver">No Friends, yet.</h3>
                </div>
                
            </div>
        	 
        </div>
        
        <!-- -->
        
        <div data-role="page" id="pagePendingGroups">
        	
            <div data-role="header" class="header-white" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                
                <h1 class="ui-title">Pending Groups</h1>
                
                <a href="#" data-rel="back" data-role="button" data-icon="carat-l" data-iconpos="notext" class="btn-header ui-nodisc-icon ui-btn-left ui-alt-icon"></a>
                
                <div data-role="navbar" class="custom-navbar">
                    <ul>
                        <li>
                            <a href="#" onClick="showDiv('div-myGroup', 'div-otherGroup');" id="navbar-myGroup" class="ui-btn-active ui-state-persist">My Groups</a>
                        </li>
                        <li>
                            <a href="#" onClick="showDiv('div-otherGroup', 'div-myGroup');" id="navbar-otherGroup">Other Groups</a>
                        </li>
                     </ul>
               </div>
                
            </div>
            
			 <div data-role="content" class="content-noMargin">
             <div id="div-myGroup">
              <ul data-role="listview" data-inset="true" class="ui-nodisc-icon list-app-small" id="list-pendingMyGroup">
               
              </ul>  
                
                <div id="noPendingMyGroup-div" align="center" >
                    <br>
                    <img src="images/sad.png" width="110">
                    <h3 class="text-silver">No Users, yet.</h3>
                </div>
              </div>
              
             <div id="div-otherGroup" style="display:none;">
              <ul data-role="listview" data-inset="true" class="ui-nodisc-icon list-app-small" id="list-pendingGroup">
               
              </ul>  
                
                <div id="noPendingGroup-div" align="center" >
                    <br>
                    <img src="images/sad.png" width="110">
                    <h3 class="text-silver">No Groups, yet.</h3>
                </div>
              </div>
               
            </div>
        	 
        </div>
        
        <!-- -->
        
        <div data-role="page" id="pageMyGroups">
        	
            <div data-role="header" class="header-white" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                
                <a href="#" data-rel="back" data-role="button" data-icon="carat-l" data-iconpos="notext" class="btn-header ui-nodisc-icon ui-btn-left ui-alt-icon"></a>
                
                <h1 class="ui-title title-left">Settings My groups</h1>
                
            </div>
            
			 <div data-role="content" class="content-noMargin">
             	  
                <div class="div-input">
              		<input name="search_myGroup" id="search_myGroup" data-wrapper-class="input-search"  type="search" placeholder="Search">
              </div>  
              
              <ul data-role="listview" data-inset="true" data-filter="true" data-input="#search_myGroup" class="ui-nodisc-icon list-app-small" id="list-myGroup" data-autodividers="true">
                	<!--li>
                    <div class="ui-grid-b">
                           <div class="ui-block-a block3-photo"><img src="images/logo.png" class="roundedSmall"></div>
                           <div class="ui-block-b block3-text">
                            <p class="name-profil">Aboubaker</p>
                            <p class="status-profil">test</p>
                           </div>
                           <div class="ui-block-c block3-btn" align="right"><a href="#" data-role="button" data-icon="check" data-iconpos="notext" class="btn-app ui-nodisc-icon btn-nomargin" data-inline="true"></a><a href="#" data-role="button" data-icon="minus" data-iconpos="notext" class="ui-nodisc-icon btn-nomargin btn-red" data-inline="true"></a></div>
                    </div>
                  </li>
                  <li>
                    <div class="ui-grid-b">
                           <div class="ui-block-a block3-photo"><img src="images/logo.png" class="roundedSmall"></div>
                           <div class="ui-block-b block3-text">
                            <p class="name-profil">Aboubaker</p>
                           </div>
                           <div class="ui-block-c block3-btn" align="right"><a href="#" data-role="button" data-icon="plus" data-iconpos="notext" class="btn-app ui-nodisc-icon btn-nomargin"></a></div>
                    </div>
                  </li-->
                </ul>
                
                <div id="noMyGroups-div" align="center" >
                    <br>
                    <img src="images/sad.png" width="110">
                    <h3 class="text-silver">No Groups, yet.</h3>
                </div>
                
            </div>
        	 
        </div>
        
        <!-- -->
        
        <div data-role="page" id="pageSendGallery" class="page-imageFull">
        	
            <div data-role="header" class="header-transparent" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                
                <a href="#" data-rel="back" data-role="button" data-icon="delete" data-iconpos="notext" class="btn-header ui-nodisc-icon ui-btn-left"></a>
                
                <h1 class="ui-title title-left">&nbsp;</h1>
                
            </div>
            
			 <div data-role="content" class="content-imageFull">
             	<img src="images/city.jpeg" class="allImage" id="imageSend">
            </div>
        	 
            <div data-role="footer" class="footer-chat" id="footer-photoChat" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">  
              
            	<a href="#" onClick="sendFile('photo');" data-iconpos="notext" data-role="button" class="btn-sendChat btn-app ui-nodisc-icon" data-icon="send-white"></a>
                
            </div> 
            
            <div data-role="footer" style="display:none;" class="footer-chat" id="footer-photoStatus" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">  
              
            	<a href="#" onClick="sendStatus('photo');" data-iconpos="notext" data-role="button" class="btn-sendChat btn-app ui-nodisc-icon" data-icon="send-white"></a>
                
            </div>
            
        </div>
        
        <!-- -->
        
        <div data-role="page" id="pageOpenGallery" class="page-imageFull">
        	
            <div data-role="header" class="header-white" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                
                <a href="#" data-rel="back" data-role="button" data-icon="carat-l" data-iconpos="notext" class="btn-header ui-nodisc-icon ui-btn-left ui-alt-icon"></a>
                
                <h1 class="ui-title" id="title-gallery">&nbsp;</h1>
                
                <a href="#" data-role="button" data-icon="action" data-iconpos="notext" class="btn-header ui-nodisc-icon ui-btn-right ui-alt-icon" onClick="saveGallery();"></a>
                
            </div>
            
			 <div data-role="content" class="content-noMargin">
             	 <div class="content-imageFull">
               	<img src="images/background/0.jpg" class="allImage" id="imageOpen">
               </div>
            </div>
            
        </div>
        
        <!-- -->
        
        <div data-role="page" id="pageSearchGroups">
        	
            <div data-role="header" class="header-white" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                
                <a href="#" data-rel="back" data-role="button" data-icon="carat-l" data-iconpos="notext" class="btn-header ui-nodisc-icon ui-btn-left ui-alt-icon"></a>
                
                <h1 class="ui-title title-left">Search Groups</h1>
                
                 <a href="#pageNewGroup" data-transition="slideup" data-role="button" data-icon="plus-app" data-iconpos="notext" class="btn-header ui-nodisc-icon ui-btn-right"></a>
                
            </div>
            
			 <div data-role="content" class="content-noMargin">
             	  
                <div class="inline-form">
                      <div class="wrapper">
                        <div class="content">
                          <input name="search_group" id="search_group" data-wrapper-class="input-search" type="text" placeholder="Search...">
                        </div>
                      </div>

                      <div class="right">
                        <a href="#" data-role="button" data-icon="search" data-iconpos="notext" class="btn-app ui-nodisc-icon" onClick="searchGroups();"></a>
                      </div>
                </div>
                
                <br>
                
                <center><img id="img_loadingGroup" src="css/images/loading.gif" width="30px" style="display:none;"></center>
                
                <ul data-role="listview" data-inset="true" class="ui-nodisc-icon list-app-small" id="list-searchGroup">
                	<!--li>
                    <div class="ui-grid-b">
                           <div class="ui-block-a block3-photo"><img src="images/logo.png" class="roundedSmall"></div>
                           <div class="ui-block-b block3-text">
                            <p class="name-profil">Aboubaker</p>
                            <p class="status-profil">test</p>
                           </div>
                           <div class="ui-block-c block3-btn" align="right"><a href="#" data-role="button" data-icon="check" data-iconpos="notext" class="btn-app ui-nodisc-icon btn-nomargin" data-inline="true"></a><a href="#" data-role="button" data-icon="minus" data-iconpos="notext" class="ui-nodisc-icon btn-nomargin btn-red" data-inline="true"></a></div>
                    </div>
                  </li>
                  <li>
                    <div class="ui-grid-b">
                           <div class="ui-block-a block3-photo"><img src="images/logo.png" class="roundedSmall"></div>
                           <div class="ui-block-b block3-text">
                            <p class="name-profil">Aboubaker</p>
                           </div>
                           <div class="ui-block-c block3-btn" align="right"><a href="#" data-role="button" data-icon="plus" data-iconpos="notext" class="btn-app ui-nodisc-icon btn-nomargin"></a></div>
                    </div>
                  </li-->
                </ul>
                
                <div id="noSearchGroup-div" align="center" style="display:none;">
                    <br>
                    <img src="images/sad.png" width="110">
                    <h3 class="text-silver">No search results found</h3>
                </div>
                
            </div>
        	 
        </div>
        
        <!-- -->
        
        <div data-role="page" id="pageHelp">
        	
            <div data-role="header" class="header-white" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                
                <a href="#" data-rel="back" data-role="button" data-icon="carat-l" data-iconpos="notext" class="btn-header ui-nodisc-icon ui-btn-left ui-alt-icon"></a>
                
                <h1 class="ui-title">Twtchat</h1>
                
                
            </div>
            
			 <div data-role="content" class="content-noMargin">
             	  
               <img src="images/logo.png" class="logo-first">
               
               <ul data-role="listview" data-inset="true" class="ui-nodisc-icon list-app ui-alt-icon">
                	<li>
                    <a href="#" onClick="openUrl('mailto:info@twtchat.net');"><span>Contact Us</span></a>
                  </li>
                  <li>
                    <a href="#pagePolicy"><span>Terms and Privacy Policy</span></a>
                  </li>
                </ul>  
                
                <ul data-role="listview" data-inset="true" class="ui-nodisc-icon list-app ui-alt-icon">
                	<li>
                    <a href="#pageAbout">
                    	<div class="center-wrapper">
                        	<img width="25px" src="images/logo.png" />&nbsp;<span>About Twtchat</span>
                      </div>
                    </a>
                  </li>
                </ul>
                
                <ul data-role="listview" data-inset="true" class="ui-nodisc-icon list-app ui-alt-icon">
                	<li class="title-text">&copy; 2018 Twtchat. All rights reserved</li>
                </ul>
            </div>
        	 
        </div>
        
       <!-- -->
       
       <div data-role="page" id="pagePolicy">
        	
            <div data-role="header" class="header-white" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                
                <a href="#" data-rel="back" data-role="button" data-icon="carat-l" data-iconpos="notext" class="btn-header ui-nodisc-icon ui-btn-left ui-alt-icon"></a>
                
                <h1 class="ui-title title-left">Terms and Privacy Policy</h1>
                
                
            </div>
            
			 <div data-role="content">
             	 
                  <img src="images/logo.png" class="logo-first">
                  
                  <h1>Privacy Policy</h1>


                   <p>Effective date: July 01, 2018</p>
                    
                    
                    <p>Twtchat ("us", "we", or "our") operates the  website and the Twtchat mobile application (the "Service").</p>
                    
                    <p>This page informs you of our policies regarding the collection, use, and disclosure of personal data when you use our Service and the choices you have associated with that data.</p>
                    
                    <p>We use your data to provide and improve the Service. By using the Service, you agree to the collection and use of information in accordance with this policy. Unless otherwise defined in this Privacy Policy, terms used in this Privacy Policy have the same meanings as in our Terms and Conditions.</p>
                    
                    
                    <h2>Information Collection And Use</h2>
                    
                    <p>We collect several different types of information for various purposes to provide and improve our Service to you.</p>
                    
                    <h3>Types of Data Collected</h3>
                    
                    <h4>Personal Data</h4>
                    
                    <p>While using our Service, we may ask you to provide us with certain personally identifiable information that can be used to contact or identify you ("Personal Data"). Personally identifiable information may include, but is not limited to:</p>
                    
                    <ul>
                    <li>Email address</li><li>First name and last name</li><li>Phone number</li><li>Cookies and Usage Data</li>
                    </ul>
                    
                    <h4>Usage Data</h4>
                    
                    <p>We may also collect information that your browser sends whenever you visit our Service or when you access the Service by or through a mobile device ("Usage Data").</p>
                    <p>This Usage Data may include information such as your computer's Internet Protocol address (e.g. IP address), browser type, browser version, the pages of our Service that you visit, the time and date of your visit, the time spent on those pages, unique device identifiers and other diagnostic data.</p>
                    <p>When you access the Service by or through a mobile device, this Usage Data may include information such as the type of mobile device you use, your mobile device unique ID, the IP address of your mobile device, your mobile operating system, the type of mobile Internet browser you use, unique device identifiers and other diagnostic data.</p>
                    
                    <h4>Tracking & Cookies Data</h4>
                    <p>We use cookies and similar tracking technologies to track the activity on our Service and hold certain information.</p>
                    <p>Cookies are files with small amount of data which may include an anonymous unique identifier. Cookies are sent to your browser from a website and stored on your device. Tracking technologies also used are beacons, tags, and scripts to collect and track information and to improve and analyze our Service.</p>
                    <p>You can instruct your browser to refuse all cookies or to indicate when a cookie is being sent. However, if you do not accept cookies, you may not be able to use some portions of our Service.</p>
                    <p>Examples of Cookies we use:</p>
                    <ul>
                        <li><strong>Session Cookies.</strong> We use Session Cookies to operate our Service.</li>
                        <li><strong>Preference Cookies.</strong> We use Preference Cookies to remember your preferences and various settings.</li>
                        <li><strong>Security Cookies.</strong> We use Security Cookies for security purposes.</li>
                    </ul>
                    
                    <h2>Use of Data</h2>
                        
                    <p>Twtchat uses the collected data for various purposes:</p>    
                    <ul>
                        <li>To provide and maintain the Service</li>
                        <li>To notify you about changes to our Service</li>
                        <li>To allow you to participate in interactive features of our Service when you choose to do so</li>
                        <li>To provide customer care and support</li>
                        <li>To provide analysis or valuable information so that we can improve the Service</li>
                        <li>To monitor the usage of the Service</li>
                        <li>To detect, prevent and address technical issues</li>
                    </ul>
                    
                    <h2>Transfer Of Data</h2>
                    <p>Your information, including Personal Data, may be transferred to — and maintained on — computers located outside of your state, province, country or other governmental jurisdiction where the data protection laws may differ than those from your jurisdiction.</p>
                    <p>If you are located outside Saudi Arabia and choose to provide information to us, please note that we transfer the data, including Personal Data, to Saudi Arabia and process it there.</p>
                    <p>Your consent to this Privacy Policy followed by your submission of such information represents your agreement to that transfer.</p>
                    <p>Twtchat will take all steps reasonably necessary to ensure that your data is treated securely and in accordance with this Privacy Policy and no transfer of your Personal Data will take place to an organization or a country unless there are adequate controls in place including the security of your data and other personal information.</p>
                    
                    <h2>Disclosure Of Data</h2>
                    
                    <h3>Legal Requirements</h3>
                    <p>Twtchat may disclose your Personal Data in the good faith belief that such action is necessary to:</p>
                    <ul>
                        <li>To comply with a legal obligation</li>
                        <li>To protect and defend the rights or property of Twtchat</li>
                        <li>To prevent or investigate possible wrongdoing in connection with the Service</li>
                        <li>To protect the personal safety of users of the Service or the public</li>
                        <li>To protect against legal liability</li>
                    </ul>
                    
                    <h2>Security Of Data</h2>
                    <p>The security of your data is important to us, but remember that no method of transmission over the Internet, or method of electronic storage is 100% secure. While we strive to use commercially acceptable means to protect your Personal Data, we cannot guarantee its absolute security.</p>
                    
                    <h2>Service Providers</h2>
                    <p>We may employ third party companies and individuals to facilitate our Service ("Service Providers"), to provide the Service on our behalf, to perform Service-related services or to assist us in analyzing how our Service is used.</p>
                    <p>These third parties have access to your Personal Data only to perform these tasks on our behalf and are obligated not to disclose or use it for any other purpose.</p>
                    
                    
                    
                    <h2>Links To Other Sites</h2>
                    <p>Our Service may contain links to other sites that are not operated by us. If you click on a third party link, you will be directed to that third party's site. We strongly advise you to review the Privacy Policy of every site you visit.</p>
                    <p>We have no control over and assume no responsibility for the content, privacy policies or practices of any third party sites or services.</p>
                    
                    
                    <h2>Children's Privacy</h2>
                    <p>Our Service does not address anyone under the age of 18 ("Children").</p>
                    <p>We do not knowingly collect personally identifiable information from anyone under the age of 18. If you are a parent or guardian and you are aware that your Children has provided us with Personal Data, please contact us. If we become aware that we have collected Personal Data from children without verification of parental consent, we take steps to remove that information from our servers.</p>
                    
                    
                    <h2>Changes To This Privacy Policy</h2>
                    <p>We may update our Privacy Policy from time to time. We will notify you of any changes by posting the new Privacy Policy on this page.</p>
                    <p>We will let you know via email and/or a prominent notice on our Service, prior to the change becoming effective and update the "effective date" at the top of this Privacy Policy.</p>
                    <p>You are advised to review this Privacy Policy periodically for any changes. Changes to this Privacy Policy are effective when they are posted on this page.</p>
                    
                    
                    <h2>Contact Us</h2>
                    <p>If you have any questions about this Privacy Policy, please contact us:</p>
                    <ul>
                            <li>By email: info@twtchat.net</li>
                              
                            </ul>                                
               
            </div>
        	 
        </div> 
       	
        <!-- -->
        
        <div data-role="page" id="pageAbout">
        	
            <div data-role="header" class="header-white" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                
                <a href="#" data-rel="back" data-role="button" data-icon="carat-l" data-iconpos="notext" class="btn-header ui-nodisc-icon ui-btn-left ui-alt-icon"></a>
                
                <h1 class="ui-title title-left">About Twtchat</h1>
                
                
            </div>
            
			 <div data-role="content" class="content-noMargin" align="center">
             	 
                  <img src="images/logo.png" class="logo-first">
                  
                  <h2 align="center">Twtchat, be connected</h2>
                  <p>Contact • <a href="#" onClick="openUrl('mailto:info@twtchat.net');">info@twtchat.net</a></p>
                  
                  
            </div>
        	 
            <div data-role="footer" class="footer-transparent" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
            	<ul data-role="listview" data-inset="true" class="ui-nodisc-icon list-app ui-alt-icon">
                 <li class="title-text" style="text-align:center;">&copy; 2018 Twtchat. All rights reserved</li>
              </ul>
            </div>
             
        </div>
        
        <!-- -->
        
        <div data-role="page" id="pageSendVideo" class="page-imageFull">
        	
            <div data-role="header" class="header-transparent" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                
                <a href="#" data-rel="back" data-role="button" data-icon="delete" data-iconpos="notext" class="btn-header ui-nodisc-icon ui-btn-left"></a>
                
                <h1 class="ui-title title-left">&nbsp;</h1>
                
            </div>
            
			 <div data-role="content" class="content-imageFull">
             	 
                 <div id="videoArea" align="center">
                 		<!--video controls='controls'>
							<source src='images/dimag.mp4' type='video/mp4'>
						</video-->
                 </div>
                 
            </div>
        	 
            <div data-role="footer" class="footer-chat" id="footer-videoChat" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
            	
            	<a href="#" onClick="sendFile('video');" data-iconpos="notext" data-role="button" class="btn-sendChat btn-app ui-nodisc-icon" data-icon="send-white"></a>
                
            </div> 
            
            <div data-role="footer" style="display:none;" class="footer-chat" id="footer-videoStatus" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
            	
            	<a href="#" onClick="sendStatus('video');" data-iconpos="notext" data-role="button" class="btn-sendChat btn-app ui-nodisc-icon" data-icon="send-white"></a>
                
            </div>
            
        </div>
        
        <!-- -->
        
        <div data-role="page" id="pageMap">
        	
            <div data-role="header" data-theme="c" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                
                <a href="#" data-rel="back" data-role="button" data-icon="carat-l" data-iconpos="notext" class="btn-header ui-nodisc-icon ui-btn-left"></a>
                
                <h1 class="ui-title">Share Location</h1>
                
            </div>
            
			<div data-role="content" class="content-map content-noMargin">
              <div id="map_canvas">
              </div>
              
              <ul data-role="listview" data-inset="true" class="ui-nodisc-icon list-custom" data-icon="none">
                	<li>
                    <a href="#" onClick="sendLocation();">
                    	<div class="center-wrapper">
                        	<img width="25px" src="images/location-outline.png" />&nbsp;<span>Send This Location</span>
                      </div>
                    </a>
                  </li>
              </ul>
              
              <input type="hidden" name="lng_map" id="lng_map" value="none">
              <input type="hidden" name="lat_map" id="lat_map" value="none">
              
			</div>
        	
            
        </div>
        
        <!-- -->
        
        <div data-role="page" id="pageShowStatus" class="black-back">
        	
            <div data-role="header" class="header-transparent" data-theme="c" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                
                <a href="#" data-rel="back" data-role="button" data-icon="carat-l" data-iconpos="notext" class="btn-header ui-nodisc-icon ui-btn-left"></a>
                
                <h1 class="ui-title title-double">
                	<span id="title-story">Test</span>
                	<p class="subheader">Simple Sub-header</p>
                </h1>
                
           </div>
            
			<div data-role="content" class="content-noMargin black-back" id="content-status">
              
              <!--video webkit-playsinline playsinline id="video-status">
					<source src="images/dimag.mp4#t=0.1" type="video/mp4">
				</video-->
                
			</div>
        	
            
        </div>
        
        <!-- -->
        
        <div data-role="page" id="pageStatus">
        	
            <div data-role="header" class="header-white" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                
                <h1 class="ui-title">Snaps</h1>
                
            </div>
            
			 <div data-role="content" class="content-noMargin">
             	  
               <ul data-role="listview" data-inset="true" class="ui-nodisc-icon list-status ui-alt-icon">
                	<li>
                    <a href="#pageMyStatus" data-transition="slide">
                        <div class="ui-grid-a">
                           <div class="ui-block-a block-rounded" id="divStatus"><img src="images/profil.png" class="roundedStatus photo_profil"></div>
                           <div class="ui-block-b block-text">
                            <div align="left" style="display: inline-block;">
                                <p class="title-story">My Snaps</p>
                                <p class="time-story" id="timeStatus">1m ago</p>
                            </div>
                           </div>
                           <!--div class="ui-block-c block-btnStatus" align="right">
                           	<a href="#popupStatus" data-rel="popup" data-transition="slideup" data-role="button" data-icon="camera-white" data-iconpos="notext" class="ui-nodisc-icon btn-app"></a>
                           </div-->
                        </div>
                    </a>
                  </li>
                </ul>
                
                
                <ul data-role="listview" data-inset="true" class="ui-nodisc-icon list-status" id="list-status">
                	<!--li class="title-text">STATUS FRIENDS</li>
                  <li data-icon="none">
                    <a href="#pageShowStatus" data-transition="pop">
                        <div class="ui-grid-a">
                           <div class="ui-block-a block-rounded"><img src="images/profil.png" class="roundedStatus"></div>
                           <div class="ui-block-b block-text">
                            <p class="title-story">HASSAN</p>
                            <p class="time-story">1m ago</p>
                           </div>
                        </div>
                    </a>
                  </li-->
                </ul>
                
            </div>
        	 
            <div data-role="footer" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                <div data-role="navbar">
                    <ul>
                        <li>
                        	<a href="#pageHome" data-icon="chat-grey" data-role="button" class="btn-text-grey btn-noradius btn-navbar">Chats<span class="notify-bubble notify-chats">0</span></a>
                        </li>
                        <li>
                        	<a href="#pageGroups" data-icon="group-grey" data-role="button" class="btn-text-grey btn-noradius btn-navbar">Groups<span class="notify-bubble notify-groups">0</span></a>
                        </li>
                        <li>
                        	<a href="#" data-icon="status-app" data-role="button" class="btn-text-app btn-noradius btn-navbar">Snaps</a>
                        </li>
                        <li>
                        	<a href="#pageFriends" data-icon="friend-grey" data-role="button" class="btn-text-grey btn-noradius btn-navbar">Friends<span class="notify-bubble notify-friend">0</span></a>
                        </li>
                        <li>
                        	<a href="#pageSettings" data-icon="cog-grey" data-role="button" class="btn-text-grey btn-noradius btn-navbar">Settings</a>
                        </li>
                    </ul>
                </div>
            </div>
       		 
        </div>
        
        <!-- -->
        
        <div data-role="page" id="pageMyStatus">
        	
            <div data-role="header" class="header-white" data-position="fixed" data-tap-toggle="false" data-hide-during-focus="">
                
                <a href="#" data-rel="back" data-role="button" data-icon="carat-l" data-iconpos="notext" class="btn-header ui-nodisc-icon ui-btn-left ui-alt-icon"></a>
                
                <h1 class="ui-title">My Snaps</h1>
                
                <a href="#popupStatus" data-rel="popup" data-transition="slideup" data-role="button" data-icon="camera" data-iconpos="notext" class="ui-nodisc-icon btn-header ui-alt-icon"></a>
                
            </div>
            
			 <div data-role="content" class="content-noMargin">
             	  
               <ul data-role="listview" data-inset="true" class="ui-nodisc-icon list-status" data-icon="none" id="list-myStatus">
                	<!--li>
                    
                        <div class="ui-grid-b">
                           <div class="ui-block-a block-roundedStatus"><img src="images/profil.png" class="roundedStatus photo_profil"></div>
                           <div class="ui-block-b block-textStatus" align="center">
                              <div align="left" style="display: inline-block; margin-top:22px">6h ago</div>
                           </div>
                           <div class="ui-block-c block-btnStatus" align="right">
                           	<a href="#" data-role="button" data-icon="minus" data-iconpos="notext" class="ui-nodisc-icon btn-red"></a>
                           </div>
                        </div>
                        
                  </li-->
                </ul>
                
                <p class="date-grey" style="font-size:12px; margin-left:5px;">Your snaps updates will disappear after 24 hours.</p>
                
            </div>
        	 
           <div data-role="popup" id="popupStatus" data-tolerance="0" data-position-to="window" data-overlay-theme="b" style="border:none; box-shadow: none; background-color: transparent;" data-history="false">
              	<ul data-role="listview" data-inset="true" data-icon="none" style="min-width:210px;" class="ui-nodisc-icon ul-chat ui-alt-icon">
                   <li>
                   	<a href="#" onClick="openDoublePopup('popupStatus', 'popupPhotoStatus');">Photo
                    		<div class="left-radio">
                            <img width="25px" src="images/image.png" />
                          </div>
                   	</a>
                   </li>
                   <li>
                   	<a href="#" onClick="openDoublePopup('popupStatus', 'popupVideoStatus');">Video
                          <div class="left-radio">
                            <img width="25px" src="images/film-outline.png" />
                          </div>
                      </a>
                   </li>
               </ul>
               <ul data-role="listview" data-inset="true" data-icon="none" style="min-width:210px;" class="ui-nodisc-icon ul-picture">
                   <li><a href="#" onClick="closePopup('popupStatus');">Cancel</a></li>
              	</ul>
         	 </div> 
            
            <div data-role="popup" id="popupPhotoStatus" data-tolerance="0" data-position-to="window" data-overlay-theme="b" style="border:none; box-shadow: none; background-color: transparent;" data-history="false">
              	<ul data-role="listview" data-inset="true" data-icon="none" style="min-width:210px;" class="ui-nodisc-icon ul-picture ui-alt-icon">
                   <li>
                   	<a href="#" onClick="sendCameraPhoto('popupPhotoStatus', 'status');">Camera</a>
                   </li>
                   <li>
                   	<a href="#" onClick="sendGalleryPhoto('popupPhotoStatus', 'status');">Photo Library</a>
                   </li>
               </ul>
               <ul data-role="listview" data-inset="true" data-icon="none" style="min-width:210px;" class="ui-nodisc-icon ul-picture">
                   <li><a href="#" onClick="closePopup('popupPhotoStatus');">Cancel</a></li>
              	</ul>
         	 </div>
            
           <div data-role="popup" id="popupVideoStatus" data-tolerance="0" data-position-to="window" data-overlay-theme="b" style="border:none; box-shadow: none; background-color: transparent;" data-history="false">
              	<ul data-role="listview" data-inset="true" data-icon="none" style="min-width:210px;" class="ui-nodisc-icon ul-picture ui-alt-icon">
                   <li>
                   	<a href="#" onClick="sendCameraVideo('popupVideoStatus', 'status');">Camera</a>
                   </li>
                   <li>
                   	<a href="#" onClick="sendGalleryVideo('popupVideoStatus', 'status');">Video Library</a>
                   </li>
               </ul>
               <ul data-role="listview" data-inset="true" data-icon="none" style="min-width:210px;" class="ui-nodisc-icon ul-picture">
                   <li><a href="#" onClick="closePopup('popupVideoStatus');">Cancel</a></li>
              	</ul>

         	 </div>
            
        </div>
        
    </body>
</html>
